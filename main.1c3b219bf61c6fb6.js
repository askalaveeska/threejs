"use strict";(self.webpackChunkthreejs=self.webpackChunkthreejs||[]).push([[179],{98:()=>{function Tt(n){return"function"==typeof n}function Il(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Uu=Il(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Rl(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Ei{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Tt(i))try{i()}catch(s){e=s instanceof Uu?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{l0(s)}catch(o){e=e??[],o instanceof Uu?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Uu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)l0(e);else{if(e instanceof Ei){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Rl(t,e)}remove(e){const{_finalizers:t}=this;t&&Rl(t,e),e instanceof Ei&&e._removeParent(this)}}Ei.EMPTY=(()=>{const n=new Ei;return n.closed=!0,n})();const o0=Ei.EMPTY;function a0(n){return n instanceof Ei||n&&"closed"in n&&Tt(n.remove)&&Tt(n.add)&&Tt(n.unsubscribe)}function l0(n){Tt(n)?n():n.unsubscribe()}const Hs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},zu={setTimeout(n,e,...t){const{delegate:i}=zu;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=zu;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function c0(n){zu.setTimeout(()=>{const{onUnhandledError:e}=Hs;if(!e)throw n;e(n)})}function u0(){}const BI=cp("C",void 0,void 0);function cp(n,e,t){return{kind:n,value:e,error:t}}let Gs=null;function Hu(n){if(Hs.useDeprecatedSynchronousErrorHandling){const e=!Gs;if(e&&(Gs={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Gs;if(Gs=null,t)throw i}}else n()}class up extends Ei{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,a0(e)&&e.add(this)):this.destination=$I}static create(e,t,i){return new Pl(e,t,i)}next(e){this.isStopped?hp(function zI(n){return cp("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?hp(function UI(n){return cp("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?hp(BI,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const GI=Function.prototype.bind;function dp(n,e){return GI.call(n,e)}class WI{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Gu(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Gu(i)}else Gu(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Gu(t)}}}class Pl extends up{constructor(e,t,i){let r;if(super(),Tt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Hs.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&dp(e.next,s),error:e.error&&dp(e.error,s),complete:e.complete&&dp(e.complete,s)}):r=e}this.destination=new WI(r)}}function Gu(n){Hs.useDeprecatedSynchronousErrorHandling?function HI(n){Hs.useDeprecatedSynchronousErrorHandling&&Gs&&(Gs.errorThrown=!0,Gs.error=n)}(n):c0(n)}function hp(n,e){const{onStoppedNotification:t}=Hs;t&&zu.setTimeout(()=>t(n,e))}const $I={closed:!0,next:u0,error:function jI(n){throw n},complete:u0},fp="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ws(n){return n}function d0(n){return 0===n.length?Ws:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let nn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function YI(n){return n&&n instanceof up||function XI(n){return n&&Tt(n.next)&&Tt(n.error)&&Tt(n.complete)}(n)&&a0(n)}(t)?t:new Pl(t,i,r);return Hu(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=h0(i))((r,s)=>{const o=new Pl({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[fp](){return this}pipe(...t){return d0(t)(this)}toPromise(t){return new(t=h0(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function h0(n){var e;return null!==(e=n??Hs.Promise)&&void 0!==e?e:Promise}const ZI=Il(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Nr=(()=>{class n extends nn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new f0(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new ZI}next(t){Hu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Hu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Hu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?o0:(this.currentObservers=null,s.push(t),new Ei(()=>{this.currentObservers=null,Rl(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new nn;return t.source=this,t}}return n.create=(e,t)=>new f0(e,t),n})();class f0 extends Nr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:o0}}function p0(n){return Tt(n?.lift)}function xn(n){return e=>{if(p0(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function pn(n,e,t,i,r){return new KI(n,e,t,i,r)}class KI extends up{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function at(n,e){return xn((t,i)=>{let r=0;t.subscribe(pn(i,s=>{i.next(n.call(e,s,r++))}))})}function js(n){return this instanceof js?(this.v=n,this):new js(n)}function tR(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function y0(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const _0=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function v0(n){return Tt(n?.then)}function x0(n){return Tt(n[fp])}function b0(n){return Symbol.asyncIterator&&Tt(n?.[Symbol.asyncIterator])}function w0(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const M0=function iR(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function S0(n){return Tt(n?.[M0])}function C0(n){return function eR(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(m,p){s.push([h,f,m,p])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof js?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(m){d(s[0][3],m)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield js(t.read());if(r)return yield js(void 0);yield yield js(i)}}finally{t.releaseLock()}})}function E0(n){return Tt(n?.getReader)}function Di(n){if(n instanceof nn)return n;if(null!=n){if(x0(n))return function rR(n){return new nn(e=>{const t=n[fp]();if(Tt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(_0(n))return function sR(n){return new nn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(v0(n))return function oR(n){return new nn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,c0)})}(n);if(b0(n))return D0(n);if(S0(n))return function aR(n){return new nn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(E0(n))return function lR(n){return D0(C0(n))}(n)}throw w0(n)}function D0(n){return new nn(e=>{(function cR(n,e){var t,i,r,s;return function JI(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=tR(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Fr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Cn(n,e,t=1/0){return Tt(e)?Cn((i,r)=>at((s,o)=>e(i,s,r,o))(Di(n(i,r))),t):("number"==typeof e&&(t=e),xn((i,r)=>function uR(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=p=>c<i?m(p):l.push(p),m=p=>{s&&e.next(p),c++;let g=!1;Di(t(p,u++)).subscribe(pn(e,_=>{r?.(_),s?f(_):e.next(_)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<i;){const _=l.shift();o?Fr(e,o,()=>m(_)):m(_)}h()}catch(_){e.error(_)}}))};return n.subscribe(pn(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function Wo(n=1/0){return Cn(Ws,n)}const cr=new nn(n=>n.complete());function mp(n){return n[n.length-1]}function A0(n){return Tt(mp(n))?n.pop():void 0}function Ll(n){return function hR(n){return n&&Tt(n.schedule)}(mp(n))?n.pop():void 0}function T0(n,e=0){return xn((t,i)=>{t.subscribe(pn(i,r=>Fr(i,n,()=>i.next(r),e),()=>Fr(i,n,()=>i.complete(),e),r=>Fr(i,n,()=>i.error(r),e)))})}function I0(n,e=0){return xn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function R0(n,e){if(!n)throw new Error("Iterable cannot be null");return new nn(t=>{Fr(t,e,()=>{const i=n[Symbol.asyncIterator]();Fr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function rn(n,e){return e?function vR(n,e){if(null!=n){if(x0(n))return function pR(n,e){return Di(n).pipe(I0(e),T0(e))}(n,e);if(_0(n))return function gR(n,e){return new nn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(v0(n))return function mR(n,e){return Di(n).pipe(I0(e),T0(e))}(n,e);if(b0(n))return R0(n,e);if(S0(n))return function yR(n,e){return new nn(t=>{let i;return Fr(t,e,()=>{i=n[M0](),Fr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Tt(i?.return)&&i.return()})}(n,e);if(E0(n))return function _R(n,e){return R0(C0(n),e)}(n,e)}throw w0(n)}(n,e):Di(n)}function gp(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Pl({next:()=>{i.unsubscribe(),n()}});return Di(e(...t)).subscribe(i)}function Dt(n){for(let e in n)if(n[e]===Dt)return e;throw Error("Could not find renamed property on target object.")}function yp(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function It(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(It).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function _p(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const wR=Dt({__forward_ref__:Dt});function Rt(n){return n.__forward_ref__=Rt,n.toString=function(){return It(this())},n}function Be(n){return vp(n)?n():n}function vp(n){return"function"==typeof n&&n.hasOwnProperty(wR)&&n.__forward_ref__===Rt}function xp(n){return n&&!!n.\u0275providers}const P0="https://g.co/ng/security#xss";class re extends Error{constructor(e,t){super(Wu(e,t)),this.code=e}}function Wu(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}function qe(n){return"string"==typeof n?n:null==n?"":String(n)}function ju(n,e){throw new re(-201,!1)}function Ai(n,e){null==n&&function xt(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ue(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Gi(n){return{providers:n.providers||[],imports:n.imports||[]}}function $u(n){return L0(n,qu)||L0(n,F0)}function L0(n,e){return n.hasOwnProperty(e)?n[e]:null}function N0(n){return n&&(n.hasOwnProperty(bp)||n.hasOwnProperty(RR))?n[bp]:null}const qu=Dt({\u0275prov:Dt}),bp=Dt({\u0275inj:Dt}),F0=Dt({ngInjectableDef:Dt}),RR=Dt({ngInjectorDef:Dt});var ze=(()=>((ze=ze||{})[ze.Default=0]="Default",ze[ze.Host=1]="Host",ze[ze.Self=2]="Self",ze[ze.SkipSelf=4]="SkipSelf",ze[ze.Optional=8]="Optional",ze))();let wp;function Ti(n){const e=wp;return wp=n,e}function O0(n,e,t){const i=$u(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&ze.Optional?null:void 0!==e?e:void ju(It(n))}const Nt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Nl={},Mp="__NG_DI_FLAG__",Xu="ngTempTokenPath",LR="ngTokenPath",NR=/\n/gm,FR="\u0275",k0="__source";let Fl;function jo(n){const e=Fl;return Fl=n,e}function OR(n,e=ze.Default){if(void 0===Fl)throw new re(-203,!1);return null===Fl?O0(n,void 0,e):Fl.get(n,e&ze.Optional?null:void 0,e)}function Fe(n,e=ze.Default){return(function PR(){return wp}()||OR)(Be(n),e)}function lt(n,e=ze.Default){return Fe(n,Yu(e))}function Yu(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Sp(n){const e=[];for(let t=0;t<n.length;t++){const i=Be(n[t]);if(Array.isArray(i)){if(0===i.length)throw new re(900,!1);let r,s=ze.Default;for(let o=0;o<i.length;o++){const a=i[o],l=kR(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Fe(r,s))}else e.push(Fe(i))}return e}function Ol(n,e){return n[Mp]=e,n.prototype[Mp]=e,n}function kR(n){return n[Mp]}function ps(n){return{toString:n}.toString()}var ur=(()=>((ur=ur||{})[ur.OnPush=0]="OnPush",ur[ur.Default=1]="Default",ur))(),dr=(()=>{return(n=dr||(dr={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",dr;var n})();const Or={},_t=[],Zu=Dt({\u0275cmp:Dt}),Cp=Dt({\u0275dir:Dt}),Ep=Dt({\u0275pipe:Dt}),B0=Dt({\u0275mod:Dt}),kr=Dt({\u0275fac:Dt}),kl=Dt({__NG_ELEMENT_ID__:Dt});let UR=0;function Wi(n){return ps(()=>{const t=!0===n.standalone,i={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===ur.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||_t,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||dr.Emulated,id:"c"+UR++,styles:n.styles||_t,_:null,setInput:null,schemas:n.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=n.dependencies,o=n.features;return r.inputs=H0(n.inputs,i),r.outputs=H0(n.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(U0).filter(z0):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(Gn).filter(z0):null,r})}function U0(n){return bt(n)||Rn(n)}function z0(n){return null!==n}function hr(n){return ps(()=>({type:n.type,bootstrap:n.bootstrap||_t,declarations:n.declarations||_t,imports:n.imports||_t,exports:n.exports||_t,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function H0(n,e){if(null==n)return Or;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const je=Wi;function bt(n){return n[Zu]||null}function Rn(n){return n[Cp]||null}function Gn(n){return n[Ep]||null}function ui(n,e){const t=n[B0]||null;if(!t&&!0===e)throw new Error(`Type ${It(n)} does not have '\u0275mod' property.`);return t}const Vr=0,be=1,Je=2,Ht=3,ji=4,$s=5,Pn=6,qo=7,Xt=8,Ku=9,Ju=10,et=11,Dp=12,Vl=13,G0=14,Xo=15,Ln=16,Bl=17,Yo=18,fr=19,Ul=20,W0=21,Ft=22,Ap=1,j0=2,Qu=7,ed=8,Zo=9,Wn=10;function di(n){return Array.isArray(n)&&"object"==typeof n[Ap]}function $i(n){return Array.isArray(n)&&!0===n[Ap]}function Tp(n){return 0!=(4&n.flags)}function zl(n){return n.componentOffset>-1}function td(n){return 1==(1&n.flags)}function qi(n){return null!==n.template}function GR(n){return 0!=(256&n[Je])}function qs(n,e){return n.hasOwnProperty(kr)?n[kr]:null}class $R{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ii(){return X0}function X0(n){return n.type.prototype.ngOnChanges&&(n.setInput=XR),qR}function qR(){const n=Z0(this),e=n?.current;if(e){const t=n.previous;if(t===Or)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function XR(n,e,t,i){const r=this.declaredInputs[t],s=Z0(n)||function YR(n,e){return n[Y0]=e}(n,{previous:Or,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new $R(l&&l.currentValue,e,a===Or),n[i]=e}Ii.ngInherit=!0;const Y0="__ngSimpleChanges__";function Z0(n){return n[Y0]||null}const Ri=function(n,e,t){};function En(n){for(;Array.isArray(n);)n=n[Vr];return n}function hi(n,e){return En(e[n.index])}function Q0(n,e){return n.data[e]}function fi(n,e){const t=e[n];return di(t)?t:t[Vr]}function id(n){return 64==(64&n[Je])}function ms(n,e){return null==e?null:n[e]}function ex(n){n[Yo]=0}function Rp(n,e){n[$s]+=e;let t=n,i=n[Ht];for(;null!==i&&(1===e&&1===t[$s]||-1===e&&0===t[$s]);)i[$s]+=e,t=i,i=i[Ht]}const Xe={lFrame:ux(null),bindingsEnabled:!0};function nx(){return Xe.bindingsEnabled}function K(){return Xe.lFrame.lView}function ut(){return Xe.lFrame.tView}function Dn(){let n=ix();for(;null!==n&&64===n.type;)n=n.parent;return n}function ix(){return Xe.lFrame.currentTNode}function pr(n,e){const t=Xe.lFrame;t.currentTNode=n,t.isParent=e}function Pp(){return Xe.lFrame.isParent}function Jo(){return Xe.lFrame.bindingIndex++}function uP(n,e){const t=Xe.lFrame;t.bindingIndex=t.bindingRootIndex=n,Np(e)}function Np(n){Xe.lFrame.currentDirectiveIndex=n}function ax(){return Xe.lFrame.currentQueryIndex}function Op(n){Xe.lFrame.currentQueryIndex=n}function hP(n){const e=n[be];return 2===e.type?e.declTNode:1===e.type?n[Pn]:null}function lx(n,e,t){if(t&ze.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&ze.Host||(r=hP(s),null===r||(s=s[Xo],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Xe.lFrame=cx();return i.currentTNode=e,i.lView=n,!0}function kp(n){const e=cx(),t=n[be];Xe.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function cx(){const n=Xe.lFrame,e=null===n?null:n.child;return null===e?ux(n):e}function ux(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function dx(){const n=Xe.lFrame;return Xe.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const hx=dx;function Vp(){const n=dx();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function $n(){return Xe.lFrame.selectedIndex}function Xs(n){Xe.lFrame.selectedIndex=n}function Vt(){const n=Xe.lFrame;return Q0(n.tView,n.selectedIndex)}function rd(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function sd(n,e,t){fx(n,e,3,t)}function od(n,e,t,i){(3&n[Je])===t&&fx(n,e,t,i)}function Bp(n,e){let t=n[Je];(3&t)===e&&(t&=2047,t+=1,n[Je]=t)}function fx(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[Yo]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[Yo]+=65536),(a<s||-1==s)&&(bP(n,t,e,l),n[Yo]=(4294901760&n[Yo])+l+2),l++}function bP(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[Je]>>11<n[Yo]>>16&&(3&n[Je])===e){n[Je]+=2048,Ri(4,a,s);try{s.call(a)}finally{Ri(5,a,s)}}}else{Ri(4,a,s);try{s.call(a)}finally{Ri(5,a,s)}}}const Qo=-1;class Gl{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function zp(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];mx(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function px(n){return 3===n||4===n||6===n}function mx(n){return 64===n.charCodeAt(0)}function Wl(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||gx(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function gx(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function yx(n){return n!==Qo}function ad(n){return 32767&n}function ld(n,e){let t=function CP(n){return n>>16}(n),i=e;for(;t>0;)i=i[Xo],t--;return i}let Hp=!0;function cd(n){const e=Hp;return Hp=n,e}const _x=255,vx=5;let EP=0;const mr={};function ud(n,e){const t=xx(n,e);if(-1!==t)return t;const i=e[be];i.firstCreatePass&&(n.injectorIndex=e.length,Gp(i.data,n),Gp(e,null),Gp(i.blueprint,null));const r=Wp(n,e),s=n.injectorIndex;if(yx(r)){const o=ad(r),a=ld(r,e),l=a[be].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Gp(n,e){n.push(0,0,0,0,0,0,0,0,e)}function xx(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Wp(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=Dx(r),null===i)return Qo;if(t++,r=r[Xo],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Qo}function jp(n,e,t){!function DP(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(kl)&&(i=t[kl]),null==i&&(i=t[kl]=EP++);const r=i&_x;e.data[n+(r>>vx)]|=1<<r}(n,e,t)}function bx(n,e,t){if(t&ze.Optional||void 0!==n)return n;ju()}function wx(n,e,t,i){if(t&ze.Optional&&void 0===i&&(i=null),!(t&(ze.Self|ze.Host))){const r=n[Ku],s=Ti(void 0);try{return r?r.get(e,i,t&ze.Optional):O0(e,i,t&ze.Optional)}finally{Ti(s)}}return bx(i,0,t)}function Mx(n,e,t,i=ze.Default,r){if(null!==n){if(1024&e[Je]){const o=function PP(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&1024&o[Je]&&!(256&o[Je]);){const a=Sx(s,o,t,i|ze.Self,mr);if(a!==mr)return a;let l=s.parent;if(!l){const c=o[W0];if(c){const u=c.get(t,mr,i);if(u!==mr)return u}l=Dx(o),o=o[Xo]}s=l}return r}(n,e,t,i,mr);if(o!==mr)return o}const s=Sx(n,e,t,i,mr);if(s!==mr)return s}return wx(e,t,i,r)}function Sx(n,e,t,i,r){const s=function IP(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(kl)?n[kl]:void 0;return"number"==typeof e?e>=0?e&_x:RP:e}(t);if("function"==typeof s){if(!lx(e,n,i))return i&ze.Host?bx(r,0,i):wx(e,t,i,r);try{const o=s(i);if(null!=o||i&ze.Optional)return o;ju()}finally{hx()}}else if("number"==typeof s){let o=null,a=xx(n,e),l=Qo,c=i&ze.Host?e[Ln][Pn]:null;for((-1===a||i&ze.SkipSelf)&&(l=-1===a?Wp(n,e):e[a+8],l!==Qo&&Ex(i,!1)?(o=e[be],a=ad(l),e=ld(l,e)):a=-1);-1!==a;){const u=e[be];if(Cx(s,a,u.data)){const d=TP(a,e,t,o,i,c);if(d!==mr)return d}l=e[a+8],l!==Qo&&Ex(i,e[be].data[a+8]===c)&&Cx(s,a,e)?(o=u,a=ad(l),e=ld(l,e)):a=-1}}return r}function TP(n,e,t,i,r,s){const o=e[be],a=o.data[n+8],u=dd(a,o,t,null==i?zl(a)&&Hp:i!=o&&0!=(3&a.type),r&ze.Host&&s===a);return null!==u?Ys(e,o,u,a):mr}function dd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const m=o[f];if(f<l&&t===m||f>=l&&m.type===t)return f}if(r){const f=o[l];if(f&&qi(f)&&f.type===t)return l}return null}function Ys(n,e,t,i){let r=n[t];const s=e.data;if(function wP(n){return n instanceof Gl}(r)){const o=r;o.resolving&&function MR(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new re(-200,`Circular dependency in DI detected for ${n}${t}`)}(function vt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():qe(n)}(s[t]));const a=cd(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ti(o.injectImpl):null;lx(n,i,ze.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function xP(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=X0(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&Ti(l),cd(a),o.resolving=!1,hx()}}return r}function Cx(n,e,t){return!!(t[e+(n>>vx)]&1<<n)}function Ex(n,e){return!(n&ze.Self||n&ze.Host&&e)}class ea{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return Mx(this._tNode,this._lView,e,Yu(i),t)}}function RP(){return new ea(Dn(),K())}function An(n){return ps(()=>{const e=n.prototype.constructor,t=e[kr]||$p(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[kr]||$p(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function $p(n){return vp(n)?()=>{const e=$p(Be(n));return e&&e()}:qs(n)}function Dx(n){const e=n[be],t=e.type;return 2===t?e.declTNode:1===t?n[Pn]:null}const na="__parameters__";function ra(n,e,t){return ps(()=>{const i=function qp(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(na)?l[na]:Object.defineProperty(l,na,{value:[]})[na];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Pe{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ue({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Zs(n,e){n.forEach(t=>Array.isArray(t)?Zs(t,e):e(t))}function Tx(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function fd(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function pi(n,e,t){let i=sa(n,e);return i>=0?n[1|i]=t:(i=~i,function OP(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Yp(n,e){const t=sa(n,e);if(t>=0)return n[1|t]}function sa(n,e){return function Ix(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Xl=Ol(ra("Optional"),8),Yl=Ol(ra("SkipSelf"),4);var ni=(()=>((ni=ni||{})[ni.Important=1]="Important",ni[ni.DashCase=2]="DashCase",ni))();const tm=new Map;let rL=0;const im="__ngContext__";function Nn(n,e){di(e)?(n[im]=e[Ul],function oL(n){tm.set(n[Ul],n)}(e)):n[im]=e}let rm;function sm(n,e){return rm(n,e)}function Ql(n){const e=n[Ht];return $i(e)?e[Ht]:e}function om(n){return Zx(n[Vl])}function am(n){return Zx(n[ji])}function Zx(n){for(;null!==n&&!$i(n);)n=n[ji];return n}function aa(n,e,t,i,r){if(null!=i){let s,o=!1;$i(i)?s=i:di(i)&&(o=!0,i=i[Vr]);const a=En(i);0===n&&null!==t?null==r?nb(e,t,a):Ks(e,t,a,r||null,!0):1===n&&null!==t?Ks(e,t,a,r||null,!0):2===n?function pm(n,e,t){const i=yd(n,e);i&&function EL(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function TL(n,e,t,i,r){const s=t[Qu];s!==En(t)&&aa(e,n,i,s,r);for(let a=Wn;a<t.length;a++){const l=t[a];ec(l[be],l,n,e,i,s)}}(e,n,s,t,r)}}function cm(n,e,t){return n.createElement(e,t)}function Jx(n,e){const t=n[Zo],i=t.indexOf(e),r=e[Ht];512&e[Je]&&(e[Je]&=-513,Rp(r,-1)),t.splice(i,1)}function um(n,e){if(n.length<=Wn)return;const t=Wn+e,i=n[t];if(i){const r=i[Bl];null!==r&&r!==n&&Jx(r,i),e>0&&(n[t-1][ji]=i[ji]);const s=fd(n,Wn+e);!function _L(n,e){ec(n,e,e[et],2,null,null),e[Vr]=null,e[Pn]=null}(i[be],i);const o=s[fr];null!==o&&o.detachView(s[be]),i[Ht]=null,i[ji]=null,i[Je]&=-65}return i}function Qx(n,e){if(!(128&e[Je])){const t=e[et];t.destroyNode&&ec(n,e,t,3,null,null),function bL(n){let e=n[Vl];if(!e)return dm(n[be],n);for(;e;){let t=null;if(di(e))t=e[Vl];else{const i=e[Wn];i&&(t=i)}if(!t){for(;e&&!e[ji]&&e!==n;)di(e)&&dm(e[be],e),e=e[Ht];null===e&&(e=n),di(e)&&dm(e[be],e),t=e&&e[ji]}e=t}}(e)}}function dm(n,e){if(!(128&e[Je])){e[Je]&=-65,e[Je]|=128,function CL(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Gl)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];Ri(4,a,l);try{l.call(a)}finally{Ri(5,a,l)}}else{Ri(4,r,s);try{s.call(r)}finally{Ri(5,r,s)}}}}}(n,e),function SL(n,e){const t=n.cleanup,i=e[qo];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[r=o]():i[r=-o].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)(0,i[s])();e[qo]=null}}(n,e),1===e[be].type&&e[et].destroy();const t=e[Bl];if(null!==t&&$i(e[Ht])){t!==e[Ht]&&Jx(t,e);const i=e[fr];null!==i&&i.detachView(n)}!function aL(n){tm.delete(n[Ul])}(e)}}function eb(n,e,t){return function tb(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Vr];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===dr.None||s===dr.Emulated)return null}return hi(i,t)}}(n,e.parent,t)}function Ks(n,e,t,i,r){n.insertBefore(e,t,i,r)}function nb(n,e,t){n.appendChild(e,t)}function ib(n,e,t,i,r){null!==i?Ks(n,e,t,i,r):nb(n,e,t)}function yd(n,e){return n.parentNode(e)}let hm,ym,bd,ob=function sb(n,e,t){return 40&n.type?hi(n,t):null};function _d(n,e,t,i){const r=eb(n,i,e),s=e[et],a=function rb(n,e,t){return ob(n,e,t)}(i.parent||e[Pn],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)ib(s,r,t[l],a,!1);else ib(s,r,t,a,!1);void 0!==hm&&hm(s,i,e,t,r)}function vd(n,e){if(null!==e){const t=e.type;if(3&t)return hi(e,n);if(4&t)return fm(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return vd(n,i);{const r=n[e.index];return $i(r)?fm(-1,r):En(r)}}if(32&t)return sm(e,n)()||En(n[e.index]);{const i=lb(n,e);return null!==i?Array.isArray(i)?i[0]:vd(Ql(n[Ln]),i):vd(n,e.next)}}return null}function lb(n,e){return null!==e?n[Ln][Pn].projection[e.projection]:null}function fm(n,e){const t=Wn+n+1;if(t<e.length){const i=e[t],r=i[be].firstChild;if(null!==r)return vd(i,r)}return e[Qu]}function mm(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Nn(En(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)mm(n,e,t.child,i,r,s,!1),aa(e,n,r,a,s);else if(32&l){const c=sm(t,i);let u;for(;u=c();)aa(e,n,r,u,s);aa(e,n,r,a,s)}else 16&l?cb(n,e,i,t,r,s):aa(e,n,r,a,s);t=o?t.projectionNext:t.next}}function ec(n,e,t,i,r,s){mm(t,i,n.firstChild,e,r,s,!1)}function cb(n,e,t,i,r,s){const o=t[Ln],l=o[Pn].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)aa(e,n,r,l[c],s);else mm(n,e,l,o[Ht],r,s,!0)}function ub(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function db(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&zp(n,e,i),null!==r&&ub(n,e,r),null!==s&&function RL(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function mb(n){return function _m(){if(void 0===bd&&(bd=null,Nt.trustedTypes))try{bd=Nt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return bd}()?.createScriptURL(n)||n}class gb{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${P0})`}}function gs(n){return n instanceof gb?n.changingThisBreaksApplicationSecurity:n}function tc(n,e){const t=function zL(n){return n instanceof gb&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${P0})`)}return t===e}const jL=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var sn=(()=>((sn=sn||{})[sn.NONE=0]="NONE",sn[sn.HTML=1]="HTML",sn[sn.STYLE=2]="STYLE",sn[sn.SCRIPT=3]="SCRIPT",sn[sn.URL=4]="URL",sn[sn.RESOURCE_URL=5]="RESOURCE_URL",sn))();function Mb(n){const e=ic();return e?e.sanitize(sn.URL,n)||"":tc(n,"URL")?gs(n):function vm(n){return(n=String(n)).match(jL)?n:"unsafe:"+n}(qe(n))}function Sb(n){const e=ic();if(e)return mb(e.sanitize(sn.RESOURCE_URL,n)||"");if(tc(n,"ResourceURL"))return mb(gs(n));throw new re(904,!1)}function ic(){const n=K();return n&&n[Dp]}const Md=new Pe("ENVIRONMENT_INITIALIZER"),Eb=new Pe("INJECTOR",-1),Db=new Pe("INJECTOR_DEF_TYPES");class Ab{get(e,t=Nl){if(t===Nl){const i=new Error(`NullInjectorError: No provider for ${It(e)}!`);throw i.name="NullInjectorError",i}return t}}function rN(...n){return{\u0275providers:Tb(0,n),\u0275fromNgModule:!0}}function Tb(n,...e){const t=[],i=new Set;let r;return Zs(e,s=>{const o=s;Mm(o,t,[],i)&&(r||(r=[]),r.push(o))}),void 0!==r&&Ib(r,t),t}function Ib(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];Sm(r,s=>{e.push(s)})}}function Mm(n,e,t,i){if(!(n=Be(n)))return!1;let r=null,s=N0(n);const o=!s&&bt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=N0(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Mm(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Zs(s.imports,u=>{Mm(u,e,t,i)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&Ib(c,e)}if(!a){const c=qs(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:_t},{provide:Db,useValue:r,multi:!0},{provide:Md,useValue:()=>Fe(r),multi:!0})}const l=s.providers;null==l||a||Sm(l,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}function Sm(n,e){for(let t of n)xp(t)&&(t=t.\u0275providers),Array.isArray(t)?Sm(t,e):e(t)}const sN=Dt({provide:String,useValue:Dt});function Cm(n){return null!==n&&"object"==typeof n&&sN in n}function Js(n){return"function"==typeof n}const Em=new Pe("Set Injector scope."),Sd={},aN={};let Dm;function Cd(){return void 0===Dm&&(Dm=new Ab),Dm}class Hr{}class Lb extends Hr{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Tm(e,o=>this.processProvider(o)),this.records.set(Eb,ca(void 0,this)),r.has("environment")&&this.records.set(Hr,ca(void 0,this));const s=this.records.get(Em);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Db.multi,_t,ze.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=jo(this),i=Ti(void 0);try{return e()}finally{jo(t),Ti(i)}}get(e,t=Nl,i=ze.Default){this.assertNotDestroyed(),i=Yu(i);const r=jo(this),s=Ti(void 0);try{if(!(i&ze.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function hN(n){return"function"==typeof n||"object"==typeof n&&n instanceof Pe}(e)&&$u(e);a=l&&this.injectableDefInScope(l)?ca(Am(e),Sd):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&ze.Self?Cd():this.parent).get(e,t=i&ze.Optional&&t===Nl?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Xu]=o[Xu]||[]).unshift(It(e)),r)throw o;return function VR(n,e,t,i){const r=n[Xu];throw e[k0]&&r.unshift(e[k0]),n.message=function BR(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==FR?n.slice(2):n;let r=It(e);if(Array.isArray(e))r=e.map(It).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):It(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(NR,"\n  ")}`}("\n"+n.message,r,t,i),n[LR]=r,n[Xu]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{Ti(s),jo(r)}}resolveInjectorInitializers(){const e=jo(this),t=Ti(void 0);try{const i=this.get(Md.multi,_t,ze.Self);for(const r of i)r()}finally{jo(e),Ti(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(It(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new re(205,!1)}processProvider(e){let t=Js(e=Be(e))?e:Be(e&&e.provide);const i=function cN(n){return Cm(n)?ca(void 0,n.useValue):ca(Nb(n),Sd)}(e);if(Js(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=ca(void 0,Sd,!0),r.factory=()=>Sp(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Sd&&(t.value=aN,t.value=t.factory()),"object"==typeof t.value&&t.value&&function dN(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Be(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Am(n){const e=$u(n),t=null!==e?e.factory:qs(n);if(null!==t)return t;if(n instanceof Pe)throw new re(204,!1);if(n instanceof Function)return function lN(n){const e=n.length;if(e>0)throw function ql(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new re(204,!1);const t=function TR(n){const e=n&&(n[qu]||n[F0]);return e?(function IR(n){if(n.hasOwnProperty("name"))return n.name;(""+n).match(/^function\s*([^\s(]+)/)}(n),e):null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new re(204,!1)}function Nb(n,e,t){let i;if(Js(n)){const r=Be(n);return qs(r)||Am(r)}if(Cm(n))i=()=>Be(n.useValue);else if(function Pb(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Sp(n.deps||[]));else if(function Rb(n){return!(!n||!n.useExisting)}(n))i=()=>Fe(Be(n.useExisting));else{const r=Be(n&&(n.useClass||n.provide));if(!function uN(n){return!!n.deps}(n))return qs(r)||Am(r);i=()=>new r(...Sp(n.deps))}return i}function ca(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Tm(n,e){for(const t of n)Array.isArray(t)?Tm(t,e):t&&xp(t)?Tm(t.\u0275providers,e):e(t)}class fN{}class Fb{}class mN{resolveComponentFactory(e){throw function pN(n){const e=Error(`No component factory found for ${It(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let rc=(()=>{class n{}return n.NULL=new mN,n})();function gN(){return ua(Dn(),K())}function ua(n,e){return new mi(hi(n,e))}let mi=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=gN,n})();function yN(n){return n instanceof mi?n.nativeElement:n}class kb{}let Gr=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function _N(){const n=K(),t=fi(Dn().index,n);return(di(t)?t:n)[et]}(),n})(),vN=(()=>{class n{}return n.\u0275prov=Ue({token:n,providedIn:"root",factory:()=>null}),n})();class sc{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const xN=new sc("15.2.2"),Im={},Rm="ngOriginalError";function Pm(n){return n[Rm]}class da{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Pm(e);for(;t&&Pm(t);)t=Pm(t);return t||null}}function Wr(n){return n instanceof Function?n():n}function Bb(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const Ub="ng-template";function RN(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==Bb(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function zb(n){return 4===n.type&&n.value!==Ub}function PN(n,e,t){return e===(4!==n.type||t?n.value:Ub)}function LN(n,e,t){let i=4;const r=n.attrs||[],s=function ON(n){for(let e=0;e<n.length;e++)if(px(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!PN(n,l,t)||""===l&&1===e.length){if(Xi(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!RN(n.attrs,c,t)){if(Xi(i))return!1;o=!0}continue}const d=NN(8&i?"class":l,r,zb(n),t);if(-1===d){if(Xi(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==Bb(f,c,0)||2&i&&c!==h){if(Xi(i))return!1;o=!0}}}}else{if(!o&&!Xi(i)&&!Xi(l))return!1;if(o&&Xi(l))continue;o=!1,i=l|1&i}}return Xi(i)||o}function Xi(n){return 0==(1&n)}function NN(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function kN(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function Hb(n,e,t=!1){for(let i=0;i<e.length;i++)if(LN(n,e[i],t))return!0;return!1}function Gb(n,e){return n?":not("+e.trim()+")":e}function BN(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Xi(o)&&(e+=Gb(s,r),r=""),i=o,s=s||!Xi(i);t++}return""!==r&&(e+=Gb(s,r)),e}const Ye={};function jb(n,e,t,i){if(!i)if(3==(3&e[Je])){const s=n.preOrderCheckHooks;null!==s&&sd(e,s,t)}else{const s=n.preOrderHooks;null!==s&&od(e,s,0,t)}Xs(t)}function Yb(n,e=null,t=null,i){const r=Zb(n,e,t,i);return r.resolveInjectorInitializers(),r}function Zb(n,e=null,t=null,i,r=new Set){const s=[t||_t,rN(n)];return i=i||("object"==typeof n?void 0:It(n)),new Lb(s,e||Cd(),i||null,r)}let Yi=(()=>{class n{static create(t,i){if(Array.isArray(t))return Yb({name:""},i,t,"");{const r=t.name??"";return Yb({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=Nl,n.NULL=new Ab,n.\u0275prov=Ue({token:n,providedIn:"any",factory:()=>Fe(Eb)}),n.__NG_ELEMENT_ID__=-1,n})();function Q(n,e=ze.Default){const t=K();return null===t?Fe(n,e):Mx(Dn(),t,Be(n),e)}function rw(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];Op(t[i]),o.contentQueries(2,e[s],s)}}}function Dd(n,e,t,i,r,s,o,a,l,c,u){const d=e.blueprint.slice();return d[Vr]=r,d[Je]=76|i,(null!==u||n&&1024&n[Je])&&(d[Je]|=1024),ex(d),d[Ht]=d[Xo]=n,d[Xt]=t,d[Ju]=o||n&&n[Ju],d[et]=a||n&&n[et],d[Dp]=l||n&&n[Dp]||null,d[Ku]=c||n&&n[Ku]||null,d[Pn]=s,d[Ul]=function sL(){return rL++}(),d[W0]=u,d[Ln]=2==e.type?n[Ln]:d,d}function pa(n,e,t,i,r){let s=n.data[e];if(null===s)s=function km(n,e,t,i,r){const s=ix(),o=Pp(),l=n.data[e]=function dF(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function cP(){return Xe.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Hl(){const n=Xe.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return pr(s,!0),s}function oc(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Vm(n,e,t){kp(e);try{const i=n.viewQuery;null!==i&&Xm(1,i,t);const r=n.template;null!==r&&sw(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&rw(n,e),n.staticViewQueries&&Xm(2,n.viewQuery,t);const s=n.components;null!==s&&function lF(n,e){for(let t=0;t<e.length;t++)IF(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Je]&=-5,Vp()}}function Ad(n,e,t,i){const r=e[Je];if(128!=(128&r)){kp(e);try{ex(e),function sx(n){return Xe.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&sw(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&sd(e,c,null)}else{const c=n.preOrderHooks;null!==c&&od(e,c,0,null),Bp(e,0)}if(function AF(n){for(let e=om(n);null!==e;e=am(e)){if(!e[j0])continue;const t=e[Zo];for(let i=0;i<t.length;i++){const r=t[i];512&r[Je]||Rp(r[Ht],1),r[Je]|=512}}}(e),function DF(n){for(let e=om(n);null!==e;e=am(e))for(let t=Wn;t<e.length;t++){const i=e[t],r=i[be];id(i)&&Ad(r,i,r.template,i[Xt])}}(e),null!==n.contentQueries&&rw(n,e),o){const c=n.contentCheckHooks;null!==c&&sd(e,c)}else{const c=n.contentHooks;null!==c&&od(e,c,1),Bp(e,1)}!function oF(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Xs(~r);else{const s=r,o=t[++i],a=t[++i];uP(o,s),a(2,e[s])}}}finally{Xs(-1)}}(n,e);const a=n.components;null!==a&&function aF(n,e){for(let t=0;t<e.length;t++)TF(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&Xm(2,l,i),o){const c=n.viewCheckHooks;null!==c&&sd(e,c)}else{const c=n.viewHooks;null!==c&&od(e,c,2),Bp(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Je]&=-41,512&e[Je]&&(e[Je]&=-513,Rp(e[Ht],-1))}finally{Vp()}}}function sw(n,e,t,i,r){const s=$n(),o=2&i;try{Xs(-1),o&&e.length>Ft&&jb(n,e,Ft,!1),Ri(o?2:0,r),t(i,r)}finally{Xs(s),Ri(o?3:1,r)}}function Bm(n,e,t){if(Tp(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function ow(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Hm(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Hm(n,e,t,i,r,s,o,a,l,c){const u=Ft+i,d=u+r,h=function cF(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ye);return t}(u,d),f="function"==typeof c?c():c;return h[be]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function aw(n,e,t,i){const r=pw(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&mw(n).push(i,r.length-1))}function lw(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?cw(t,e,r,s):i.hasOwnProperty(r)&&cw(t,e,i[r],s)}return t}function cw(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function uw(n,e){const t=fi(e,n);16&t[Je]||(t[Je]|=32)}function dw(n,e,t,i,r,s){for(let c=0;c<i.length;c++)jp(ud(t,e),n,i[c].type);!function wF(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=oc(n,e,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];t.mergedAttrs=Wl(t.mergedAttrs,u.hostAttrs),MF(n,t,e,l,u),bF(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),a=!0),l++}!function hF(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,m=h?h.outputs:null;l=lw(d.inputs,u,l,h?h.inputs:null),c=lw(d.outputs,u,c,m);const p=null===l||null===o||zb(e)?null:EF(l,u,o);a.push(p)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function hw(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function dP(){return Xe.lFrame.currentDirectiveIndex}();try{Xs(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];Np(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&_F(l,c)}}finally{Xs(-1),Np(o)}}function _F(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Wm(n,e,t){e.componentOffset=t,(n.components||(n.components=[])).push(e.index)}function bF(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;qi(e)&&(t[""]=n)}}function MF(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=qs(r.type)),o=new Gl(s,qi(r),Q);n.blueprint[i]=o,t[i]=o,function mF(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function gF(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,oc(n,t,r.hostVars,Ye),r)}function gr(n,e,t,i,r,s){const o=hi(n,e);!function jm(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?qe(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[et],o,s,n.value,t,i,r)}function CF(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?i.setInput(t,d,c,u):t[u]=d}}}function EF(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function TF(n,e){const t=fi(e,n);if(id(t)){const i=t[be];48&t[Je]?Ad(i,t,i.template,t[Xt]):t[$s]>0&&$m(t)}}function $m(n){for(let i=om(n);null!==i;i=am(i))for(let r=Wn;r<i.length;r++){const s=i[r];if(id(s))if(512&s[Je]){const o=s[be];Ad(o,s,o.template,s[Xt])}else s[$s]>0&&$m(s)}const t=n[be].components;if(null!==t)for(let i=0;i<t.length;i++){const r=fi(t[i],n);id(r)&&r[$s]>0&&$m(r)}}function IF(n,e){const t=fi(e,n),i=t[be];(function RF(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),Vm(i,t,t[Xt])}function Td(n,e){return n[Vl]?n[G0][ji]=e:n[Vl]=e,n[G0]=e,e}function qm(n){for(;n;){n[Je]|=32;const e=Ql(n);if(GR(n)&&!e)return n;n=e}return null}function Id(n,e,t,i=!0){const r=e[Ju];r.begin&&r.begin();try{Ad(n,e,n.template,t)}catch(o){throw i&&yw(e,o),o}finally{r.end&&r.end()}}function Xm(n,e,t){Op(0),e(n,t)}function pw(n){return n[qo]||(n[qo]=[])}function mw(n){return n.cleanup||(n.cleanup=[])}function yw(n,e){const t=n[Ku],i=t?t.get(da,null):null;i&&i.handleError(e)}function Ym(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Rd(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=_p(r,a):2==s&&(i=_p(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Pd(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(En(s)),$i(s))for(let a=Wn;a<s.length;a++){const l=s[a],c=l[be].firstChild;null!==c&&Pd(l[be],l,c,i)}const o=t.type;if(8&o)Pd(n,e,t.child,i);else if(32&o){const a=sm(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=lb(e,t);if(Array.isArray(a))i.push(...a);else{const l=Ql(e[Ln]);Pd(l[be],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class ac{get rootNodes(){const e=this._lView,t=e[be];return Pd(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Xt]}set context(e){this._lView[Xt]=e}get destroyed(){return 128==(128&this._lView[Je])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Ht];if($i(e)){const t=e[ed],i=t?t.indexOf(this):-1;i>-1&&(um(e,i),fd(t,i))}this._attachedToViewContainer=!1}Qx(this._lView[be],this._lView)}onDestroy(e){aw(this._lView[be],this._lView,null,e)}markForCheck(){qm(this._cdRefInjectingView||this._lView)}detach(){this._lView[Je]&=-65}reattach(){this._lView[Je]|=64}detectChanges(){Id(this._lView[be],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new re(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function xL(n,e){ec(n,e,e[et],2,null,null)}(this._lView[be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new re(902,!1);this._appRef=e}}class PF extends ac{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Id(e[be],e,e[Xt],!1)}checkNoChanges(){}get context(){return null}}class _w extends rc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=bt(e);return new lc(t,this.ngModule)}}function vw(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class NF{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Yu(i);const r=this.injector.get(e,Im,i);return r!==Im||t===Im?r:this.parentInjector.get(e,t,i)}}class lc extends Fb{get inputs(){return vw(this.componentDef.inputs)}get outputs(){return vw(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function UN(n){return n.map(BN).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof Hr?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new NF(e,s):e,a=o.get(kb,null);if(null===a)throw new re(407,!1);const l=o.get(vN,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",d=i?function uF(n,e,t){return n.selectRootElement(e,t===dr.ShadowDom)}(c,i,this.componentDef.encapsulation):cm(c,u,function LF(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),h=this.componentDef.onPush?288:272,f=Hm(0,null,null,1,0,null,null,null,null,null),m=Dd(null,f,null,h,null,null,a,c,l,o,null);let p,g;kp(m);try{const _=this.componentDef;let v,y=null;_.findHostDirectiveDefs?(v=[],y=new Map,_.findHostDirectiveDefs(_,v,y),v.push(_)):v=[_];const x=function OF(n,e){const t=n[be],i=Ft;return n[i]=e,pa(t,i,2,"#host",null)}(m,d),w=function kF(n,e,t,i,r,s,o,a){const l=r[be];!function VF(n,e,t,i){for(const r of n)e.mergedAttrs=Wl(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Rd(e,e.mergedAttrs,!0),null!==t&&db(i,t,e))}(i,n,e,o);const c=s.createRenderer(e,t),u=Dd(r,ow(t),null,t.onPush?32:16,r[n.index],n,s,c,a||null,null,null);return l.firstCreatePass&&Wm(l,n,i.length-1),Td(r,u),r[n.index]=u}(x,d,_,v,m,a,c);g=Q0(f,Ft),d&&function UF(n,e,t,i){if(i)zp(n,t,["ng-version",xN.full]);else{const{attrs:r,classes:s}=function zN(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Xi(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&zp(n,t,r),s&&s.length>0&&ub(n,t,s.join(" "))}}(c,_,d,i),void 0!==t&&function zF(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(g,this.ngContentSelectors,t),p=function BF(n,e,t,i,r,s){const o=Dn(),a=r[be],l=hi(o,r);dw(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Nn(Ys(r,a,o.directiveStart+u,o),r);hw(a,r,o),l&&Nn(l,r);const c=Ys(r,a,o.directiveStart+o.componentOffset,o);if(n[Xt]=r[Xt]=c,null!==s)for(const u of s)u(c,e);return Bm(a,o,n),c}(w,_,v,y,m,[HF]),Vm(f,m,null)}finally{Vp()}return new FF(this.componentType,p,ua(g,m),m,g)}}class FF extends fN{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new PF(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){const s=this._rootLView;Ym(s[be],s,r,e,t),uw(s,this._tNode.index)}}get injector(){return new ea(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function HF(){const n=Dn();rd(K()[be],n)}function Mt(n){let e=function xw(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(qi(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new re(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=Zm(n.inputs),o.declaredInputs=Zm(n.declaredInputs),o.outputs=Zm(n.outputs);const a=r.hostBindings;a&&$F(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&WF(n,l),c&&jF(n,c),yp(n.inputs,r.inputs),yp(n.declaredInputs,r.declaredInputs),yp(n.outputs,r.outputs),qi(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Mt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function GF(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Wl(r.hostAttrs,t=Wl(t,r.hostAttrs))}}(i)}function Zm(n){return n===Or?{}:n===_t?[]:n}function WF(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function jF(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function $F(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function Fn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function _r(n,e,t,i){const r=K();return Fn(r,Jo(),e)&&(ut(),gr(Vt(),r,n,e,t,i)),_r}function Jm(n,e,t){const i=K();return Fn(i,Jo(),e)&&function gi(n,e,t,i,r,s,o,a){const l=hi(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(Ym(n,t,u,i,r),zl(e)&&uw(t,e.index)):3&e.type&&(i=function fF(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(ut(),Vt(),i,n,e,i[et],t,!1),Jm}function Qm(n,e,t,i,r){const o=r?"class":"style";Ym(n,t,e.inputs[o],o,i)}function Bt(n,e,t,i){const r=K(),s=ut(),o=Ft+n,a=r[et],l=s.firstCreatePass?function oO(n,e,t,i,r,s){const o=e.consts,l=pa(e,n,2,i,ms(o,r));return function Gm(n,e,t,i){if(nx()){const r=null===i?null:{"":-1},s=function vF(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(Hb(e,o.selectors,!1))if(i||(i=[]),qi(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),Wm(n,e,a.length)}else i.unshift(o),Wm(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&dw(n,e,t,o,r,a),r&&function xF(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new re(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Wl(t.mergedAttrs,t.attrs)}(e,t,l,ms(o,s)),null!==l.attrs&&Rd(l,l.attrs,!1),null!==l.mergedAttrs&&Rd(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=r[o]=cm(a,e,function vP(){return Xe.lFrame.currentNamespace}()),u=td(l);return pr(l,!0),db(a,c,l),32!=(32&l.flags)&&_d(s,r,c,l),0===function tP(){return Xe.lFrame.elementDepthCount}()&&Nn(c,r),function nP(){Xe.lFrame.elementDepthCount++}(),u&&(function Um(n,e,t){nx()&&(function yF(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;zl(t)&&function SF(n,e,t){const i=hi(e,n),r=ow(t),s=n[Ju],o=Td(n,Dd(n,r,null,t.onPush?32:16,i,e,s,s.createRenderer(i,t),null,null,null));n[e.index]=o}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||ud(t,e),Nn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Ys(e,n,a,t);Nn(c,e),null!==o&&CF(0,a-r,c,l,0,o),qi(l)&&(fi(t.index,e)[Xt]=Ys(e,n,a,t))}}(n,e,t,hi(t,e)),64==(64&t.flags)&&hw(n,e,t))}(s,r,l),Bm(s,l,r)),null!==i&&function zm(n,e,t=hi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}(r,l),Bt}function on(){let n=Dn();Pp()?function Lp(){Xe.lFrame.isParent=!1}():(n=n.parent,pr(n,!1));const e=n;!function iP(){Xe.lFrame.elementDepthCount--}();const t=ut();return t.firstCreatePass&&(rd(t,n),Tp(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function MP(n){return 0!=(8&n.flags)}(e)&&Qm(t,e,K(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function SP(n){return 0!=(16&n.flags)}(e)&&Qm(t,e,K(),e.stylesWithoutHost,!1),on}function an(n,e,t,i){return Bt(n,e,t,i),on(),an}function uc(n){return!!n&&"function"==typeof n.then}const ng=function Nw(n){return!!n&&"function"==typeof n.subscribe};function yi(n,e,t,i){const r=K(),s=ut(),o=Dn();return function Ow(n,e,t,i,r,s,o){const a=td(i),c=n.firstCreatePass&&mw(n),u=e[Xt],d=pw(e);let h=!0;if(3&i.type||o){const p=hi(i,e),g=o?o(p):p,_=d.length,v=o?x=>o(En(x[i.index])):i.index;let y=null;if(!o&&a&&(y=function cO(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[qo],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=s,y.__ngLastListenerFn__=s,h=!1;else{s=Vw(i,e,u,s,!1);const x=t.listen(g,r,s);d.push(s,x),c&&c.push(r,v,_,_+1)}}else s=Vw(i,e,u,s,!1);const f=i.outputs;let m;if(h&&null!==f&&(m=f[r])){const p=m.length;if(p)for(let g=0;g<p;g+=2){const w=e[m[g]][m[g+1]].subscribe(s),M=d.length;d.push(s,w),c&&c.push(r,i.index,M,-(M+1))}}}(s,r,r[et],o,n,e,i),yi}function kw(n,e,t,i){try{return Ri(6,e,t),!1!==t(i)}catch(r){return yw(n,r),!1}finally{Ri(7,e,t)}}function Vw(n,e,t,i,r){return function s(o){if(o===Function)return i;qm(n.componentOffset>-1?fi(n.index,e):e);let l=kw(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=kw(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Fd(n,e){return n<<17|e<<2}function ys(n){return n>>17&32767}function rg(n){return 2|n}function eo(n){return(131068&n)>>2}function sg(n,e){return-131069&n|e<<2}function og(n){return 1|n}function Xw(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?ys(s):eo(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];vO(n[a],e)&&(l=!0,n[a+1]=i?og(u):rg(u)),a=i?ys(u):eo(u)}l&&(n[t+1]=i?rg(s):og(s))}function vO(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&sa(n,e)>=0}function Od(n,e){return function Zi(n,e,t,i){const r=K(),s=ut(),o=function Ur(n){const e=Xe.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function iM(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[$n()],o=function nM(n,e){return e>=n.expandoStartIndex}(n,t);(function aM(n,e){return 0!=(n.flags&(e?8:16))})(s,i)&&null===e&&!o&&(e=!1),e=function AO(n,e,t,i){const r=function Fp(n){const e=Xe.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=dc(t=ag(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=ag(r,n,e,t,i),null===s){let l=function TO(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==eo(i))return n[ys(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=ag(null,n,e,l[1],i),l=dc(l,e.attrs,i),function IO(n,e,t,i){n[ys(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function RO(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=dc(i,n[s].hostAttrs,t);return dc(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function yO(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=ys(o),l=eo(o);n[i]=t;let u,c=!1;if(Array.isArray(t)?(u=t[1],(null===u||sa(t,u)>0)&&(c=!0)):u=t,r)if(0!==l){const h=ys(n[a+1]);n[i+1]=Fd(h,a),0!==h&&(n[h+1]=sg(n[h+1],i)),n[a+1]=function mO(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Fd(a,0),0!==a&&(n[a+1]=sg(n[a+1],i)),a=i;else n[i+1]=Fd(l,0),0===a?a=i:n[l+1]=sg(n[l+1],i),l=i;c&&(n[i+1]=rg(n[i+1])),Xw(n,u,i,!0),Xw(n,u,i,!1),function _O(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&sa(s,e)>=0&&(t[i+1]=og(t[i+1]))}(e,u,n,i,s),o=Fd(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(s,n,o,i),e!==Ye&&Fn(r,o,e)&&function sM(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],u=function gO(n){return 1==(1&n)}(c)?oM(l,e,t,r,eo(c),o):void 0;kd(u)||(kd(s)||function pO(n){return 2==(2&n)}(c)&&(s=oM(l,null,t,r,a,o)),function IL(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:ni.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=ni.Important),n.setStyle(t,i,r,s))}}(i,o,function nd(n,e){return En(e[n])}($n(),t),r,s))}(s,s.data[$n()],r,r[et],n,r[o+1]=function NO(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=It(gs(n)))),n}(e,t),i,o)}(n,e,null,!0),Od}function ag(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=dc(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function dc(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),pi(n,o,!!t||e[++s]))}return void 0===n?null:n}function oM(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===Ye&&(h=d?_t:void 0);let f=d?Yp(h,i):u===i?h:void 0;if(c&&!kd(f)&&(f=Yp(l,i)),kd(f)&&(a=f,o))return a;const m=n[r+1];r=o?ys(m):eo(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Yp(l,i))}return a}function kd(n){return void 0!==n}function br(n,e=""){const t=K(),i=ut(),r=n+Ft,s=i.firstCreatePass?pa(i,r,1,e,null):i.data[r],o=t[r]=function lm(n,e){return n.createText(e)}(t[et],e);_d(i,t,o,s),pr(s,!1)}const Ea="en-US";let IM=Ea;function dg(n,e,t,i,r){if(n=Be(n),Array.isArray(n))for(let s=0;s<n.length;s++)dg(n[s],e,t,i,r);else{const s=ut(),o=K();let a=Js(n)?n:Be(n.provide),l=Nb(n);const c=Dn(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(Js(n)||!n.multi){const f=new Gl(l,r,Q),m=fg(a,e,r?u:u+h,d);-1===m?(jp(ud(c,o),s,a),hg(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[m]=f,o[m]=f)}else{const f=fg(a,e,u+h,d),m=fg(a,e,u,u+h),g=m>=0&&t[m];if(r&&!g||!r&&!(f>=0&&t[f])){jp(ud(c,o),s,a);const _=function J2(n,e,t,i,r){const s=new Gl(n,t,Q);return s.multi=[],s.index=e,s.componentProviders=0,tS(s,r,i&&!t),s}(r?K2:Z2,t.length,r,i,l);!r&&g&&(t[m].providerFactory=_),hg(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(_),o.push(_)}else hg(s,n,f>-1?f:m,tS(t[r?m:f],l,!r&&i));!r&&i&&g&&t[m].componentProviders++}}}function hg(n,e,t,i){const r=Js(e),s=function oN(n){return!!n.useClass}(e);if(r||s){const l=(s?Be(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function tS(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function fg(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function Z2(n,e,t,i){return pg(this.multi,[])}function K2(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Ys(t,t[be],this.providerFactory.index,i);s=a.slice(0,o),pg(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],pg(r,s);return s}function pg(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function kt(n,e=[]){return t=>{t.providersResolver=(i,r)=>function Y2(n,e,t){const i=ut();if(i.firstCreatePass){const r=qi(n);dg(t,i.data,i.blueprint,r,!0),dg(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class Da{}class nS{}class iS extends Da{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new _w(this);const i=ui(e);this._bootstrapComponents=Wr(i.bootstrap),this._r3Injector=Zb(e,t,[{provide:Da,useValue:this},{provide:rc,useValue:this.componentFactoryResolver}],It(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class mg extends nS{constructor(e){super(),this.moduleType=e}create(e){return new iS(this.moduleType,e)}}class e3 extends Da{constructor(e,t,i){super(),this.componentFactoryResolver=new _w(this),this.instance=null;const r=new Lb([...e,{provide:Da,useValue:this},{provide:rc,useValue:this.componentFactoryResolver}],t||Cd(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Hd(n,e,t=null){return new e3(n,e,t).injector}let t3=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const i=Tb(0,t.type),r=i.length>0?Hd([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Ue({token:n,providedIn:"environment",factory:()=>new n(Fe(Hr))}),n})();function rS(n){n.getStandaloneInjector=e=>e.get(t3).getOrCreateStandaloneInjector(n)}function yg(n){return e=>{setTimeout(n,void 0,e)}}const Wt=class D3 extends Nr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=yg(s),r&&(r=yg(r)),o&&(o=yg(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Ei&&e.add(a),a}};function A3(){return this._results[Symbol.iterator]()}class _g{get changes(){return this._changes||(this._changes=new Wt)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=_g.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=A3)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Pi(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function NP(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let $r=(()=>{class n{}return n.__NG_ELEMENT_ID__=R3,n})();const T3=$r,I3=class extends T3{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tView,r=Dd(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);r[Bl]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[fr];return null!==o&&(r[fr]=o.createEmbeddedView(i)),Vm(i,r,e),new ac(r)}};function R3(){return Gd(Dn(),K())}function Gd(n,e){return 4&n.type?new I3(e,n,ua(n,e)):null}let Ji=(()=>{class n{}return n.__NG_ELEMENT_ID__=P3,n})();function P3(){return _S(Dn(),K())}const L3=Ji,gS=class extends L3{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return ua(this._hostTNode,this._hostLView)}get injector(){return new ea(this._hostTNode,this._hostLView)}get parentInjector(){const e=Wp(this._hostTNode,this._hostLView);if(yx(e)){const t=ld(e,this._hostLView),i=ad(e);return new ea(t[be].data[i+8],t)}return new ea(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=yS(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Wn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,i,r,s){const o=e&&!function $l(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const d=t||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.environmentInjector||d.ngModuleRef}const l=o?e:new lc(bt(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(Hr,null);h&&(s=h)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[be];if(function eP(n){return $i(n[Ht])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[Ht],h=new gS(d,d[Pn],d[Ht]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function wL(n,e,t,i){const r=Wn+i,s=t.length;i>0&&(t[r-1][ji]=e),i<s-Wn?(e[ji]=t[r],Tx(t,Wn+i,e)):(t.push(e),e[ji]=null),e[Ht]=t;const o=e[Bl];null!==o&&t!==o&&function ML(n,e){const t=n[Zo];e[Ln]!==e[Ht][Ht][Ln]&&(n[j0]=!0),null===t?n[Zo]=[e]:t.push(e)}(o,e);const a=e[fr];null!==a&&a.insertView(n),e[Je]|=64}(r,i,o,s);const a=fm(s,o),l=i[et],c=yd(l,o[Qu]);return null!==c&&function vL(n,e,t,i,r,s){i[Vr]=r,i[Pn]=e,ec(n,i,t,1,r,s)}(r,o[Pn],l,i,c,a),e.attachToViewContainerRef(),Tx(vg(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=yS(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=um(this._lContainer,t);i&&(fd(vg(this._lContainer),t),Qx(i[be],i))}detach(e){const t=this._adjustIndex(e,-1),i=um(this._lContainer,t);return i&&null!=fd(vg(this._lContainer),t)?new ac(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function yS(n){return n[ed]}function vg(n){return n[ed]||(n[ed]=[])}function _S(n,e){let t;const i=e[n.index];if($i(i))t=i;else{let r;if(8&n.type)r=En(i);else{const s=e[et];r=s.createComment("");const o=hi(n,e);Ks(s,yd(s,o),r,function DL(n,e){return n.nextSibling(e)}(s,o),!1)}e[n.index]=t=function fw(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null]}(i,e,r,n),Td(e,t)}return new gS(t,n,e)}class xg{constructor(e){this.queryList=e,this.matches=null}clone(){return new xg(this.queryList)}setDirty(){this.queryList.setDirty()}}class bg{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new bg(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==SS(e,t).matches&&this.queries[t].setDirty()}}class vS{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class wg{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new wg(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Mg{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Mg(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,N3(t,s)),this.matchTNodeWithReadOption(e,t,dd(t,e,s,!1,!1))}else i===$r?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,dd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===mi||r===Ji||r===$r&&4&t.type)this.addMatch(t.index,-2);else{const s=dd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function N3(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function O3(n,e,t,i){return-1===t?function F3(n,e){return 11&n.type?ua(n,e):4&n.type?Gd(n,e):null}(e,n):-2===t?function k3(n,e,t){return t===mi?ua(e,n):t===$r?Gd(e,n):t===Ji?_S(e,n):void 0}(n,e,i):Ys(n,n[be],t,e)}function xS(n,e,t,i){const r=e[fr].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:O3(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function Sg(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=xS(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=Wn;d<u.length;d++){const h=u[d];h[Bl]===h[Ht]&&Sg(h[be],h,c,i)}if(null!==u[Zo]){const d=u[Zo];for(let h=0;h<d.length;h++){const f=d[h];Sg(f[be],f,c,i)}}}}}return i}function Aa(n){const e=K(),t=ut(),i=ax();Op(i+1);const r=SS(t,i);if(n.dirty&&function QR(n){return 4==(4&n[Je])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Sg(t,e,i,[]):xS(t,e,r,i);n.reset(s,yN),n.notifyOnChanges()}return!0}return!1}function vc(n,e,t){const i=ut();i.firstCreatePass&&(function MS(n,e,t){null===n.queries&&(n.queries=new wg),n.queries.track(new Mg(e,t))}(i,new vS(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function wS(n,e,t){const i=new _g(4==(4&t));aw(n,e,i,i.destroy),null===e[fr]&&(e[fr]=new bg),e[fr].queries.push(new xg(i))}(i,K(),e)}function Ta(){return function V3(n,e){return n[fr].queries[e].queryList}(K(),ax())}function SS(n,e){return n.queries.getByIndex(e)}function jd(...n){}const $d=new Pe("Application Initializer");let qd=(()=>{class n{constructor(t){this.appInits=t,this.resolve=jd,this.reject=jd,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(uc(s))t.push(s);else if(ng(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Fe($d,8))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const bc=new Pe("AppId",{providedIn:"root",factory:function HS(){return`${Ig()}${Ig()}${Ig()}`}});function Ig(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const GS=new Pe("Platform Initializer"),WS=new Pe("Platform ID",{providedIn:"platform",factory:()=>"unknown"});let ok=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const qr=new Pe("LocaleId",{providedIn:"root",factory:()=>lt(qr,ze.Optional|ze.SkipSelf)||function ak(){return typeof $localize<"u"&&$localize.locale||Ea}()});class ck{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let jS=(()=>{class n{compileModuleSync(t){return new mg(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Wr(ui(t).declarations).reduce((o,a)=>{const l=bt(a);return l&&o.push(new lc(l)),o},[]);return new ck(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const hk=(()=>Promise.resolve(0))();function Rg(n){typeof Zone>"u"?hk.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Yt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Wt(!1),this.onMicrotaskEmpty=new Wt(!1),this.onStable=new Wt(!1),this.onError=new Wt(!1),typeof Zone>"u")throw new re(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function fk(){let n=Nt.requestAnimationFrame,e=Nt.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function gk(n){const e=()=>{!function mk(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Nt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Lg(n),n.isCheckStableRunning=!0,Pg(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Lg(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return XS(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),YS(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return XS(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),YS(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Lg(n),Pg(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Yt.isInAngularZone())throw new re(909,!1)}static assertNotInAngularZone(){if(Yt.isInAngularZone())throw new re(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,pk,jd,jd);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const pk={};function Pg(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Lg(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function XS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function YS(n){n._nesting--,Pg(n)}class yk{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Wt,this.onMicrotaskEmpty=new Wt,this.onStable=new Wt,this.onError=new Wt}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const ZS=new Pe(""),Xd=new Pe("");let Og,Ng=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Og||(function _k(n){Og=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Yt.assertNotInAngularZone(),Rg(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Rg(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Fe(Yt),Fe(Fg),Fe(Xd))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})(),Fg=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return Og?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Xr=!1;let _s=null;const KS=new Pe("AllowMultipleToken"),kg=new Pe("PlatformDestroyListeners"),JS=new Pe("appBootstrapListener");class QS{constructor(e,t){this.name=e,this.token=t}}function tC(n,e,t=[]){const i=`Platform: ${e}`,r=new Pe(i);return(s=[])=>{let o=Vg();if(!o||o.injector.get(KS,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function bk(n){if(_s&&!_s.get(KS,!1))throw new re(400,!1);_s=n;const e=n.get(iC);(function eC(n){const e=n.get(GS,null);e&&e.forEach(t=>t())})(n)}(function nC(n=[],e){return Yi.create({name:e,providers:[{provide:Em,useValue:"platform"},{provide:kg,useValue:new Set([()=>_s=null])},...n]})}(a,i))}return function Mk(n){const e=Vg();if(!e)throw new re(401,!1);return e}()}}function Vg(){return _s?.get(iC)??null}let iC=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function sC(n,e){let t;return t="noop"===n?new yk:("zone.js"===n?void 0:n)||new Yt(e),t}(i?.ngZone,function rC(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),s=[{provide:Yt,useValue:r}];return r.run(()=>{const o=Yi.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(da,null);if(!l)throw new re(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{Zd(this._modules,a),c.unsubscribe()})}),function oC(n,e,t){try{const i=t();return uc(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(l,r,()=>{const c=a.injector.get(qd);return c.runInitializers(),c.donePromise.then(()=>(function RM(n){Ai(n,"Expected localeId to be defined"),"string"==typeof n&&(IM=n.toLowerCase().replace(/_/g,"-"))}(a.injector.get(qr,Ea)||Ea),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,i=[]){const r=aC({},i);return function vk(n,e,t){const i=new mg(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Yd);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new re(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new re(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(kg,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Fe(Yi))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function aC(n,e){return Array.isArray(e)?e.reduce(aC,n):{...n,...e}}let Yd=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,i,r){this._zone=t,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new nn(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new nn(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{Yt.assertNotInAngularZone(),Rg(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{Yt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=function xR(...n){const e=Ll(n),t=function fR(n,e){return"number"==typeof mp(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Di(i[0]):Wo(t)(rn(i,e)):cr}(s,o.pipe(function bR(n={}){const{connector:e=(()=>new Nr),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},m=()=>{const p=o;f(),p?.unsubscribe()};return xn((p,g)=>{c++,!d&&!u&&h();const _=l=l??e();g.add(()=>{c--,0===c&&!d&&!u&&(a=gp(m,r))}),_.subscribe(g),!o&&c>0&&(o=new Pl({next:v=>_.next(v),error:v=>{d=!0,h(),a=gp(f,t,v),_.error(v)},complete:()=>{u=!0,h(),a=gp(f,i),_.complete()}}),Di(p).subscribe(o))})(s)}}()))}bootstrap(t,i){const r=t instanceof Fb;if(!this._injector.get(qd).done){!r&&function $o(n){const e=bt(n)||Rn(n)||Gn(n);return null!==e&&e.standalone}(t);throw new re(405,Xr)}let o;o=r?t:this._injector.get(rc).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function xk(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Da),c=o.create(Yi.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get(ZS,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),Zd(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new re(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Zd(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(JS,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Zd(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new re(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(Fe(Yt),Fe(Hr),Fe(da))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Zd(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let Kd=(()=>{class n{}return n.__NG_ELEMENT_ID__=Ck,n})();function Ck(n){return function Ek(n,e,t){if(zl(n)&&!t){const i=fi(n.index,e);return new ac(i,i)}return 47&n.type?new ac(e[Ln],e):null}(Dn(),K(),16==(16&n))}const Bk=tC(null,"core",[]);let Uk=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Fe(Yd))},n.\u0275mod=hr({type:n}),n.\u0275inj=Gi({}),n})();function Pa(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let Gg=null;function Yr(){return Gg}class Gk{}const ri=new Pe("DocumentToken");let Wg=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:function(){return function Wk(){return Fe(_C)}()},providedIn:"platform"}),n})();const jk=new Pe("Location Initialized");let _C=(()=>{class n extends Wg{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Yr().getBaseHref(this._doc)}onPopState(t){const i=Yr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Yr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){vC()?this._history.pushState(t,i,r):this._location.hash=r}replaceState(t,i,r){vC()?this._history.replaceState(t,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Fe(ri))},n.\u0275prov=Ue({token:n,factory:function(){return function $k(){return new _C(Fe(ri))}()},providedIn:"platform"}),n})();function vC(){return!!window.history.pushState}function jg(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function xC(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Zr(n){return n&&"?"!==n[0]?"?"+n:n}let io=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:function(){return lt(wC)},providedIn:"root"}),n})();const bC=new Pe("appBaseHref");let wC=(()=>{class n extends io{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??lt(ri).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return jg(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Zr(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Zr(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Zr(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(Fe(Wg),Fe(bC,8))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qk=(()=>{class n extends io{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=jg(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Zr(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Zr(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(Fe(Wg),Fe(bC,8))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})(),$g=(()=>{class n{constructor(t){this._subject=new Wt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function Zk(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(xC(MC(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Zr(i))}normalize(t){return n.stripTrailingSlash(function Yk(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,MC(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Zr(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Zr(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Zr,n.joinWithSlash=jg,n.stripTrailingSlash=xC,n.\u0275fac=function(t){return new(t||n)(Fe(io))},n.\u0275prov=Ue({token:n,factory:function(){return function Xk(){return new $g(Fe(io))}()},providedIn:"root"}),n})();function MC(n){return n.replace(/\/index.html$/,"")}let dB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=hr({type:n}),n.\u0275inj=Gi({}),n})();let mB=(()=>{class n{}return n.\u0275prov=Ue({token:n,providedIn:"root",factory:()=>new gB(Fe(ri),window)}),n})();class gB{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function yB(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=UC(this.window.history)||UC(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function UC(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class jB extends Gk{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class cy extends jB{static makeCurrent(){!function Hk(n){Gg||(Gg=n)}(new cy)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function $B(){return Ec=Ec||document.querySelector("base"),Ec?Ec.getAttribute("href"):null}();return null==t?null:function qB(n){hh=hh||document.createElement("a"),hh.setAttribute("href",n);const e=hh.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Ec=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function LV(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let hh,Ec=null;const jC=new Pe("TRANSITION_ID"),YB=[{provide:$d,useFactory:function XB(n,e,t){return()=>{t.get(qd).donePromise.then(()=>{const i=Yr(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[jC,ri,Yi],multi:!0}];let KB=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})();const fh=new Pe("EventManagerPlugins");let ph=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Fe(fh),Fe(Yt))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})();class $C{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Yr().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let qC=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const r=this.usageCount;let s=r.get(t)??0;return s+=i,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})(),Dc=(()=>{class n extends qC{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(s=>s.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const r=this.doc.createElement("style");r.textContent=i,t.appendChild(r);const s=this.styleRef.get(i);s?s.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(Fe(ri))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})();const uy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},dy=/%COMP%/g,ZC=new Pe("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function KC(n,e){return e.flat(100).map(t=>t.replace(dy,n))}function JC(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let hy=(()=>{class n{constructor(t,i,r,s){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new fy(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,i);return r instanceof tE?r.applyToHost(t):r instanceof py&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.eventManager,a=this.sharedStylesHost,l=this.removeStylesOnCompDestory;switch(i.encapsulation){case dr.Emulated:s=new tE(o,a,i,this.appId,l);break;case dr.ShadowDom:return new rU(o,a,t,i);default:s=new py(o,a,i,l)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Fe(ph),Fe(Dc),Fe(bc),Fe(ZC))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})();class fy{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(uy[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(eE(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(eE(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=uy[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=uy[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(ni.DashCase|ni.Important)?e.style.setProperty(t,i,r&ni.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&ni.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,JC(i)):this.eventManager.addEventListener(e,t,JC(i))}}function eE(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class rU extends fy{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=KC(r.id,r.styles);for(const o of s){const a=document.createElement("style");a.textContent=o,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class py extends fy{constructor(e,t,i,r,s=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=KC(s,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class tE extends py{constructor(e,t,i,r,s){const o=r+"-"+i.id;super(e,t,i,s,o),this.contentAttr=function tU(n){return"_ngcontent-%COMP%".replace(dy,n)}(o),this.hostAttr=function nU(n){return"_nghost-%COMP%".replace(dy,n)}(o)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let sU=(()=>{class n extends $C{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Fe(ri))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})();const nE=["alt","control","meta","shift"],oU={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},aU={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let lU=(()=>{class n extends $C{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Yr().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),nE.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=oU[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),nE.forEach(o=>{o!==r&&(0,aU[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(Fe(ri))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})();const hU=tC(Bk,"browser",[{provide:WS,useValue:"browser"},{provide:GS,useValue:function cU(){cy.makeCurrent()},multi:!0},{provide:ri,useFactory:function dU(){return function FL(n){ym=n}(document),document},deps:[]}]),sE=new Pe(""),oE=[{provide:Xd,useClass:class ZB{addToWindow(e){Nt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Nt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Nt.getAllAngularRootElements=()=>e.getAllRootElements(),Nt.frameworkStabilizers||(Nt.frameworkStabilizers=[]),Nt.frameworkStabilizers.push(i=>{const r=Nt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Yr().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:ZS,useClass:Ng,deps:[Yt,Fg,Xd]},{provide:Ng,useClass:Ng,deps:[Yt,Fg,Xd]}],aE=[{provide:Em,useValue:"root"},{provide:da,useFactory:function uU(){return new da},deps:[]},{provide:fh,useClass:sU,multi:!0,deps:[ri,Yt,WS]},{provide:fh,useClass:lU,multi:!0,deps:[ri]},{provide:hy,useClass:hy,deps:[ph,Dc,bc,ZC]},{provide:kb,useExisting:hy},{provide:qC,useExisting:Dc},{provide:Dc,useClass:Dc,deps:[ri]},{provide:ph,useClass:ph,deps:[fh,Yt]},{provide:class _B{},useClass:KB,deps:[]},[]];let fU=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:bc,useValue:t.appId},{provide:jC,useExisting:bc},YB]}}}return n.\u0275fac=function(t){return new(t||n)(Fe(sE,12))},n.\u0275mod=hr({type:n}),n.\u0275inj=Gi({providers:[...aE,...oE],imports:[dB,Uk]}),n})(),lE=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(Fe(ri))},n.\u0275prov=Ue({token:n,factory:function(t){let i=null;return i=t?new t:function mU(){return new lE(Fe(ri))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;const{isArray:bU}=Array,{getPrototypeOf:wU,prototype:MU,keys:SU}=Object;function dE(n){if(1===n.length){const e=n[0];if(bU(e))return{args:e,keys:null};if(function CU(n){return n&&"object"==typeof n&&wU(n)===MU}(e)){const t=SU(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:EU}=Array;function hE(n){return at(e=>function DU(n,e){return EU(e)?n(...e):n(e)}(n,e))}function fE(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}let pE=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(Q(Gr),Q(mi))},n.\u0275dir=je({type:n}),n})(),ro=(()=>{class n extends pE{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=An(n)))(i||n)}}(),n.\u0275dir=je({type:n,features:[Mt]}),n})();const wr=new Pe("NgValueAccessor"),IU={provide:wr,useExisting:Rt(()=>mh),multi:!0},PU=new Pe("CompositionEventMode");let mh=(()=>{class n extends pE{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function RU(){const n=Yr()?Yr().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(Q(Gr),Q(mi),Q(PU,8))},n.\u0275dir=je({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&yi("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[kt([IU]),Mt]}),n})();const LU=!1;function xs(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function gE(n){return null!=n&&"number"==typeof n.length}const On=new Pe("NgValidators"),bs=new Pe("NgAsyncValidators"),NU=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class gh{static min(e){return function yE(n){return e=>{if(xs(e.value)||xs(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function _E(n){return e=>{if(xs(e.value)||xs(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return vE(e)}static requiredTrue(e){return function xE(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function bE(n){return xs(n.value)||NU.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function wE(n){return e=>xs(e.value)||!gE(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function ME(n){return e=>gE(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function SE(n){if(!n)return yh;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(xs(i.value))return null;const r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return IE(e)}static composeAsync(e){return RE(e)}}function vE(n){return xs(n.value)?{required:!0}:null}function yh(n){return null}function CE(n){return null!=n}function EE(n){const e=uc(n)?rn(n):n;if(LU&&!ng(e)){let t="Expected async validator to return Promise or Observable.";throw"object"==typeof n&&(t+=" Are you using a synchronous validator where an async validator is expected?"),new re(-1101,t)}return e}function DE(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function AE(n,e){return e.map(t=>t(n))}function TE(n){return n.map(e=>function FU(n){return!n.validate}(e)?e:t=>e.validate(t))}function IE(n){if(!n)return null;const e=n.filter(CE);return 0==e.length?null:function(t){return DE(AE(t,e))}}function yy(n){return null!=n?IE(TE(n)):null}function RE(n){if(!n)return null;const e=n.filter(CE);return 0==e.length?null:function(t){return function AU(...n){const e=A0(n),{args:t,keys:i}=dE(n),r=new nn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;Di(t[u]).subscribe(pn(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(i?fE(i,a):a),s.complete())}))}});return e?r.pipe(hE(e)):r}(AE(t,e).map(EE)).pipe(at(DE))}}function _y(n){return null!=n?RE(TE(n)):null}function PE(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function LE(n){return n._rawValidators}function NE(n){return n._rawAsyncValidators}function vy(n){return n?Array.isArray(n)?n:[n]:[]}function _h(n,e){return Array.isArray(n)?n.includes(e):n===e}function FE(n,e){const t=vy(e);return vy(n).forEach(r=>{_h(t,r)||t.push(r)}),t}function OE(n,e){return vy(e).filter(t=>!_h(n,t))}class kE{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=yy(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=_y(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Yn extends kE{get formDirective(){return null}get path(){return null}}class ws extends kE{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class VE{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let BE=(()=>{class n extends VE{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(Q(ws,2))},n.\u0275dir=je({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&Od("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Mt]}),n})(),UE=(()=>{class n extends VE{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(Q(Yn,10))},n.\u0275dir=je({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,i){2&t&&Od("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Mt]}),n})();function zE(n,e){return n?`with name: '${e}'`:`at index: ${e}`}const wy=!1,Ac="VALID",xh="INVALID",La="PENDING",Tc="DISABLED";function My(n){return(bh(n)?n.validators:n)||null}function Sy(n,e){return(bh(e)?e.asyncValidators:n)||null}function bh(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function HE(n,e,t){const i=n.controls;if(!(e?Object.keys(i):i).length)throw new re(1e3,wy?function BU(n){return`\n    There are no form controls registered with this ${n?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(e):"");if(!i[t])throw new re(1001,wy?function UU(n,e){return`Cannot find form control ${zE(n,e)}`}(e,t):"")}function GE(n,e,t){n._forEachChild((i,r)=>{if(void 0===t[r])throw new re(1002,wy?function zU(n,e){return`Must supply a value for form control ${zE(n,e)}`}(e,r):"")})}class wh{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Ac}get invalid(){return this.status===xh}get pending(){return this.status==La}get disabled(){return this.status===Tc}get enabled(){return this.status!==Tc}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(FE(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(FE(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(OE(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(OE(e,this._rawAsyncValidators))}hasValidator(e){return _h(this._rawValidators,e)}hasAsyncValidator(e){return _h(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=La,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Tc,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Ac,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ac||this.status===La)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Tc:Ac}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=La,this._hasOwnPendingAsyncValidator=!0;const t=EE(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Wt,this.statusChanges=new Wt}_calculateStatus(){return this._allControlsDisabled()?Tc:this.errors?xh:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(La)?La:this._anyControlsHaveStatus(xh)?xh:Ac}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){bh(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function HU(n){return Array.isArray(n)?yy(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function GU(n){return Array.isArray(n)?_y(n):n||null}(this._rawAsyncValidators)}}class Ic extends wh{constructor(e,t,i){super(My(t),Sy(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){GE(this,!0,e),Object.keys(e).forEach(i=>{HE(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{const r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class WE extends Ic{}const Na=new Pe("CallSetDisabledState",{providedIn:"root",factory:()=>Mh}),Mh="always";function Rc(n,e,t=Mh){Cy(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function jU(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&jE(n,e)})}(n,e),function qU(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function $U(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&jE(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function WU(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Ch(n,e,t=!0){const i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),Dh(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Eh(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Cy(n,e){const t=LE(n);null!==e.validator?n.setValidators(PE(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=NE(n);null!==e.asyncValidator?n.setAsyncValidators(PE(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Eh(e._rawValidators,r),Eh(e._rawAsyncValidators,r)}function Dh(n,e){let t=!1;if(null!==n){if(null!==e.validator){const r=LE(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(o=>o!==e.validator);s.length!==r.length&&(t=!0,n.setValidators(s))}}if(null!==e.asyncValidator){const r=NE(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(o=>o!==e.asyncValidator);s.length!==r.length&&(t=!0,n.setAsyncValidators(s))}}}const i=()=>{};return Eh(e._rawValidators,i),Eh(e._rawAsyncValidators,i),t}function jE(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function XE(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function YE(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Lc=class extends wh{constructor(e=null,t,i){super(My(t),Sy(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),bh(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=YE(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){XE(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){XE(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){YE(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};let eD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=je({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),nD=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=hr({type:n}),n.\u0275inj=Gi({}),n})();const Iy=new Pe("NgModelWithFormControlWarning"),az={provide:Yn,useExisting:Rt(()=>Ah)};let Ah=(()=>{class n extends Yn{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Wt,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Dh(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return Rc(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){Ch(t.control||null,t,!1),function KU(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this.submitted=!0,function qE(n,e){n._syncPendingControls(),e.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(Ch(i||null,t),(n=>n instanceof Lc)(r)&&(Rc(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);(function $E(n,e){Cy(n,e)})(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function XU(n,e){return Dh(n,e)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Cy(this.form,this),this._oldForm&&Dh(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(t){return new(t||n)(Q(On,10),Q(bs,10),Q(Na,8))},n.\u0275dir=je({type:n,selectors:[["","formGroup",""]],hostBindings:function(t,i){1&t&&yi("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[kt([az]),Mt,Ii]}),n})();const uz={provide:ws,useExisting:Rt(()=>Ly)};let Ly=(()=>{class n extends ws{set isDisabled(t){}constructor(t,i,r,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new Wt,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function Ay(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===mh?t=s:function ZU(n){return Object.getPrototypeOf(n.constructor)===ro}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){this._added||this._setUpControl(),function Dy(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return function Sh(n,e){return[...e.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(t){return new(t||n)(Q(Yn,13),Q(On,10),Q(bs,10),Q(wr,10),Q(Iy,8))},n.\u0275dir=je({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[kt([uz]),Mt,Ii]}),n})(),so=(()=>{class n{constructor(){this._validator=yh}ngOnChanges(t){if(this.inputName in t){const i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):yh,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=je({type:n,features:[Ii]}),n})();const vz={provide:On,useExisting:Rt(()=>Th),multi:!0};let Th=(()=>{class n extends so{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Pa,this.createValidator=t=>vE}enabled(t){return t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=An(n)))(i||n)}}(),n.\u0275dir=je({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,i){2&t&&_r("required",i._enabled?"":null)},inputs:{required:"required"},features:[kt([vz]),Mt]}),n})(),Cz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=hr({type:n}),n.\u0275inj=Gi({imports:[nD]}),n})();class _D extends wh{constructor(e,t,i){super(My(t),Sy(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){GE(this,!1,e),e.forEach((i,r)=>{HE(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>!!i._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function vD(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let Ez=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new n;return t.useNonNullable=!0,t}group(t,i=null){const r=this._reduceControls(t);let s={};return vD(i)?s=i:null!==i&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new Ic(r,s)}record(t,i=null){const r=this._reduceControls(t);return new WE(r,i)}control(t,i,r){let s={};return this.useNonNullable?(vD(i)?s=i:(s.validators=i,s.asyncValidators=r),new Lc(t,{...s,nonNullable:!0})):new Lc(t,i,r)}array(t,i,r){const s=t.map(o=>this._createControl(o));return new _D(s,i,r)}_reduceControls(t){const i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){return t instanceof Lc||t instanceof wh?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Dz=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Iy,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Na,useValue:t.callSetDisabledState??Mh}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=hr({type:n}),n.\u0275inj=Gi({imports:[Cz]}),n})();function ke(...n){return rn(n,Ll(n))}class nr extends Nr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const Ih=Il(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function xD(...n){const e=Ll(n),t=A0(n),{args:i,keys:r}=dE(n);if(0===i.length)return rn([],e);const s=new nn(function Az(n,e,t=Ws){return i=>{bD(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)bD(e,()=>{const c=rn(n[l],e);let u=!1;c.subscribe(pn(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>fE(r,o):Ws));return t?s.pipe(hE(t)):s}function bD(n,e,t){n?Fr(t,n,e):e()}function Oy(...n){return function Tz(){return Wo(1)}()(rn(n,Ll(n)))}function wD(n){return new nn(e=>{Di(n()).subscribe(e)})}function Nc(n,e){const t=Tt(n)?n:()=>n,i=r=>r.error(t());return new nn(e?r=>e.schedule(i,0,r):i)}function ky(){return xn((n,e)=>{let t=null;n._refCount++;const i=pn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class MD extends nn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,p0(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ei;const t=this.getSubject();e.add(this.source.subscribe(pn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ei.EMPTY)}return e}refCount(){return ky()(this)}}function Mr(n,e){return xn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(pn(i,l=>{r?.unsubscribe();let c=0;const u=s++;Di(n(l,u)).subscribe(r=pn(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Fc(n){return n<=0?()=>cr:xn((e,t)=>{let i=0;e.subscribe(pn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Ms(n,e){return xn((t,i)=>{let r=0;t.subscribe(pn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Rh(n){return xn((e,t)=>{let i=!1;e.subscribe(pn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function SD(n=Rz){return xn((e,t)=>{let i=!1;e.subscribe(pn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function Rz(){return new Ih}function Ss(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ms((r,s)=>n(r,s,i)):Ws,Fc(1),t?Rh(e):SD(()=>new Ih))}function oo(n,e){return Tt(e)?Cn(n,e,1):Cn(n,1)}function kn(n,e,t){const i=Tt(n)||e||t?{next:n,error:e,complete:t}:n;return i?xn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(pn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Ws}function Cs(n){return xn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(pn(t,void 0,void 0,o=>{s=Di(n(o,Cs(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function CD(n,e){return xn(function Pz(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(pn(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}function Vy(n){return n<=0?()=>cr:xn((e,t)=>{let i=[];e.subscribe(pn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function ED(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Ms((r,s)=>n(r,s,i)):Ws,Vy(1),t?Rh(e):SD(()=>new Ih))}function By(n){return xn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Ze="primary",Oc=Symbol("RouteTitle");class Fz{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Fa(n){return new Fz(n)}function Oz(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Sr(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!DD(n[r],e[r]))return!1;return!0}function DD(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function AD(n){return Array.prototype.concat.apply([],n)}function TD(n){return n.length>0?n[n.length-1]:null}function Tn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Es(n){return ng(n)?n:uc(n)?rn(Promise.resolve(n)):ke(n)}const Ph=!1,Vz={exact:function PD(n,e,t){if(!ao(n.segments,e.segments)||!Lh(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!PD(n.children[i],e.children[i],t))return!1;return!0},subset:LD},ID={exact:function Bz(n,e){return Sr(n,e)},subset:function Uz(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>DD(n[t],e[t]))},ignored:()=>!0};function RD(n,e,t){return Vz[t.paths](n.root,e.root,t.matrixParams)&&ID[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function LD(n,e,t){return ND(n,e,e.segments,t)}function ND(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!ao(r,t)||e.hasChildren()||!Lh(r,t,i))}if(n.segments.length===t.length){if(!ao(n.segments,t)||!Lh(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!LD(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(ao(n.segments,r)&&Lh(n.segments,r,i)&&n.children[Ze])&&ND(n.children[Ze],e,s,i)}}function Lh(n,e,t){return e.every((i,r)=>ID[t](n[r].parameters,i.parameters))}class Ds{constructor(e=new nt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Fa(this.queryParams)),this._queryParamMap}toString(){return Gz.serialize(this)}}class nt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Tn(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Nh(this)}}class kc{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Fa(this.parameters)),this._parameterMap}toString(){return kD(this)}}function ao(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let Vc=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:function(){return new Uy},providedIn:"root"}),n})();class Uy{parse(e){const t=new Jz(e);return new Ds(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Bc(e.root,!0)}`,i=function $z(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Fh(t)}=${Fh(r)}`).join("&"):`${Fh(t)}=${Fh(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Wz(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Gz=new Uy;function Nh(n){return n.segments.map(e=>kD(e)).join("/")}function Bc(n,e){if(!n.hasChildren())return Nh(n);if(e){const t=n.children[Ze]?Bc(n.children[Ze],!1):"",i=[];return Tn(n.children,(r,s)=>{s!==Ze&&i.push(`${s}:${Bc(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function Hz(n,e){let t=[];return Tn(n.children,(i,r)=>{r===Ze&&(t=t.concat(e(i,r)))}),Tn(n.children,(i,r)=>{r!==Ze&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Ze?[Bc(n.children[Ze],!1)]:[`${r}:${Bc(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Ze]?`${Nh(n)}/${t[0]}`:`${Nh(n)}/(${t.join("//")})`}}function FD(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Fh(n){return FD(n).replace(/%3B/gi,";")}function zy(n){return FD(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Oh(n){return decodeURIComponent(n)}function OD(n){return Oh(n.replace(/\+/g,"%20"))}function kD(n){return`${zy(n.path)}${function jz(n){return Object.keys(n).map(e=>`;${zy(e)}=${zy(n[e])}`).join("")}(n.parameters)}`}const qz=/^[^\/()?;=#]+/;function kh(n){const e=n.match(qz);return e?e[0]:""}const Xz=/^[^=?&#]+/,Zz=/^[^&#]+/;class Jz{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new nt([],{}):new nt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ze]=new nt(e,t)),i}parseSegment(){const e=kh(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new re(4009,Ph);return this.capture(e),new kc(Oh(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=kh(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=kh(this.remaining);r&&(i=r,this.capture(i))}e[Oh(t)]=Oh(i)}parseQueryParam(e){const t=function Yz(n){const e=n.match(Xz);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function Kz(n){const e=n.match(Zz);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=OD(t),s=OD(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=kh(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new re(4010,Ph);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ze);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Ze]:new nt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new re(4011,Ph)}}function Hy(n){return n.segments.length>0?new nt([],{[Ze]:n}):n}function Vh(n){const e={};for(const i of Object.keys(n.children)){const s=Vh(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Qz(n){if(1===n.numberOfChildren&&n.children[Ze]){const e=n.children[Ze];return new nt(n.segments.concat(e.segments),e.children)}return n}(new nt(n.segments,e))}function lo(n){return n instanceof Ds}const Gy=!1;function eH(n,e,t,i,r){if(0===t.length)return Oa(e.root,e.root,e.root,i,r);const s=function HD(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new zD(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Tn(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new zD(t,e,i)}(t);return s.toRoot()?Oa(e.root,e.root,new nt([],{}),i,r):function o(l){const c=function nH(n,e,t,i){if(n.isAbsolute)return new ka(e.root,!0,0);if(-1===i)return new ka(t,t===e.root,0);return function GD(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new re(4005,Gy&&"Invalid number of '../'");r=i.segments.length}return new ka(i,!1,r-s)}(t,i+(Uc(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,l),u=c.processChildren?Va(c.segmentGroup,c.index,s.commands):Wy(c.segmentGroup,c.index,s.commands);return Oa(e.root,c.segmentGroup,u,i,r)}(n.snapshot?._lastPathIndex)}function Uc(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function zc(n){return"object"==typeof n&&null!=n&&n.outlets}function Oa(n,e,t,i,r){let o,s={};i&&Tn(i,(l,c)=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=n===e?t:UD(n,e,t);const a=Hy(Vh(o));return new Ds(a,s,r)}function UD(n,e,t){const i={};return Tn(n.children,(r,s)=>{i[s]=r===e?t:UD(r,e,t)}),new nt(n.segments,i)}class zD{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Uc(i[0]))throw new re(4003,Gy&&"Root segment cannot have matrix parameters");const r=i.find(zc);if(r&&r!==TD(i))throw new re(4004,Gy&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ka{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function Wy(n,e,t){if(n||(n=new nt([],{})),0===n.segments.length&&n.hasChildren())return Va(n,e,t);const i=function rH(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(zc(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!jD(l,c,o))return s;i+=2}else{if(!jD(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new nt(n.segments.slice(0,i.pathIndex),{});return s.children[Ze]=new nt(n.segments.slice(i.pathIndex),n.children),Va(s,0,r)}return i.match&&0===r.length?new nt(n.segments,{}):i.match&&!n.hasChildren()?jy(n,e,t):i.match?Va(n,0,r):jy(n,e,t)}function Va(n,e,t){if(0===t.length)return new nt(n.segments,{});{const i=function iH(n){return zc(n[0])?n[0].outlets:{[Ze]:n}}(t),r={};return!i[Ze]&&n.children[Ze]&&1===n.numberOfChildren&&0===n.children[Ze].segments.length?Va(n.children[Ze],e,t):(Tn(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=Wy(n.children[o],e,s))}),Tn(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new nt(n.segments,r))}}function jy(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(zc(s)){const l=sH(s.outlets);return new nt(i,l)}if(0===r&&Uc(t[0])){i.push(new kc(n.segments[e].path,WD(t[0]))),r++;continue}const o=zc(s)?s.outlets[Ze]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Uc(a)?(i.push(new kc(o,WD(a))),r+=2):(i.push(new kc(o,{})),r++)}return new nt(i,{})}function sH(n){const e={};return Tn(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=jy(new nt([],{}),0,t))}),e}function WD(n){const e={};return Tn(n,(t,i)=>e[i]=`${t}`),e}function jD(n,e,t){return n==t.path&&Sr(e,t.parameters)}const Hc="imperative";class Cr{constructor(e,t){this.id=e,this.url=t}}class $y extends Cr{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class co extends Cr{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Bh extends Cr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Uh extends Cr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class qy extends Cr{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class oH extends Cr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class aH extends Cr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lH extends Cr{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class cH extends Cr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class uH extends Cr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dH{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class hH{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class fH{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pH{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class mH{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class gH{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $D{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let vH=(()=>{class n{createUrlTree(t,i,r,s,o,a){return eH(t||i.root,r,s,o,a)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})(),bH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:function(e){return vH.\u0275fac(e)},providedIn:"root"}),n})();class qD{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Xy(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Xy(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Yy(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Yy(e,this._root).map(t=>t.value)}}function Xy(n,e){if(n===e.value)return e;for(const t of e.children){const i=Xy(n,t);if(i)return i}return null}function Yy(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Yy(n,t);if(i.length)return i.unshift(e),i}return[]}class Jr{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Ba(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class XD extends qD{constructor(e,t){super(e),this.snapshot=t,Zy(this,e)}toString(){return this.snapshot.toString()}}function YD(n,e){const t=function wH(n,e){const o=new zh([],{},{},"",{},Ze,e,null,n.root,-1,{});return new KD("",new Jr(o,[]))}(n,e),i=new nr([new kc("",{})]),r=new nr({}),s=new nr({}),o=new nr({}),a=new nr(""),l=new uo(i,r,o,a,s,Ze,e,t.root);return l.snapshot=t.root,new XD(new Jr(l,[]),t)}class uo{constructor(e,t,i,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.title=this.data?.pipe(at(c=>c[Oc]))??ke(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(at(e=>Fa(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(at(e=>Fa(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ZD(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function MH(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class zh{get title(){return this.data?.[Oc]}constructor(e,t,i,r,s,o,a,l,c,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Fa(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Fa(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class KD extends qD{constructor(e,t){super(t),this.url=e,Zy(this,t)}toString(){return JD(this._root)}}function Zy(n,e){e.value._routerState=n,e.children.forEach(t=>Zy(n,t))}function JD(n){const e=n.children.length>0?` { ${n.children.map(JD).join(", ")} } `:"";return`${n.value}${e}`}function Ky(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Sr(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Sr(e.params,t.params)||n.params.next(t.params),function kz(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Sr(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Sr(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Jy(n,e){const t=Sr(n.params,e.params)&&function zz(n,e){return ao(n,e)&&n.every((t,i)=>Sr(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Jy(n.parent,e.parent))}function Gc(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function CH(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Gc(n,i,r);return Gc(n,i)})}(n,e,t);return new Jr(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Gc(n,a)),o}}const i=function EH(n){return new uo(new nr(n.url),new nr(n.params),new nr(n.queryParams),new nr(n.fragment),new nr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Gc(n,s));return new Jr(i,r)}}const Qy="ngNavigationCancelingError";function QD(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=lo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=eA(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function eA(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[Qy]=!0,i.cancellationCode=e,t&&(i.url=t),i}function tA(n){return nA(n)&&lo(n.url)}function nA(n){return n&&n[Qy]}class DH{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Wc,this.attachRef=null}}let Wc=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new DH,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Hh=!1;let Gh=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ze,this.activateEvents=new Wt,this.deactivateEvents=new Wt,this.attachEvents=new Wt,this.detachEvents=new Wt,this.parentContexts=lt(Wc),this.location=lt(Ji),this.changeDetector=lt(Kd),this.environmentInjector=lt(Hr)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new re(4012,Hh);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new re(4012,Hh);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new re(4012,Hh);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new re(4013,Hh);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new AH(t,a,r.injector);if(i&&function TH(n){return!!n.resolveComponentFactory}(i)){const c=i.resolveComponentFactory(o);this.activated=r.createComponent(c,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=je({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ii]}),n})();class AH{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===uo?this.route:e===Wc?this.childContexts:this.parent.get(e,t)}}let e_=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Wi({type:n,selectors:[["ng-component"]],standalone:!0,features:[rS],decls:1,vars:0,template:function(t,i){1&t&&an(0,"router-outlet")},dependencies:[Gh],encapsulation:2}),n})();function iA(n,e){return n.providers&&!n._injector&&(n._injector=Hd(n.providers,e,`Route: ${n.path}`)),n._injector??e}function n_(n){const e=n.children&&n.children.map(n_),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ze&&(t.component=e_),t}function Oi(n){return n.outlet||Ze}function rA(n,e){const t=n.filter(i=>Oi(i)===e);return t.push(...n.filter(i=>Oi(i)!==e)),t}function jc(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class NH{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Ky(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Ba(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Tn(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Ba(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Ba(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=Ba(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new gH(s.value.snapshot))}),e.children.length&&this.forwardEvent(new pH(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(Ky(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Ky(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=jc(r.snapshot),l=a?.get(rc)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class sA{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Wh{constructor(e,t){this.component=e,this.route=t}}function FH(n,e,t){const i=n._root;return $c(i,e?e._root:null,t,[i.value])}function Ua(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function AR(n){return null!==$u(n)}(n)?e.get(n):n:i}function $c(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Ba(e);return n.children.forEach(o=>{(function kH(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function VH(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!ao(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ao(n.url,e.url)||!Sr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Jy(n,e)||!Sr(n.queryParams,e.queryParams);default:return!Jy(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new sA(i)):(s.data=o.data,s._resolvedData=o._resolvedData),$c(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Wh(a.outlet.component,o))}else o&&qc(e,a,r),r.canActivateChecks.push(new sA(i)),$c(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Tn(s,(o,a)=>qc(o,t.getContext(a),r)),r}function qc(n,e,t){const i=Ba(n),r=n.value;Tn(i,(s,o)=>{qc(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Wh(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Xc(n){return"function"==typeof n}function i_(n){return n instanceof Ih||"EmptyError"===n?.name}const jh=Symbol("INITIAL_VALUE");function za(){return Mr(n=>xD(n.map(e=>e.pipe(Fc(1),function Iz(...n){const e=Ll(n);return xn((t,i)=>{(e?Oy(n,t,e):Oy(n,t)).subscribe(i)})}(jh)))).pipe(at(e=>{for(const t of e)if(!0!==t){if(t===jh)return jh;if(!1===t||t instanceof Ds)return t}return!0}),Ms(e=>e!==jh),Fc(1)))}function oA(n){return function qI(...n){return d0(n)}(kn(e=>{if(lo(e))throw QD(0,e)}),at(e=>!0===e))}const r_={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function aA(n,e,t,i,r){const s=s_(n,e,t);return s.matched?function tG(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?ke(r.map(o=>{const a=Ua(o,n);return Es(function WH(n){return n&&Xc(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(za(),oA()):ke(!0)}(i=iA(e,i),e,t).pipe(at(o=>!0===o?s:{...r_})):ke(s)}function s_(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...r_}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Oz)(t,n,e);if(!r)return{...r_};const s={};Tn(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function $h(n,e,t,i){if(t.length>0&&function rG(n,e,t){return t.some(i=>qh(n,e,i)&&Oi(i)!==Ze)}(n,t,i)){const s=new nt(e,function iG(n,e,t,i){const r={};r[Ze]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Oi(s)!==Ze){const o=new nt([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[Oi(s)]=o}return r}(n,e,i,new nt(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function sG(n,e,t){return t.some(i=>qh(n,e,i))}(n,t,i)){const s=new nt(n.segments,function nG(n,e,t,i,r){const s={};for(const o of i)if(qh(n,t,o)&&!r[Oi(o)]){const a=new nt([],{});a._sourceSegment=n,a._segmentIndexShift=e.length,s[Oi(o)]=a}return{...r,...s}}(n,e,t,i,n.children));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new nt(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function qh(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function lA(n,e,t,i){return!!(Oi(n)===i||i!==Ze&&qh(e,t,n))&&("**"===n.path||s_(e,n,t).matched)}function cA(n,e,t){return 0===e.length&&!n.children[t]}const Xh=!1;class Yh{constructor(e){this.segmentGroup=e||null}}class uA{constructor(e){this.urlTree=e}}function Yc(n){return Nc(new Yh(n))}function dA(n){return Nc(new uA(n))}class cG{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=$h(this.urlTree.root,[],[],this.config).segmentGroup,t=new nt(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Ze).pipe(at(s=>this.createUrlTree(Vh(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Cs(s=>{if(s instanceof uA)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Yh?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Ze).pipe(at(r=>this.createUrlTree(Vh(r),e.queryParams,e.fragment))).pipe(Cs(r=>{throw r instanceof Yh?this.noMatchError(r):r}))}noMatchError(e){return new re(4002,Xh)}createUrlTree(e,t,i){const r=Hy(e);return new Ds(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(at(s=>new nt([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return rn(r).pipe(oo(s=>{const o=i.children[s],a=rA(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(at(l=>({segment:l,outlet:s})))}),CD((s,o)=>(s[o.outlet]=o.segment,s),{}),ED())}expandSegment(e,t,i,r,s,o){return rn(i).pipe(oo(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,s,o).pipe(Cs(c=>{if(c instanceof Yh)return ke(null);throw c}))),Ss(a=>!!a),Cs((a,l)=>{if(i_(a))return cA(t,r,s)?ke(new nt([],{})):Yc(t);throw a}))}expandSegmentAgainstRoute(e,t,i,r,s,o,a){return lA(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):Yc(t):Yc(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?dA(s):this.lineralizeSegments(i,s).pipe(Cn(o=>{const a=new nt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=s_(t,r,s);if(!a)return Yc(t);const d=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?dA(d):this.lineralizeSegments(r,d).pipe(Cn(h=>this.expandSegment(e,t,i,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){return"**"===i.path?(e=iA(i,e),i.loadChildren?(i._loadedRoutes?ke({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe(at(a=>(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,new nt(r,{})))):ke(new nt(r,{}))):aA(t,i,r,e).pipe(Mr(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(e=i._injector??e,i,r).pipe(Cn(u=>{const d=u.injector??e,h=u.routes,{segmentGroup:f,slicedSegments:m}=$h(t,a,l,h),p=new nt(f.segments,f.children);if(0===m.length&&p.hasChildren())return this.expandChildren(d,h,p).pipe(at(y=>new nt(a,y)));if(0===h.length&&0===m.length)return ke(new nt(a,{}));const g=Oi(i)===s;return this.expandSegment(d,p,h,m,g?Ze:s,!0).pipe(at(v=>new nt(a.concat(v.segments),v.children)))})):Yc(t)))}getChildConfig(e,t,i){return t.children?ke({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?ke({routes:t._loadedRoutes,injector:t._loadedInjector}):function eG(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?ke(!0):ke(r.map(o=>{const a=Ua(o,n);return Es(function UH(n){return n&&Xc(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(za(),oA())}(e,t,i).pipe(Cn(r=>r?this.configLoader.loadChildren(e,t).pipe(kn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function aG(n){return Nc(eA(Xh,3))}())):ke({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return ke(i);if(r.numberOfChildren>1||!r.children[Ze])return e.redirectTo,Nc(new re(4e3,Xh));r=r.children[Ze]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Ds(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Tn(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=t[a]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Tn(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,i,r)}),new nt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new re(4001,Xh);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class dG{}class pG{constructor(e,t,i,r,s,o,a){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const e=$h(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Ze).pipe(at(t=>{if(null===t)return null;const i=new zh([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ze,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Jr(i,t),s=new KD(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,i=ZD(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return rn(Object.keys(i.children)).pipe(oo(r=>{const s=i.children[r],o=rA(t,r);return this.processSegmentGroup(e,o,s,r)}),CD((r,s)=>r&&s?(r.push(...s),r):null),function Lz(n,e=!1){return xn((t,i)=>{let r=0;t.subscribe(pn(i,s=>{const o=n(s,r++);(o||e)&&i.next(s),!o&&i.complete()}))})}(r=>null!==r),Rh(null),ED(),at(r=>{if(null===r)return null;const s=fA(r);return function mG(n){n.sort((e,t)=>e.value.outlet===Ze?-1:t.value.outlet===Ze?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,i,r,s){return rn(t).pipe(oo(o=>this.processSegmentAgainstRoute(o._injector??e,o,i,r,s)),Ss(o=>!!o),Cs(o=>{if(i_(o))return cA(i,r,s)?ke([]):ke(null);throw o}))}processSegmentAgainstRoute(e,t,i,r,s){if(t.redirectTo||!lA(t,i,r,s))return ke(null);let o;if("**"===t.path){const a=r.length>0?TD(r).parameters:{},l=mA(i)+r.length;o=ke({snapshot:new zh(r,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,gA(t),Oi(t),t.component??t._loadedComponent??null,t,pA(i),l,yA(t)),consumedSegments:[],remainingSegments:[]})}else o=aA(i,t,r,e).pipe(at(({matched:a,consumedSegments:l,remainingSegments:c,parameters:u})=>{if(!a)return null;const d=mA(i)+l.length;return{snapshot:new zh(l,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,gA(t),Oi(t),t.component??t._loadedComponent??null,t,pA(i),d,yA(t)),consumedSegments:l,remainingSegments:c}}));return o.pipe(Mr(a=>{if(null===a)return ke(null);const{snapshot:l,consumedSegments:c,remainingSegments:u}=a;e=t._injector??e;const d=t._loadedInjector??e,h=function gG(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:f,slicedSegments:m}=$h(i,c,u,h.filter(g=>void 0===g.redirectTo));if(0===m.length&&f.hasChildren())return this.processChildren(d,h,f).pipe(at(g=>null===g?null:[new Jr(l,g)]));if(0===h.length&&0===m.length)return ke([new Jr(l,[])]);const p=Oi(t)===s;return this.processSegment(d,h,f,m,p?Ze:s).pipe(at(g=>null===g?null:[new Jr(l,g)]))}))}}function yG(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function fA(n){const e=[],t=new Set;for(const i of n){if(!yG(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=fA(i.children);e.push(new Jr(i.value,r))}return e.filter(i=>!t.has(i))}function pA(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function mA(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function gA(n){return n.data||{}}function yA(n){return n.resolve||{}}function _A(n){return"string"==typeof n.title||null===n.title}function o_(n){return Mr(e=>{const t=n(e);return t?rn(t).pipe(at(()=>e)):ke(e)})}const Ha=new Pe("ROUTES");let a_=(()=>{class n{constructor(t,i){this.injector=t,this.compiler=i,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return ke(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Es(t.loadComponent()).pipe(at(xA),kn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),By(()=>{this.componentLoaders.delete(t)})),r=new MD(i,()=>new Nr).pipe(ky());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ke({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(at(a=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,c,u=!1;Array.isArray(a)?c=a:(l=a.create(t).injector,c=AD(l.get(Ha,[],ze.Self|ze.Optional)));return{routes:c.map(n_),injector:l}}),By(()=>{this.childrenLoaders.delete(i)})),o=new MD(s,()=>new Nr).pipe(ky());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(t){return Es(t()).pipe(at(xA),Cn(r=>r instanceof nS||Array.isArray(r)?ke(r):rn(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)(Fe(Yi),Fe(jS))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function xA(n){return function EG(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Kh=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Nr,this.configLoader=lt(a_),this.environmentInjector=lt(Hr),this.urlSerializer=lt(Vc),this.rootContexts=lt(Wc),this.navigationId=0,this.afterPreactivation=()=>ke(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new hH(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new dH(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new nr({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Hc,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ms(i=>0!==i.id),at(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),Mr(i=>{let r=!1,s=!1;return ke(i).pipe(kn(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Mr(o=>{const a=t.browserUrlTree.toString(),l=!t.navigated||o.extractedUrl.toString()!==a||a!==t.currentUrlTree.toString();if(!l&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const u="";return this.events.next(new Uh(o.id,t.serializeUrl(i.rawUrl),u,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),cr}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return bA(o.source)&&(t.browserUrlTree=o.extractedUrl),ke(o).pipe(Mr(u=>{const d=this.transitions?.getValue();return this.events.next(new $y(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),d!==this.transitions?.getValue()?cr:Promise.resolve(u)}),function uG(n,e,t,i){return Mr(r=>function lG(n,e,t,i,r){return new cG(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(at(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),kn(u=>{this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects},i.urlAfterRedirects=u.urlAfterRedirects}),function vG(n,e,t,i,r){return Cn(s=>function fG(n,e,t,i,r,s,o="emptyOnly"){return new pG(n,e,t,i,r,o,s).recognize().pipe(Mr(a=>null===a?function hG(n){return new nn(e=>e.error(n))}(new dG):ke(a)))}(n,e,t,s.urlAfterRedirects,i.serialize(s.urlAfterRedirects),i,r).pipe(at(o=>({...s,targetSnapshot:o}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),kn(u=>{if(i.targetSnapshot=u.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!u.extras.skipLocationChange){const h=t.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);t.setBrowserUrl(h,u)}t.browserUrlTree=u.urlAfterRedirects}const d=new oH(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(l&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:u,extractedUrl:d,source:h,restoredState:f,extras:m}=o,p=new $y(u,this.urlSerializer.serialize(d),h,f);this.events.next(p);const g=YD(d,this.rootComponentType).snapshot;return ke(i={...o,targetSnapshot:g,urlAfterRedirects:d,extras:{...m,skipLocationChange:!1,replaceUrl:!1}})}{const u="";return this.events.next(new Uh(o.id,t.serializeUrl(i.extractedUrl),u,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),cr}}),kn(o=>{const a=new aH(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),at(o=>i={...o,guards:FH(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function $H(n,e){return Cn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?ke({...t,guardsResult:!0}):function qH(n,e,t,i){return rn(n).pipe(Cn(r=>function QH(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?ke(s.map(a=>{const l=jc(e)??r,c=Ua(a,l);return Es(function GH(n){return n&&Xc(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe(Ss())})).pipe(za()):ke(!0)}(r.component,r.route,t,e,i)),Ss(r=>!0!==r,!0))}(o,i,r,n).pipe(Cn(a=>a&&function BH(n){return"boolean"==typeof n}(a)?function XH(n,e,t,i){return rn(e).pipe(oo(r=>Oy(function ZH(n,e){return null!==n&&e&&e(new fH(n)),ke(!0)}(r.route.parent,i),function YH(n,e){return null!==n&&e&&e(new mH(n)),ke(!0)}(r.route,i),function JH(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function OH(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>wD(()=>ke(o.guards.map(l=>{const c=jc(o.node)??t,u=Ua(l,c);return Es(function HH(n){return n&&Xc(n.canActivateChild)}(u)?u.canActivateChild(i,n):c.runInContext(()=>u(i,n))).pipe(Ss())})).pipe(za())));return ke(s).pipe(za())}(n,r.path,t),function KH(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return ke(!0);const r=i.map(s=>wD(()=>{const o=jc(e)??t,a=Ua(s,o);return Es(function zH(n){return n&&Xc(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(Ss())}));return ke(r).pipe(za())}(n,r.route,t))),Ss(r=>!0!==r,!0))}(i,s,n,e):ke(a)),at(a=>({...t,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),kn(o=>{if(i.guardsResult=o.guardsResult,lo(o.guardsResult))throw QD(0,o.guardsResult);const a=new lH(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),Ms(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),o_(o=>{if(o.guards.canActivateChecks.length)return ke(o).pipe(kn(a=>{const l=new cH(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),Mr(a=>{let l=!1;return ke(a).pipe(function xG(n,e){return Cn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ke(t);let s=0;return rn(r).pipe(oo(o=>function bG(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!_A(r)&&(s[Oc]=r.title),function wG(n,e,t,i){const r=function MG(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return ke({});const s={};return rn(r).pipe(Cn(o=>function SG(n,e,t,i){const r=jc(e)??i,s=Ua(n,r);return Es(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(Ss(),kn(a=>{s[o]=a}))),Vy(1),function Nz(n){return at(()=>n)}(s),Cs(o=>i_(o)?cr:Nc(o)))}(s,n,e,i).pipe(at(o=>(n._resolvedData=o,n.data=ZD(n,t).resolve,r&&_A(r)&&(n.data[Oc]=r.title),null)))}(o.route,i,n,e)),kn(()=>s++),Vy(1),Cn(o=>s===r.length?ke(t):cr))})}(t.paramsInheritanceStrategy,this.environmentInjector),kn({next:()=>l=!0,complete:()=>{l||(t.restoreHistory(a),this.cancelNavigationTransition(a,"",2))}}))}),kn(a=>{const l=new uH(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),o_(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(kn(u=>{l.component=u}),at(()=>{})));for(const u of l.children)c.push(...a(u));return c};return xD(a(o.targetSnapshot.root)).pipe(Rh(),Fc(1))}),o_(()=>this.afterPreactivation()),at(o=>{const a=function SH(n,e,t){const i=Gc(n,e._root,t?t._root:void 0);return new XD(i,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return i={...o,targetRouterState:a}}),kn(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((n,e,t)=>at(i=>(new NH(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o)),kn({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new co(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),By(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Cs(o=>{if(s=!0,nA(o)){tA(o)||(t.navigated=!0,t.restoreHistory(i,!0));const a=new Bh(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),tA(o)){const l=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),c={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||bA(i.source)};t.scheduleNavigation(l,Hc,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const a=new qy(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);this.events.next(a);try{i.resolve(t.errorHandler(o))}catch(l){i.reject(l)}}return cr}))}))}cancelNavigationTransition(t,i,r){const s=new Bh(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function bA(n){return n!==Hc}let wA=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Ze);return i}getResolvedTitleForRoute(t){return t.data[Oc]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:function(){return lt(DG)},providedIn:"root"}),n})(),DG=(()=>{class n extends wA{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(Fe(lE))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),AG=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:function(){return lt(IG)},providedIn:"root"}),n})();class TG{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let IG=(()=>{class n extends TG{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=An(n)))(i||n)}}(),n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Jh=new Pe("",{providedIn:"root",factory:()=>({})});let PG=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:function(){return lt(LG)},providedIn:"root"}),n})(),LG=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function NG(n){throw n}function FG(n,e,t){return e.parse("/")}const OG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},kG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let oi=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=lt(ok),this.isNgZoneEnabled=!1,this.options=lt(Jh,{optional:!0})||{},this.errorHandler=this.options.errorHandler||NG,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||FG,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=lt(PG),this.routeReuseStrategy=lt(AG),this.urlCreationStrategy=lt(bH),this.titleStrategy=lt(wA),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=AD(lt(Ha,{optional:!0})??[]),this.navigationTransitions=lt(Kh),this.urlSerializer=lt(Vc),this.location=lt($g),this.isNgZoneEnabled=lt(Yt)instanceof Yt&&Yt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Ds,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=YD(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Hc,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(n_),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}return null!==u&&(u=this.removeEmptyProps(u)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,u,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=lo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Hc,null,i)}navigate(t,i={skipLocationChange:!1}){return function VG(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new re(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...OG}:!1===i?{...kG}:i,lo(t))return RD(this.currentUrlTree,t,r);const s=this.parseUrl(t);return RD(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c,u;return o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,h)=>{a=d,l=h}),u="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:u,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Zc=(()=>{class n{constructor(t,i,r,s,o,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=a,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Nr;const l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=t.events.subscribe(c=>{c instanceof co&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=Pa(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=Pa(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=Pa(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,r,s,o){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function Cb(n,e,t){return function iN(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?Sb:Mb}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(Q(oi),Q(uo),function hd(n){return function AP(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(px(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Dn(),n)}("tabindex"),Q(Gr),Q(mi),Q(io))},n.\u0275dir=je({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,i){1&t&&yi("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&t&&_r("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Ii]}),n})();class MA{}let zG=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ms(t=>t instanceof co),oo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=Hd(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return rn(r).pipe(Wo())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):ke(null);const s=r.pipe(Cn(o=>null===o?ke(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?rn([s,this.loader.loadComponent(i)]).pipe(Wo()):s})}}return n.\u0275fac=function(t){return new(t||n)(Fe(oi),Fe(jS),Fe(Hr),Fe(MA),Fe(a_))},n.\u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const c_=new Pe("");let SA=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof $y?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof co&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof $D&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new $D(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){!function iw(){throw new Error("invalid")}()},n.\u0275prov=Ue({token:n,factory:n.\u0275fac}),n})();var _i=(()=>((_i=_i||{})[_i.COMPLETE=0]="COMPLETE",_i[_i.FAILED=1]="FAILED",_i[_i.REDIRECTING=2]="REDIRECTING",_i))();const Ga=!1;function As(n,e){return{\u0275kind:n,\u0275providers:e}}const u_=new Pe("",{providedIn:"root",factory:()=>!1});function EA(){const n=lt(Yi);return e=>{const t=n.get(Yd);if(e!==t.components[0])return;const i=n.get(oi),r=n.get(DA);1===n.get(d_)&&i.initialNavigation(),n.get(AA,null,ze.Optional)?.setUpPreloading(),n.get(c_,null,ze.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const DA=new Pe(Ga?"bootstrap done indicator":"",{factory:()=>new Nr}),d_=new Pe(Ga?"initial navigation":"",{providedIn:"root",factory:()=>1});function $G(){let n=[];return n=Ga?[{provide:Md,multi:!0,useFactory:()=>{const e=lt(oi);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function yH(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],As(1,n)}const AA=new Pe(Ga?"router preloader":"");function qG(n){return As(0,[{provide:AA,useExisting:zG},{provide:MA,useExisting:n}])}const Kc=!1,TA=new Pe(Kc?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),XG=[$g,{provide:Vc,useClass:Uy},oi,Wc,{provide:uo,useFactory:function CA(n){return n.routerState.root},deps:[oi]},a_,Kc?{provide:u_,useValue:!0}:[]];function YG(){return new QS("Router",oi)}let IA=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[XG,Kc&&i?.enableTracing?$G().\u0275providers:[],{provide:Ha,multi:!0,useValue:t},{provide:TA,useFactory:QG,deps:[[oi,new Xl,new Yl]]},{provide:Jh,useValue:i||{}},i?.useHash?{provide:io,useClass:qk}:{provide:io,useClass:wC},{provide:c_,useFactory:()=>{const n=lt(mB),e=lt(Yt),t=lt(Jh),i=lt(Kh),r=lt(Vc);return t.scrollOffset&&n.setOffset(t.scrollOffset),new SA(r,i,n,e,t)}},i?.preloadingStrategy?qG(i.preloadingStrategy).\u0275providers:[],{provide:QS,multi:!0,useFactory:YG},i?.initialNavigation?e4(i):[],[{provide:RA,useFactory:EA},{provide:JS,multi:!0,useExisting:RA}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Ha,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(Fe(TA,8))},n.\u0275mod=hr({type:n}),n.\u0275inj=Gi({imports:[e_]}),n})();function QG(n){if(Kc&&n)throw new re(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function e4(n){return["disabled"===n.initialNavigation?As(3,[{provide:$d,multi:!0,useFactory:()=>{const e=lt(oi);return()=>{e.setUpLocationChangeListener()}}},{provide:d_,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?As(2,[{provide:d_,useValue:0},{provide:$d,multi:!0,deps:[Yi],useFactory:e=>{const t=e.get(jk,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(oi),s=e.get(DA);(function HG(n,e){n.events.pipe(Ms(t=>t instanceof co||t instanceof Bh||t instanceof qy||t instanceof Uh),at(t=>t instanceof co||t instanceof Uh?_i.COMPLETE:t instanceof Bh&&(0===t.code||1===t.code)?_i.REDIRECTING:_i.FAILED),Ms(t=>t!==_i.REDIRECTING),Fc(1)).subscribe(()=>{e()})})(r,()=>{i(!0)}),e.get(Kh).afterPreactivation=()=>(i(!0),s.closed?ke(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const RA=new Pe(Kc?"Router Initializer":"");let n4=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Wi({type:n,selectors:[["app-navbar"]],decls:11,vars:0,consts:[["aria-label","Thirteenth navbar example",1,"navbar","navbar-expand-lg","bg-light","rounded"],[1,"container-fluid"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarsExample11","aria-controls","navbarsExample11","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarsExample11",1,"collapse","navbar-collapse","d-lg-flex"],["href","#",1,"navbar-brand","col-lg-3","me-0"],["src","../../assets/ui/logo.svg",2,"height","30px","width","30px"],[1,"navbar-nav","col-lg-6","justify-content-lg-center"],[1,"d-lg-flex","col-lg-3","justify-content-lg-end"],["routerLink","/login",1,"btn","btn-primary"]],template:function(t,i){1&t&&(Bt(0,"nav",0)(1,"div",1)(2,"button",2),an(3,"span",3),on(),Bt(4,"div",4)(5,"a",5),an(6,"img",6),on(),an(7,"ul",7),Bt(8,"div",8)(9,"button",9),br(10,"Logout"),on()()()()())},dependencies:[Zc]}),n})(),i4=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Wi({type:n,selectors:[["app-footer"]],decls:5,vars:0,consts:[[1,"footer","mt-auto","py-3","bg-light"],[1,"container"],[1,"text-muted"]],template:function(t,i){1&t&&(Bt(0,"footer",0)(1,"div",1)(2,"span",2)(3,"p"),br(4,"\xa9 Copyright Truescape Ltd (2023). All rights reserved."),on()()()())}}),n})();function PA(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}const h_="150",Wa={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ja={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},s4=0,LA=1,o4=2,NA=1,a4=2,Jc=3,Qr=0,vi=1,es=2,Ts=0,$a=1,FA=2,OA=3,kA=4,l4=5,qa=100,c4=101,u4=102,VA=103,BA=104,d4=200,h4=201,f4=202,p4=203,UA=204,zA=205,m4=206,g4=207,y4=208,_4=209,v4=210,x4=0,b4=1,w4=2,f_=3,M4=4,S4=5,C4=6,E4=7,Qh=0,D4=1,A4=2,ts=0,T4=1,I4=2,R4=3,P4=4,L4=5,ho=301,fo=302,ef=303,tf=304,Qc=306,po=1e3,Vn=1001,eu=1002,Jt=1003,nf=1004,tu=1005,jt=1006,m_=1007,ns=1008,mo=1009,N4=1010,F4=1011,HA=1012,O4=1013,go=1014,Is=1015,nu=1016,k4=1017,V4=1018,Xa=1020,B4=1021,ki=1023,U4=1024,z4=1025,yo=1026,Ya=1027,H4=1028,G4=1029,W4=1030,j4=1031,$4=1033,g_=33776,y_=33777,__=33778,v_=33779,GA=35840,WA=35841,jA=35842,$A=35843,q4=36196,qA=37492,XA=37496,YA=37808,ZA=37809,KA=37810,JA=37811,QA=37812,eT=37813,tT=37814,nT=37815,iT=37816,rT=37817,sT=37818,oT=37819,aT=37820,lT=37821,x_=36492,X4=36283,cT=36284,uT=36285,dT=36286,iu=2300,Za=2301,J4=0,fT=1,M_=2,_o=3e3,wt=3001,e5=3201,vo=0,t5=1,Er="srgb",ru="srgb-linear",pT="display-p3",mT="300 es",C_=1035;class xo{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Bn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const bo=Math.PI/180,su=180/Math.PI;function xi(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Bn[255&n]+Bn[n>>8&255]+Bn[n>>16&255]+Bn[n>>24&255]+"-"+Bn[255&e]+Bn[e>>8&255]+"-"+Bn[e>>16&15|64]+Bn[e>>24&255]+"-"+Bn[63&t|128]+Bn[t>>8&255]+"-"+Bn[t>>16&255]+Bn[t>>24&255]+Bn[255&i]+Bn[i>>8&255]+Bn[i>>16&255]+Bn[i>>24&255]).toLowerCase()}function Qt(n,e,t){return Math.max(e,Math.min(t,n))}function E_(n,e){return(n%e+e)%e}function ou(n,e,t){return(1-t)*n+t*e}function D_(n){return 0==(n&n-1)&&0!==n}function yT(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function _T(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function is(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function At(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const g5_radToDeg=function p5(n){return n*su};class X{constructor(e=0,t=0){X.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Un{constructor(){Un.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],m=i[8],p=r[0],g=r[3],_=r[6],v=r[1],y=r[4],x=r[7],w=r[2],M=r[5],T=r[8];return s[0]=o*p+a*v+l*w,s[3]=o*g+a*y+l*M,s[6]=o*_+a*x+l*T,s[1]=c*p+u*v+d*w,s[4]=c*g+u*y+d*M,s[7]=c*_+u*x+d*T,s[2]=h*p+f*v+m*w,s[5]=h*g+f*y+m*M,s[8]=h*_+f*x+m*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,m=t*d+i*h+r*f;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return e[0]=d*p,e[1]=(r*c-u*i)*p,e[2]=(a*i-r*o)*p,e[3]=h*p,e[4]=(u*t-r*l)*p,e[5]=(r*s-a*t)*p,e[6]=f*p,e[7]=(i*l-c*t)*p,e[8]=(o*t-i*s)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(A_.makeScale(e,t)),this}rotate(e){return this.premultiply(A_.makeRotation(-e)),this}translate(e,t){return this.premultiply(A_.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const A_=new Un;function vT(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function au(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;class In{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],m=s[o+2],p=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=m,void(e[t+3]=p);if(d!==p||l!==h||c!==f||u!==m){let g=1-a;const _=l*h+c*f+u*m+d*p,v=_>=0?1:-1,y=1-_*_;if(y>Number.EPSILON){const w=Math.sqrt(y),M=Math.atan2(w,_*v);g=Math.sin(g*M)/w,a=Math.sin(a*M)/w}const x=a*v;if(l=l*g+h*x,c=c*g+f*x,u=u*g+m*x,d=d*g+p*x,g===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=w,c*=w,u*=w,d*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],m=s[o+3];return e[t]=a*m+u*d+l*f-c*h,e[t+1]=l*m+u*h+c*d-a*f,e[t+2]=c*m+u*f+a*h-l*d,e[t+3]=u*m-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),m=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d-h*f*m;break;case"YXZ":this._x=h*u*d+c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d+h*f*m;break;case"ZXY":this._x=h*u*d-c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d-h*f*m;break;case"ZYX":this._x=h*u*d-c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d+h*f*m;break;case"YZX":this._x=h*u*d+c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d-h*f*m;break;case"XZY":this._x=h*u*d-c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d+h*f*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Qt(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class E{constructor(e=0,t=0,i=0){E.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(xT.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(xT.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=c*l+h*-s+u*-a-d*-o,this.y=u*l+h*-o+d*-s-c*-a,this.z=d*l+h*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return T_.copy(this).projectOnVector(e),this.sub(T_)}reflect(e){return this.sub(T_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Qt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const T_=new E,xT=new In;function el(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function I_(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const _5=(new Un).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),v5=(new Un).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Rs=new E,w5={[ru]:n=>n,[Er]:n=>n.convertSRGBToLinear(),[pT]:function x5(n){return n.convertSRGBToLinear(),Rs.set(n.r,n.g,n.b).applyMatrix3(v5),n.setRGB(Rs.x,Rs.y,Rs.z)}},M5={[ru]:n=>n,[Er]:n=>n.convertLinearToSRGB(),[pT]:function b5(n){return Rs.set(n.r,n.g,n.b).applyMatrix3(_5),n.setRGB(Rs.x,Rs.y,Rs.z).convertLinearToSRGB()}},Zn={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return ru},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(!1===this.enabled||e===t||!e||!t)return n;const i=w5[e],r=M5[t];if(void 0===i||void 0===r)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}};let tl;class bT{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===tl&&(tl=au("canvas")),tl.width=e.width,tl.height=e.height;const i=tl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=tl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=au("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*el(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*el(t[i]/255)):el(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class nl{constructor(e=null){this.isSource=!0,this.uuid=xi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(R_(r[o].isDataTexture?r[o].image:r[o]))}else s=R_(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function R_(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?bT.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let S5=0,ir=(()=>{class n extends xo{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Vn,s=Vn,o=jt,a=ns,l=ki,c=mo,u=n.DEFAULT_ANISOTROPY,d=_o){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:S5++}),this.uuid=xi(),this.name="",this.source=new nl(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new X(0,0),this.repeat=new X(1,1),this.center=new X(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Un,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case po:t.x=t.x-Math.floor(t.x);break;case Vn:t.x=t.x<0?0:1;break;case eu:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case po:t.y=t.y-Math.floor(t.y);break;case Vn:t.y=t.y<0?0:1;break;case eu:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Ct{constructor(e=0,t=0,i=0,r=1){Ct.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],m=l[9],p=l[2],g=l[6],_=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-p)<.01&&Math.abs(m-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+p)<.1&&Math.abs(m+g)<.1&&Math.abs(c+f+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,x=(f+1)/2,w=(_+1)/2,M=(u+h)/4,T=(d+p)/4,b=(m+g)/4;return y>x&&y>w?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=M/i,s=T/i):x>w?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=M/r,s=b/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=T/s,r=b/s),this.set(i,r,s,t),this}let v=Math.sqrt((g-m)*(g-m)+(d-p)*(d-p)+(h-u)*(h-u));return Math.abs(v)<.001&&(v=1),this.x=(g-m)/v,this.y=(d-p)/v,this.z=(h-u)/v,this.w=Math.acos((c+f+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class wo extends xo{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ct(0,0,e,t),this.scissorTest=!1,this.viewport=new Ct(0,0,e,t),this.texture=new ir({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:jt,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new nl(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class P_ extends ir{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Jt,this.minFilter=Jt,this.wrapR=Vn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class wT extends ir{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Jt,this.minFilter=Jt,this.wrapR=Vn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bi{constructor(e=new E(1/0,1/0,1/0),t=new E(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],d=e[l+1],h=e[l+2];u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),d=e.getY(l),h=e.getZ(l);u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Mo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)Mo.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Mo)}else null===i.boundingBox&&i.computeBoundingBox(),L_.copy(i.boundingBox),L_.applyMatrix4(e.matrixWorld),this.union(L_);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Mo),Mo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(lu),af.subVectors(this.max,lu),il.subVectors(e.a,lu),rl.subVectors(e.b,lu),sl.subVectors(e.c,lu),Ps.subVectors(rl,il),Ls.subVectors(sl,rl),So.subVectors(il,sl);let t=[0,-Ps.z,Ps.y,0,-Ls.z,Ls.y,0,-So.z,So.y,Ps.z,0,-Ps.x,Ls.z,0,-Ls.x,So.z,0,-So.x,-Ps.y,Ps.x,0,-Ls.y,Ls.x,0,-So.y,So.x,0];return!(!N_(t,il,rl,sl,af)||(t=[1,0,0,0,1,0,0,0,1],!N_(t,il,rl,sl,af)))&&(lf.crossVectors(Ps,Ls),t=[lf.x,lf.y,lf.z],N_(t,il,rl,sl,af))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Mo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Mo).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(rs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),rs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),rs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),rs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),rs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),rs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),rs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),rs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(rs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const rs=[new E,new E,new E,new E,new E,new E,new E,new E],Mo=new E,L_=new bi,il=new E,rl=new E,sl=new E,Ps=new E,Ls=new E,So=new E,lu=new E,af=new E,lf=new E,Co=new E;function N_(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Co.fromArray(n,s);const a=r.x*Math.abs(Co.x)+r.y*Math.abs(Co.y)+r.z*Math.abs(Co.z),l=e.dot(Co),c=t.dot(Co),u=i.dot(Co);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const C5=new bi,cu=new E,F_=new E;class Eo{constructor(e=new E,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):C5.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;cu.subVectors(e,this.center);const t=cu.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(cu,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(F_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(cu.copy(e.center).add(F_)),this.expandByPoint(cu.copy(e.center).sub(F_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ss=new E,O_=new E,cf=new E,Ns=new E,k_=new E,uf=new E,V_=new E;class df{constructor(e=new E,t=new E(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ss)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ss.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ss.copy(this.origin).addScaledVector(this.direction,t),ss.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){O_.copy(e).add(t).multiplyScalar(.5),cf.copy(t).sub(e).normalize(),Ns.copy(this.origin).sub(O_);const s=.5*e.distanceTo(t),o=-this.direction.dot(cf),a=Ns.dot(this.direction),l=-Ns.dot(cf),c=Ns.lengthSq(),u=Math.abs(1-o*o);let d,h,f,m;if(u>0)if(d=o*l-a,h=o*a-l,m=s*u,d>=0)if(h>=-m)if(h<=m){const p=1/u;d*=p,h*=p,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-m?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=m?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(O_).addScaledVector(cf,h),f}intersectSphere(e,t){ss.subVectors(e.center,this.origin);const i=ss.dot(this.direction),r=ss.dot(ss)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,ss)}intersectTriangle(e,t,i,r,s){k_.subVectors(t,e),uf.subVectors(i,e),V_.crossVectors(k_,uf);let a,o=this.direction.dot(V_);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Ns.subVectors(this.origin,e);const l=a*this.direction.dot(uf.crossVectors(Ns,uf));if(l<0)return null;const c=a*this.direction.dot(k_.cross(Ns));if(c<0||l+c>o)return null;const u=-a*Ns.dot(V_);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class $e{constructor(){$e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,s,o,a,l,c,u,d,h,f,m,p,g){const _=this.elements;return _[0]=e,_[4]=t,_[8]=i,_[12]=r,_[1]=s,_[5]=o,_[9]=a,_[13]=l,_[2]=c,_[6]=u,_[10]=d,_[14]=h,_[3]=f,_[7]=m,_[11]=p,_[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new $e).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/ol.setFromMatrixColumn(e,0).length(),s=1/ol.setFromMatrixColumn(e,1).length(),o=1/ol.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,m=a*u,p=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+m*c,t[5]=h-p*c,t[9]=-a*l,t[2]=p-h*c,t[6]=m+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,m=c*u,p=c*d;t[0]=h+p*a,t[4]=m*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-m,t[6]=p+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,m=c*u,p=c*d;t[0]=h-p*a,t[4]=-o*d,t[8]=m+f*a,t[1]=f+m*a,t[5]=o*u,t[9]=p-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,m=a*u,p=a*d;t[0]=l*u,t[4]=m*c-f,t[8]=h*c+p,t[1]=l*d,t[5]=p*c+h,t[9]=f*c-m,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,m=a*l,p=a*c;t[0]=l*u,t[4]=p-h*d,t[8]=m*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+m,t[10]=h-p*d}else if("XZY"===e.order){const h=o*l,f=o*c,m=a*l,p=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+p,t[5]=o*u,t[9]=f*d-m,t[2]=m*d-f,t[6]=a*u,t[10]=p*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(E5,e,D5)}lookAt(e,t,i){const r=this.elements;return wi.subVectors(e,t),0===wi.lengthSq()&&(wi.z=1),wi.normalize(),Fs.crossVectors(i,wi),0===Fs.lengthSq()&&(1===Math.abs(i.z)?wi.x+=1e-4:wi.z+=1e-4,wi.normalize(),Fs.crossVectors(i,wi)),Fs.normalize(),hf.crossVectors(wi,Fs),r[0]=Fs.x,r[4]=hf.x,r[8]=wi.x,r[1]=Fs.y,r[5]=hf.y,r[9]=wi.y,r[2]=Fs.z,r[6]=hf.z,r[10]=wi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],m=i[2],p=i[6],g=i[10],_=i[14],v=i[3],y=i[7],x=i[11],w=i[15],M=r[0],T=r[4],b=r[8],S=r[12],R=r[1],F=r[5],H=r[9],N=r[13],P=r[2],U=r[6],Y=r[10],ie=r[14],j=r[3],J=r[7],ne=r[11],_e=r[15];return s[0]=o*M+a*R+l*P+c*j,s[4]=o*T+a*F+l*U+c*J,s[8]=o*b+a*H+l*Y+c*ne,s[12]=o*S+a*N+l*ie+c*_e,s[1]=u*M+d*R+h*P+f*j,s[5]=u*T+d*F+h*U+f*J,s[9]=u*b+d*H+h*Y+f*ne,s[13]=u*S+d*N+h*ie+f*_e,s[2]=m*M+p*R+g*P+_*j,s[6]=m*T+p*F+g*U+_*J,s[10]=m*b+p*H+g*Y+_*ne,s[14]=m*S+p*N+g*ie+_*_e,s[3]=v*M+y*R+x*P+w*j,s[7]=v*T+y*F+x*U+w*J,s[11]=v*b+y*H+x*Y+w*ne,s[15]=v*S+y*N+x*ie+w*_e,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],m=e[12],p=e[13],g=e[14],_=e[15],v=d*g*c-p*h*c+p*l*f-a*g*f-d*l*_+a*h*_,y=m*h*c-u*g*c-m*l*f+o*g*f+u*l*_-o*h*_,x=u*p*c-m*d*c+m*a*f-o*p*f-u*a*_+o*d*_,w=m*d*l-u*p*l-m*a*h+o*p*h+u*a*g-o*d*g,M=t*v+i*y+r*x+s*w;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/M;return e[0]=v*T,e[1]=(p*h*s-d*g*s-p*r*f+i*g*f+d*r*_-i*h*_)*T,e[2]=(a*g*s-p*l*s+p*r*c-i*g*c-a*r*_+i*l*_)*T,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*T,e[4]=y*T,e[5]=(u*g*s-m*h*s+m*r*f-t*g*f-u*r*_+t*h*_)*T,e[6]=(m*l*s-o*g*s-m*r*c+t*g*c+o*r*_-t*l*_)*T,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*T,e[8]=x*T,e[9]=(m*d*s-u*p*s-m*i*f+t*p*f+u*i*_-t*d*_)*T,e[10]=(o*p*s-m*a*s+m*i*c-t*p*c-o*i*_+t*a*_)*T,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*T,e[12]=w*T,e[13]=(u*p*r-m*d*r+m*i*h-t*p*h-u*i*g+t*d*g)*T,e[14]=(m*a*r-o*p*r-m*i*l+t*p*l+o*i*g-t*a*g)*T,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*T,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,m=s*d,p=o*u,g=o*d,_=a*d,v=l*c,y=l*u,x=l*d,w=i.x,M=i.y,T=i.z;return r[0]=(1-(p+_))*w,r[1]=(f+x)*w,r[2]=(m-y)*w,r[3]=0,r[4]=(f-x)*M,r[5]=(1-(h+_))*M,r[6]=(g+v)*M,r[7]=0,r[8]=(m+y)*T,r[9]=(g-v)*T,r[10]=(1-(h+p))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=ol.set(r[0],r[1],r[2]).length();const o=ol.set(r[4],r[5],r[6]).length(),a=ol.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],rr.copy(this);const c=1/s,u=1/o,d=1/a;return rr.elements[0]*=c,rr.elements[1]*=c,rr.elements[2]*=c,rr.elements[4]*=u,rr.elements[5]*=u,rr.elements[6]*=u,rr.elements[8]*=d,rr.elements[9]*=d,rr.elements[10]*=d,t.setFromRotationMatrix(rr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){const a=this.elements,c=2*s/(i-r),u=(t+e)/(t-e),d=(i+r)/(i-r),h=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(o-s),d=(t+e)*l,h=(i+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const ol=new E,rr=new $e,E5=new E(0,0,0),D5=new E(1,1,1),Fs=new E,hf=new E,wi=new E,MT=new $e,ST=new In;let A5=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],m=s[10];switch(i){case"XYZ":this._y=Math.asin(Qt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Qt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,m),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Qt(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Qt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,m),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Qt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,m));break;case"XZY":this._z=Math.asin(-Qt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return MT.makeRotationFromQuaternion(t),this.setFromRotationMatrix(MT,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return ST.setFromEuler(this),this.setFromQuaternion(ST,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class B_{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let T5=0;const CT=new E,al=new In,os=new $e,ff=new E,uu=new E,I5=new E,R5=new In,ET=new E(1,0,0),DT=new E(0,1,0),AT=new E(0,0,1),P5={type:"added"},TT={type:"removed"};let bn=(()=>{class n extends xo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:T5++}),this.uuid=xi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new E,i=new A5,r=new In,s=new E(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new $e},normalMatrix:{value:new Un}}),this.matrix=new $e,this.matrixWorld=new $e,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new B_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return al.setFromAxisAngle(t,i),this.quaternion.multiply(al),this}rotateOnWorldAxis(t,i){return al.setFromAxisAngle(t,i),this.quaternion.premultiply(al),this}rotateX(t){return this.rotateOnAxis(ET,t)}rotateY(t){return this.rotateOnAxis(DT,t)}rotateZ(t){return this.rotateOnAxis(AT,t)}translateOnAxis(t,i){return CT.copy(t).applyQuaternion(this.quaternion),this.position.add(CT.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(ET,t)}translateY(t){return this.translateOnAxis(DT,t)}translateZ(t){return this.translateOnAxis(AT,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(os.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?ff.copy(t):ff.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),uu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?os.lookAt(uu,ff,this.up):os.lookAt(ff,uu,this.up),this.quaternion.setFromRotationMatrix(os),s&&(os.extractRotation(s.matrixWorld),al.setFromRotationMatrix(os),this.quaternion.premultiply(al.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(P5)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(TT)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(TT)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),os.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),os.multiply(t.parent.matrixWorld)),t.applyMatrix4(os),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(uu,t,I5),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(uu,R5,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),m=a(t.animations),p=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),m.length>0&&(r.animations=m),p.length>0&&(r.nodes=p)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new E(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const sr=new E,as=new E,U_=new E,ls=new E,ll=new E,cl=new E,IT=new E,z_=new E,H_=new E,G_=new E;class or{constructor(e=new E,t=new E,i=new E){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),sr.subVectors(e,t),r.cross(sr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){sr.subVectors(r,t),as.subVectors(i,t),U_.subVectors(e,t);const o=sr.dot(sr),a=sr.dot(as),l=sr.dot(U_),c=as.dot(as),u=as.dot(U_),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,m=(o*u-a*l)*h;return s.set(1-f-m,m,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,ls),ls.x>=0&&ls.y>=0&&ls.x+ls.y<=1}static getUV(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,ls),l.set(0,0),l.addScaledVector(s,ls.x),l.addScaledVector(o,ls.y),l.addScaledVector(a,ls.z),l}static isFrontFacing(e,t,i,r){return sr.subVectors(i,t),as.subVectors(e,t),sr.cross(as).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return sr.subVectors(this.c,this.b),as.subVectors(this.a,this.b),.5*sr.cross(as).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return or.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return or.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return or.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return or.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return or.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;ll.subVectors(r,i),cl.subVectors(s,i),z_.subVectors(e,i);const l=ll.dot(z_),c=cl.dot(z_);if(l<=0&&c<=0)return t.copy(i);H_.subVectors(e,r);const u=ll.dot(H_),d=cl.dot(H_);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(ll,o);G_.subVectors(e,s);const f=ll.dot(G_),m=cl.dot(G_);if(m>=0&&f<=m)return t.copy(s);const p=f*c-l*m;if(p<=0&&c>=0&&m<=0)return a=c/(c-m),t.copy(i).addScaledVector(cl,a);const g=u*m-f*d;if(g<=0&&d-u>=0&&f-m>=0)return IT.subVectors(s,r),a=(d-u)/(d-u+(f-m)),t.copy(r).addScaledVector(IT,a);const _=1/(g+p+h);return o=p*_,a=h*_,t.copy(i).addScaledVector(ll,o).addScaledVector(cl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let L5=0;class ar extends xo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:L5++}),this.uuid=xi(),this.name="",this.type="Material",this.blending=$a,this.side=Qr,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=UA,this.blendDst=zA,this.blendEquation=qa,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=f_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==$a&&(i.blending=this.blending),this.side!==Qr&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const RT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},lr={h:0,s:0,l:0},pf={h:0,s:0,l:0};function W_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class de{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Er){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Zn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Zn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Zn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Zn.workingColorSpace){if(e=E_(e,1),t=Qt(t,0,1),i=Qt(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=W_(o,s,e+1/3),this.g=W_(o,s,e),this.b=W_(o,s,e-1/3)}return Zn.toWorkingColorSpace(this,r),this}setStyle(e,t=Er){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Zn.toWorkingColorSpace(this,t),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Zn.toWorkingColorSpace(this,t),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,u=parseFloat(s[3])/100;return i(s[4]),this.setHSL(l,c,u,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Zn.toWorkingColorSpace(this,t),this;if(6===o)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Zn.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Er){const i=RT[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=el(e.r),this.g=el(e.g),this.b=el(e.b),this}copyLinearToSRGB(e){return this.r=I_(e.r),this.g=I_(e.g),this.b=I_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Er){return Zn.fromWorkingColorSpace(zn.copy(this),e),Qt(255*zn.r,0,255)<<16^Qt(255*zn.g,0,255)<<8^Qt(255*zn.b,0,255)<<0}getHexString(e=Er){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Zn.workingColorSpace){Zn.fromWorkingColorSpace(zn.copy(this),t);const i=zn.r,r=zn.g,s=zn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Zn.workingColorSpace){return Zn.fromWorkingColorSpace(zn.copy(this),t),e.r=zn.r,e.g=zn.g,e.b=zn.b,e}getStyle(e=Er){Zn.fromWorkingColorSpace(zn.copy(this),e);const t=zn.r,i=zn.g,r=zn.b;return e!==Er?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${255*t|0},${255*i|0},${255*r|0})`}offsetHSL(e,t,i){return this.getHSL(lr),lr.h+=e,lr.s+=t,lr.l+=i,this.setHSL(lr.h,lr.s,lr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(lr),e.getHSL(pf);const i=ou(lr.h,pf.h,t),r=ou(lr.s,pf.s,t),s=ou(lr.l,pf.l,t);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const zn=new de;de.NAMES=RT;class Vi extends ar{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new de(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const un=new E,mf=new X;class $t{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)mf.fromBufferAttribute(this,t),mf.applyMatrix3(e),this.setXY(t,mf.x,mf.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)un.fromBufferAttribute(this,t),un.applyMatrix3(e),this.setXYZ(t,un.x,un.y,un.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)un.fromBufferAttribute(this,t),un.applyMatrix4(e),this.setXYZ(t,un.x,un.y,un.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)un.fromBufferAttribute(this,t),un.applyNormalMatrix(e),this.setXYZ(t,un.x,un.y,un.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)un.fromBufferAttribute(this,t),un.transformDirection(e),this.setXYZ(t,un.x,un.y,un.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=is(t,this.array)),t}setX(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=is(t,this.array)),t}setY(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=is(t,this.array)),t}setZ(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=is(t,this.array)),t}setW(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),i=At(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),i=At(i,this.array),r=At(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),i=At(i,this.array),r=At(r,this.array),s=At(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class PT extends $t{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class LT extends $t{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Ce extends $t{constructor(e,t,i){super(new Float32Array(e),t,i)}}let N5=0;const Bi=new $e,j_=new bn,ul=new E,Mi=new bi,du=new bi,wn=new E;class it extends xo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:N5++}),this.uuid=xi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(vT(e)?LT:PT)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Un).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Bi.makeRotationFromQuaternion(e),this.applyMatrix4(Bi),this}rotateX(e){return Bi.makeRotationX(e),this.applyMatrix4(Bi),this}rotateY(e){return Bi.makeRotationY(e),this.applyMatrix4(Bi),this}rotateZ(e){return Bi.makeRotationZ(e),this.applyMatrix4(Bi),this}translate(e,t,i){return Bi.makeTranslation(e,t,i),this.applyMatrix4(Bi),this}scale(e,t,i){return Bi.makeScale(e,t,i),this.applyMatrix4(Bi),this}lookAt(e){return j_.lookAt(e),j_.updateMatrix(),this.applyMatrix4(j_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ul).negate(),this.translate(ul.x,ul.y,ul.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ce(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new bi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new E(-1/0,-1/0,-1/0),new E(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Mi.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(wn.addVectors(this.boundingBox.min,Mi.min),this.boundingBox.expandByPoint(wn),wn.addVectors(this.boundingBox.max,Mi.max),this.boundingBox.expandByPoint(wn)):(this.boundingBox.expandByPoint(Mi.min),this.boundingBox.expandByPoint(Mi.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Eo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new E,1/0);if(e){const i=this.boundingSphere.center;if(Mi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)du.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(wn.addVectors(Mi.min,du.min),Mi.expandByPoint(wn),wn.addVectors(Mi.max,du.max),Mi.expandByPoint(wn)):(Mi.expandByPoint(du.min),Mi.expandByPoint(du.max));Mi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)wn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(wn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)wn.fromBufferAttribute(a,c),l&&(ul.fromBufferAttribute(e,c),wn.add(ul)),r=Math.max(r,i.distanceToSquared(wn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new $t(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let R=0;R<a;R++)c[R]=new E,u[R]=new E;const d=new E,h=new E,f=new E,m=new X,p=new X,g=new X,_=new E,v=new E;function y(R,F,H){d.fromArray(r,3*R),h.fromArray(r,3*F),f.fromArray(r,3*H),m.fromArray(o,2*R),p.fromArray(o,2*F),g.fromArray(o,2*H),h.sub(d),f.sub(d),p.sub(m),g.sub(m);const N=1/(p.x*g.y-g.x*p.y);isFinite(N)&&(_.copy(h).multiplyScalar(g.y).addScaledVector(f,-p.y).multiplyScalar(N),v.copy(f).multiplyScalar(p.x).addScaledVector(h,-g.x).multiplyScalar(N),c[R].add(_),c[F].add(_),c[H].add(_),u[R].add(v),u[F].add(v),u[H].add(v))}let x=this.groups;0===x.length&&(x=[{start:0,count:i.length}]);for(let R=0,F=x.length;R<F;++R){const H=x[R],N=H.start;for(let U=N,Y=N+H.count;U<Y;U+=3)y(i[U+0],i[U+1],i[U+2])}const w=new E,M=new E,T=new E,b=new E;function S(R){T.fromArray(s,3*R),b.copy(T);const F=c[R];w.copy(F),w.sub(T.multiplyScalar(T.dot(F))).normalize(),M.crossVectors(b,F);const N=M.dot(u[R])<0?-1:1;l[4*R]=w.x,l[4*R+1]=w.y,l[4*R+2]=w.z,l[4*R+3]=N}for(let R=0,F=x.length;R<F;++R){const H=x[R],N=H.start;for(let U=N,Y=N+H.count;U<Y;U+=3)S(i[U+0]),S(i[U+1]),S(i[U+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new $t(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new E,s=new E,o=new E,a=new E,l=new E,c=new E,u=new E,d=new E;if(e)for(let h=0,f=e.count;h<f;h+=3){const m=e.getX(h+0),p=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,m),s.fromBufferAttribute(t,p),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,m),l.fromBufferAttribute(i,p),c.fromBufferAttribute(i,g),a.add(u),l.add(u),c.add(u),i.setXYZ(m,a.x,a.y,a.z),i.setXYZ(p,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)wn.fromBufferAttribute(e,t),wn.normalize(),e.setXYZ(t,wn.x,wn.y,wn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,m=0;for(let p=0,g=l.length;p<g;p++){f=a.isInterleavedBufferAttribute?l[p]*a.data.stride+a.offset:l[p]*u;for(let _=0;_<u;_++)h[m++]=c[f++]}return new $t(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new it,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const NT=new $e,Dr=new df,gf=new Eo,FT=new E,hu=new E,fu=new E,pu=new E,$_=new E,yf=new E,_f=new X,vf=new X,xf=new X,q_=new E,bf=new E;class Hn extends bn{constructor(e=new it,t=new Vi){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){yf.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l];0!==u&&($_.fromBufferAttribute(s[l],e),yf.addScaledVector(o?$_:$_.sub(t),u))}t.add(yf)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),gf.copy(i.boundingSphere),gf.applyMatrix4(s),Dr.copy(e.ray).recast(e.near),!1===gf.containsPoint(Dr.origin)&&(null===Dr.intersectSphere(gf,FT)||Dr.origin.distanceToSquared(FT)>(e.far-e.near)**2))||(NT.copy(s).invert(),Dr.copy(e.ray).applyMatrix4(NT),null!==i.boundingBox&&!1===Dr.intersectsBox(i.boundingBox)))return;let o;const a=i.index,l=i.attributes.position,c=i.attributes.uv,u=i.attributes.uv2,d=i.groups,h=i.drawRange;if(null!==a)if(Array.isArray(r))for(let f=0,m=d.length;f<m;f++){const p=d[f],g=r[p.materialIndex];for(let y=Math.max(p.start,h.start),x=Math.min(a.count,Math.min(p.start+p.count,h.start+h.count));y<x;y+=3){const w=a.getX(y),M=a.getX(y+1),T=a.getX(y+2);o=wf(this,g,e,Dr,c,u,w,M,T),o&&(o.faceIndex=Math.floor(y/3),o.face.materialIndex=p.materialIndex,t.push(o))}}else for(let p=Math.max(0,h.start),g=Math.min(a.count,h.start+h.count);p<g;p+=3){const _=a.getX(p),v=a.getX(p+1),y=a.getX(p+2);o=wf(this,r,e,Dr,c,u,_,v,y),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let f=0,m=d.length;f<m;f++){const p=d[f],g=r[p.materialIndex];for(let y=Math.max(p.start,h.start),x=Math.min(l.count,Math.min(p.start+p.count,h.start+h.count));y<x;y+=3)o=wf(this,g,e,Dr,c,u,y,y+1,y+2),o&&(o.faceIndex=Math.floor(y/3),o.face.materialIndex=p.materialIndex,t.push(o))}else for(let p=Math.max(0,h.start),g=Math.min(l.count,h.start+h.count);p<g;p+=3)o=wf(this,r,e,Dr,c,u,p,p+1,p+2),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}}function wf(n,e,t,i,r,s,o,a,l){n.getVertexPosition(o,hu),n.getVertexPosition(a,fu),n.getVertexPosition(l,pu);const c=function F5(n,e,t,i,r,s,o,a){let l;if(l=e.side===vi?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,e.side===Qr,a),null===l)return null;bf.copy(a),bf.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(bf);return c<t.near||c>t.far?null:{distance:c,point:bf.clone(),object:n}}(n,e,t,i,hu,fu,pu,q_);if(c){r&&(_f.fromBufferAttribute(r,o),vf.fromBufferAttribute(r,a),xf.fromBufferAttribute(r,l),c.uv=or.getUV(q_,hu,fu,pu,_f,vf,xf,new X)),s&&(_f.fromBufferAttribute(s,o),vf.fromBufferAttribute(s,a),xf.fromBufferAttribute(s,l),c.uv2=or.getUV(q_,hu,fu,pu,_f,vf,xf,new X));const u={a:o,b:a,c:l,normal:new E,materialIndex:0};or.getNormal(hu,fu,pu,u.normal),c.face=u}return c}class dl extends it{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function m(p,g,_,v,y,x,w,M,T,b,S){const R=x/T,F=w/b,H=x/2,N=w/2,P=M/2,U=T+1,Y=b+1;let ie=0,j=0;const J=new E;for(let ne=0;ne<Y;ne++){const _e=ne*F-N;for(let z=0;z<U;z++)J[p]=(z*R-H)*v,J[g]=_e*y,J[_]=P,c.push(J.x,J.y,J.z),J[p]=0,J[g]=0,J[_]=M>0?1:-1,u.push(J.x,J.y,J.z),d.push(z/T),d.push(1-ne/b),ie+=1}for(let ne=0;ne<b;ne++)for(let _e=0;_e<T;_e++){const ee=h+_e+U*(ne+1),oe=h+(_e+1)+U*(ne+1),k=h+(_e+1)+U*ne;l.push(h+_e+U*ne,ee,k),l.push(ee,oe,k),j+=6}a.addGroup(f,j,S),f+=j,h+=ie}m("z","y","x",-1,-1,i,t,e,o,s,0),m("z","y","x",1,-1,i,t,-e,o,s,1),m("x","z","y",1,1,e,i,t,r,o,2),m("x","z","y",1,-1,e,i,-t,r,o,3),m("x","y","z",1,-1,e,t,i,r,s,4),m("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ce(c,3)),this.setAttribute("normal",new Ce(u,3)),this.setAttribute("uv",new Ce(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function hl(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function Kn(n){const e={};for(let t=0;t<n.length;t++){const i=hl(n[t]);for(const r in i)e[r]=i[r]}return e}function OT(n){return null===n.getRenderTarget()&&n.outputEncoding===wt?Er:ru}const k5={clone:hl,merge:Kn};class Os extends ar{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=hl(e.uniforms),this.uniformsGroups=function O5(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class X_ extends bn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new $e,this.projectionMatrix=new $e,this.projectionMatrixInverse=new $e}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class dn extends X_{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*su*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*bo*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*su*Math.atan(Math.tan(.5*bo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*bo*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class U5 extends bn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new dn(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new dn(-90,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new dn(-90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new dn(-90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new dn(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new dn(-90,1,e,t);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),d=e.toneMapping,h=e.xr.enabled;e.toneMapping=ts,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=d,e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}}class Mf extends ir{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:ho,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class z5 extends wo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new Mf([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:jt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new dl(5,5,5),s=new Os({name:"CubemapFromEquirect",uniforms:hl(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:vi,blending:Ts});s.uniforms.tEquirect.value=t;const o=new Hn(r,s),a=t.minFilter;return t.minFilter===ns&&(t.minFilter=jt),new U5(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const Y_=new E,H5=new E,G5=new Un;class Do{constructor(e=new E(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Y_.subVectors(i,t).cross(H5.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Y_),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||G5.getNormalMatrix(e),r=this.coplanarPoint(Y_).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const ml=new Eo,Sf=new E;class Z_{constructor(e=new Do,t=new Do,i=new Do,r=new Do,s=new Do,o=new Do){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7],h=i[8],f=i[9],m=i[10],p=i[11],g=i[12],_=i[13],v=i[14],y=i[15];return t[0].setComponents(a-r,d-l,p-h,y-g).normalize(),t[1].setComponents(a+r,d+l,p+h,y+g).normalize(),t[2].setComponents(a+s,d+c,p+f,y+_).normalize(),t[3].setComponents(a-s,d-c,p-f,y-_).normalize(),t[4].setComponents(a-o,d-u,p-m,y-v).normalize(),t[5].setComponents(a+o,d+u,p+m,y+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),ml.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(ml)}intersectsSprite(e){return ml.center.set(0,0,0),ml.radius=.7071067811865476,ml.applyMatrix4(e.matrixWorld),this.intersectsSphere(ml)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Sf.x=r.normal.x>0?e.max.x:e.min.x,Sf.y=r.normal.y>0?e.max.y:e.min.y,Sf.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Sf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function kT(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function W5(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let m;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)m=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");m=5131}else m=5123;else if(d instanceof Int16Array)m=5122;else if(d instanceof Uint32Array)m=5125;else if(d instanceof Int32Array)m=5124;else if(d instanceof Int8Array)m=5120;else if(d instanceof Uint8Array)m=5121;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);m=5121}return{buffer:f,type:m,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(d.buffer,c,u),d.version=c.version)}}}class Cf extends it{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],m=[],p=[],g=[];for(let _=0;_<u;_++){const v=_*h-o;for(let y=0;y<c;y++)m.push(y*d-s,-v,0),p.push(0,0,1),g.push(y/a),g.push(1-_/l)}for(let _=0;_<l;_++)for(let v=0;v<a;v++){const x=v+c*(_+1),w=v+1+c*(_+1),M=v+1+c*_;f.push(v+c*_,x,M),f.push(x,w,M)}this.setIndex(f),this.setAttribute("position",new Ce(m,3)),this.setAttribute("normal",new Ce(p,3)),this.setAttribute("uv",new Ce(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cf(e.width,e.height,e.widthSegments,e.heightSegments)}}const tt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\t\n\t\tvec2 lodFudge = pow( 1.95, lod ) / fullSize;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec2 fullSize = vec2( textureSize( sampler, 0 ) );\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ue={common:{diffuse:{value:new de(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Un},uv2Transform:{value:new Un},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new X(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new de(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new de(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Un}},sprite:{diffuse:{value:new de(16777215)},opacity:{value:1},center:{value:new X(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Un}}},Ar={basic:{uniforms:Kn([ue.common,ue.specularmap,ue.envmap,ue.aomap,ue.lightmap,ue.fog]),vertexShader:tt.meshbasic_vert,fragmentShader:tt.meshbasic_frag},lambert:{uniforms:Kn([ue.common,ue.specularmap,ue.envmap,ue.aomap,ue.lightmap,ue.emissivemap,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.fog,ue.lights,{emissive:{value:new de(0)}}]),vertexShader:tt.meshlambert_vert,fragmentShader:tt.meshlambert_frag},phong:{uniforms:Kn([ue.common,ue.specularmap,ue.envmap,ue.aomap,ue.lightmap,ue.emissivemap,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.fog,ue.lights,{emissive:{value:new de(0)},specular:{value:new de(1118481)},shininess:{value:30}}]),vertexShader:tt.meshphong_vert,fragmentShader:tt.meshphong_frag},standard:{uniforms:Kn([ue.common,ue.envmap,ue.aomap,ue.lightmap,ue.emissivemap,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.roughnessmap,ue.metalnessmap,ue.fog,ue.lights,{emissive:{value:new de(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tt.meshphysical_vert,fragmentShader:tt.meshphysical_frag},toon:{uniforms:Kn([ue.common,ue.aomap,ue.lightmap,ue.emissivemap,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.gradientmap,ue.fog,ue.lights,{emissive:{value:new de(0)}}]),vertexShader:tt.meshtoon_vert,fragmentShader:tt.meshtoon_frag},matcap:{uniforms:Kn([ue.common,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.fog,{matcap:{value:null}}]),vertexShader:tt.meshmatcap_vert,fragmentShader:tt.meshmatcap_frag},points:{uniforms:Kn([ue.points,ue.fog]),vertexShader:tt.points_vert,fragmentShader:tt.points_frag},dashed:{uniforms:Kn([ue.common,ue.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tt.linedashed_vert,fragmentShader:tt.linedashed_frag},depth:{uniforms:Kn([ue.common,ue.displacementmap]),vertexShader:tt.depth_vert,fragmentShader:tt.depth_frag},normal:{uniforms:Kn([ue.common,ue.bumpmap,ue.normalmap,ue.displacementmap,{opacity:{value:1}}]),vertexShader:tt.meshnormal_vert,fragmentShader:tt.meshnormal_frag},sprite:{uniforms:Kn([ue.sprite,ue.fog]),vertexShader:tt.sprite_vert,fragmentShader:tt.sprite_frag},background:{uniforms:{uvTransform:{value:new Un},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:tt.background_vert,fragmentShader:tt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:tt.backgroundCube_vert,fragmentShader:tt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:tt.cube_vert,fragmentShader:tt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tt.equirect_vert,fragmentShader:tt.equirect_frag},distanceRGBA:{uniforms:Kn([ue.common,ue.displacementmap,{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tt.distanceRGBA_vert,fragmentShader:tt.distanceRGBA_frag},shadow:{uniforms:Kn([ue.lights,ue.fog,{color:{value:new de(0)},opacity:{value:1}}]),vertexShader:tt.shadow_vert,fragmentShader:tt.shadow_frag}};Ar.physical={uniforms:Kn([Ar.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new X(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new de(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new X},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new de(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new de(1,1,1)},specularColorMap:{value:null}}]),vertexShader:tt.meshphysical_vert,fragmentShader:tt.meshphysical_frag};const Ef={r:0,b:0,g:0};function G8(n,e,t,i,r,s,o){const a=new de(0);let c,u,l=!0===s?0:1,d=null,h=0,f=null;function p(g,_){g.getRGB(Ef,OT(n)),i.buffers.color.setClear(Ef.r,Ef.g,Ef.b,_,o)}return{getClearColor:function(){return a},setClearColor:function(g,_=1){a.set(g),l=_,p(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,p(a,l)},render:function m(g,_){let v=!1,y=!0===_.isScene?_.background:null;y&&y.isTexture&&(y=(_.backgroundBlurriness>0?t:e).get(y));const x=n.xr,w=x.getSession&&x.getSession();w&&"additive"===w.environmentBlendMode&&(y=null),null===y?p(a,l):y&&y.isColor&&(p(y,1),v=!0),(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===Qc)?(void 0===u&&(u=new Hn(new dl(1,1,1),new Os({name:"BackgroundCubeMaterial",uniforms:hl(Ar.backgroundCube.uniforms),vertexShader:Ar.backgroundCube.vertexShader,fragmentShader:Ar.backgroundCube.fragmentShader,side:vi,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,T,b){this.matrixWorld.copyPosition(b.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=_.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=_.backgroundIntensity,u.material.toneMapped=y.encoding!==wt,(d!==y||h!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(void 0===c&&(c=new Hn(new Cf(2,2),new Os({name:"BackgroundMaterial",uniforms:hl(Ar.background.uniforms),vertexShader:Ar.background.vertexShader,fragmentShader:Ar.background.fragmentShader,side:Qr,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=y,c.material.uniforms.backgroundIntensity.value=_.backgroundIntensity,c.material.toneMapped=y.encoding!==wt,!0===y.matrixAutoUpdate&&y.updateMatrix(),c.material.uniforms.uvTransform.value.copy(y.matrix),(d!==y||h!==y.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}}}function W8(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(P){return i.isWebGL2?n.bindVertexArray(P):s.bindVertexArrayOES(P)}function m(P){return i.isWebGL2?n.deleteVertexArray(P):s.deleteVertexArrayOES(P)}function g(P){const U=[],Y=[],ie=[];for(let j=0;j<r;j++)U[j]=0,Y[j]=0,ie[j]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:Y,attributeDivisors:ie,object:P,attributes:{},index:null}}function y(){const P=c.newAttributes;for(let U=0,Y=P.length;U<Y;U++)P[U]=0}function x(P){w(P,0)}function w(P,U){const ie=c.enabledAttributes,j=c.attributeDivisors;c.newAttributes[P]=1,0===ie[P]&&(n.enableVertexAttribArray(P),ie[P]=1),j[P]!==U&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](P,U),j[P]=U)}function M(){const P=c.newAttributes,U=c.enabledAttributes;for(let Y=0,ie=U.length;Y<ie;Y++)U[Y]!==P[Y]&&(n.disableVertexAttribArray(Y),U[Y]=0)}function T(P,U,Y,ie,j,J){!0!==i.isWebGL2||5124!==Y&&5125!==Y?n.vertexAttribPointer(P,U,Y,ie,j,J):n.vertexAttribIPointer(P,U,Y,j,J)}function H(){N(),u=!0,c!==l&&(c=l,f(c.object))}function N(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(P,U,Y,ie,j){let J=!1;if(o){const ne=function p(P,U,Y){const ie=!0===Y.wireframe;let j=a[P.id];void 0===j&&(j={},a[P.id]=j);let J=j[U.id];void 0===J&&(J={},j[U.id]=J);let ne=J[ie];return void 0===ne&&(ne=g(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),J[ie]=ne),ne}(ie,Y,U);c!==ne&&(c=ne,f(c.object)),J=function _(P,U,Y,ie){const j=c.attributes,J=U.attributes;let ne=0;const _e=Y.getAttributes();for(const z in _e)if(_e[z].location>=0){const oe=j[z];let k=J[z];if(void 0===k&&("instanceMatrix"===z&&P.instanceMatrix&&(k=P.instanceMatrix),"instanceColor"===z&&P.instanceColor&&(k=P.instanceColor)),void 0===oe||oe.attribute!==k||k&&oe.data!==k.data)return!0;ne++}return c.attributesNum!==ne||c.index!==ie}(P,ie,Y,j),J&&function v(P,U,Y,ie){const j={},J=U.attributes;let ne=0;const _e=Y.getAttributes();for(const z in _e)if(_e[z].location>=0){let oe=J[z];void 0===oe&&("instanceMatrix"===z&&P.instanceMatrix&&(oe=P.instanceMatrix),"instanceColor"===z&&P.instanceColor&&(oe=P.instanceColor));const k={};k.attribute=oe,oe&&oe.data&&(k.data=oe.data),j[z]=k,ne++}c.attributes=j,c.attributesNum=ne,c.index=ie}(P,ie,Y,j)}else{const ne=!0===U.wireframe;(c.geometry!==ie.id||c.program!==Y.id||c.wireframe!==ne)&&(c.geometry=ie.id,c.program=Y.id,c.wireframe=ne,J=!0)}null!==j&&t.update(j,34963),(J||u)&&(u=!1,function b(P,U,Y,ie){if(!1===i.isWebGL2&&(P.isInstancedMesh||ie.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const j=ie.attributes,J=Y.getAttributes(),ne=U.defaultAttributeValues;for(const _e in J){const z=J[_e];if(z.location>=0){let ee=j[_e];if(void 0===ee&&("instanceMatrix"===_e&&P.instanceMatrix&&(ee=P.instanceMatrix),"instanceColor"===_e&&P.instanceColor&&(ee=P.instanceColor)),void 0!==ee){const oe=ee.normalized,k=ee.itemSize,he=t.get(ee);if(void 0===he)continue;const me=he.buffer,ve=he.type,Se=he.bytesPerElement;if(ee.isInterleavedBufferAttribute){const we=ee.data,Le=we.stride,Z=ee.offset;if(we.isInstancedInterleavedBuffer){for(let te=0;te<z.locationSize;te++)w(z.location+te,we.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===ie._maxInstanceCount&&(ie._maxInstanceCount=we.meshPerAttribute*we.count)}else for(let te=0;te<z.locationSize;te++)x(z.location+te);n.bindBuffer(34962,me);for(let te=0;te<z.locationSize;te++)T(z.location+te,k/z.locationSize,ve,oe,Le*Se,(Z+k/z.locationSize*te)*Se)}else{if(ee.isInstancedBufferAttribute){for(let we=0;we<z.locationSize;we++)w(z.location+we,ee.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===ie._maxInstanceCount&&(ie._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let we=0;we<z.locationSize;we++)x(z.location+we);n.bindBuffer(34962,me);for(let we=0;we<z.locationSize;we++)T(z.location+we,k/z.locationSize,ve,oe,k*Se,k/z.locationSize*we*Se)}}else if(void 0!==ne){const oe=ne[_e];if(void 0!==oe)switch(oe.length){case 2:n.vertexAttrib2fv(z.location,oe);break;case 3:n.vertexAttrib3fv(z.location,oe);break;case 4:n.vertexAttrib4fv(z.location,oe);break;default:n.vertexAttrib1fv(z.location,oe)}}}}M()}(P,U,Y,ie),null!==j&&n.bindBuffer(34963,t.get(j).buffer))},reset:H,resetDefaultState:N,dispose:function S(){H();for(const P in a){const U=a[P];for(const Y in U){const ie=U[Y];for(const j in ie)m(ie[j].object),delete ie[j];delete U[Y]}delete a[P]}},releaseStatesOfGeometry:function R(P){if(void 0===a[P.id])return;const U=a[P.id];for(const Y in U){const ie=U[Y];for(const j in ie)m(ie[j].object),delete ie[j];delete U[Y]}delete a[P.id]},releaseStatesOfProgram:function F(P){for(const U in a){const Y=a[U];if(void 0===Y[P.id])continue;const ie=Y[P.id];for(const j in ie)m(ie[j].object),delete ie[j];delete Y[P.id]}},initAttributes:y,enableAttribute:x,disableUnusedAttributes:M}}function j8(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,u,d),t.update(u,s,d)}}function $8(n,e,t){let i;function s(T){if("highp"===T){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return"mediump"===T&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(34930),h=n.getParameter(35660),f=n.getParameter(3379),m=n.getParameter(34076),p=n.getParameter(34921),g=n.getParameter(36347),_=n.getParameter(36348),v=n.getParameter(36349),y=h>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const T=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:m,maxAttributes:p,maxVertexUniforms:g,maxVaryings:_,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:x,floatVertexTextures:y&&x,maxSamples:o?n.getParameter(36183):0}}function q8(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Do,a=new Un,l={value:null,needsUpdate:!1};function u(d,h,f,m){const p=null!==d?d.length:0;let g=null;if(0!==p){if(g=l.value,!0!==m||null===g){const _=f+4*p,v=h.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<_)&&(g=new Float32Array(_));for(let y=0,x=f;y!==p;++y,x+=4)o.copy(d[y]).applyMatrix4(v,a),o.normal.toArray(g,x),g[x+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=p,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const m=d.clippingPlanes,p=d.clipIntersection,g=d.clipShadows,_=n.get(d);if(!r||null===m||0===m.length||s&&!g)s?u(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const v=s?0:i,y=4*v;let x=_.clippingState||null;l.value=x,x=u(m,h,y,f);for(let w=0;w!==y;++w)x[w]=t[w];_.clippingState=x,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=v}}}function X8(n){let e=new WeakMap;function t(o,a){return a===ef?o.mapping=ho:a===tf&&(o.mapping=fo),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===ef||a===tf){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new z5(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Df extends X_{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const VT=[.125,.215,.35,.446,.526,.582],K_=new Df,BT=new de;let J_=null;const To=(1+Math.sqrt(5))/2,yl=1/To,UT=[new E(1,1,1),new E(-1,1,1),new E(1,1,-1),new E(-1,1,-1),new E(0,To,yl),new E(0,To,-yl),new E(yl,0,To),new E(-yl,0,To),new E(To,yl,0),new E(-To,yl,0)];class zT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){J_=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=WT(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=GT(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(J_),e.scissorTest=!1,Af(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===ho||e.mapping===fo?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),J_=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:jt,minFilter:jt,generateMipmaps:!1,type:nu,format:ki,encoding:_o,depthBuffer:!1},r=HT(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=HT(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Y8(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+VT.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=VT[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,m=6,p=3,g=2,_=1,v=new Float32Array(p*m*f),y=new Float32Array(g*m*f),x=new Float32Array(_*m*f);for(let M=0;M<f;M++){const T=M%3*2/3-1,b=M>2?0:-1;v.set([T,b,0,T+2/3,b,0,T+2/3,b+1,0,T,b,0,T+2/3,b+1,0,T,b+1,0],p*m*M),y.set(h,g*m*M),x.set([M,M,M,M,M,M],_*m*M)}const w=new it;w.setAttribute("position",new $t(v,p)),w.setAttribute("uv",new $t(y,g)),w.setAttribute("faceIndex",new $t(x,_)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function Z8(n,e,t){const i=new Float32Array(20),r=new E(0,1,0);return new Os({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Ts,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Hn(this._lodPlanes[0],e);this._renderer.compile(t,K_)}_sceneToCubeUV(e,t,i,r){const a=new dn(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(BT),u.toneMapping=ts,u.autoClear=!1;const f=new Vi({name:"PMREM.Background",side:vi,depthWrite:!1,depthTest:!1}),m=new Hn(new dl,f);let p=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,p=!0):(f.color.copy(BT),p=!0);for(let _=0;_<6;_++){const v=_%3;0===v?(a.up.set(0,l[_],0),a.lookAt(c[_],0,0)):1===v?(a.up.set(0,0,l[_]),a.lookAt(0,c[_],0)):(a.up.set(0,l[_],0),a.lookAt(0,0,c[_]));const y=this._cubeSize;Af(r,v*y,_>2?y:0,y,y),u.setRenderTarget(r),p&&u.render(m,a),u.render(e,a)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===ho||e.mapping===fo;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=WT()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=GT());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Hn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;Af(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,K_)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,UT[(r-1)%UT.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new Hn(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,m=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,p=s/m,g=isFinite(s)?1+Math.floor(3*p):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const _=[];let v=0;for(let T=0;T<20;++T){const b=T/p,S=Math.exp(-b*b/2);_.push(S),0===T?v+=S:T<g&&(v+=2*S)}for(let T=0;T<_.length;T++)_[T]=_[T]/v;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=_,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:y}=this;h.dTheta.value=m,h.mipInt.value=y-i;const x=this._sizeLods[r];Af(t,3*x*(r>y-4?r-y+4:0),4*(this._cubeSize-x),3*x,2*x),l.setRenderTarget(t),l.render(d,K_)}}function HT(n,e,t){const i=new wo(n,e,t);return i.texture.mapping=Qc,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Af(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function GT(){return new Os({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Ts,depthTest:!1,depthWrite:!1})}function WT(){return new Os({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Ts,depthTest:!1,depthWrite:!1})}function K8(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===ef||l===tf,u=l===ho||l===fo;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new zT(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new zT(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function J8(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Q8(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const m in h.attributes)e.remove(h.attributes[m]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,m=d.attributes.position;let p=0;if(null!==f){const v=f.array;p=f.version;for(let y=0,x=v.length;y<x;y+=3){const w=v[y+0],M=v[y+1],T=v[y+2];h.push(w,M,M,T,T,w)}}else{p=m.version;for(let y=0,x=m.array.length/3-1;y<x;y+=3){const w=y+0,M=y+1,T=y+2;h.push(w,M,M,T,T,w)}}const g=new(vT(h)?LT:PT)(h,1);g.version=p;const _=s.get(d);_&&e.remove(_),s.set(d,g)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const m in h)e.update(h[m],34962);const f=d.morphAttributes;for(const m in f){const p=f[m];for(let g=0,_=p.length;g<_;g++)e.update(p[g],34962)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function e6(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function d(h,f,m){if(0===m)return;let p,g;if(r)p=n,g="drawElementsInstanced";else if(p=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===p)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[g](s,f,a,h*l,m),t.update(f,s,m)}}function t6(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function n6(n,e){return n[0]-e[0]}function i6(n,e){return Math.abs(e[1])-Math.abs(n[1])}function r6(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Ct,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d){const h=c.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=void 0!==f?f.length:0;let p=s.get(u);if(void 0===p||p.count!==m){let P=function(){H.dispose(),s.delete(u),u.removeEventListener("dispose",P)};void 0!==p&&p.texture.dispose();const v=void 0!==u.morphAttributes.position,y=void 0!==u.morphAttributes.normal,x=void 0!==u.morphAttributes.color,w=u.morphAttributes.position||[],M=u.morphAttributes.normal||[],T=u.morphAttributes.color||[];let b=0;!0===v&&(b=1),!0===y&&(b=2),!0===x&&(b=3);let S=u.attributes.position.count*b,R=1;S>e.maxTextureSize&&(R=Math.ceil(S/e.maxTextureSize),S=e.maxTextureSize);const F=new Float32Array(S*R*4*m),H=new P_(F,S,R,m);H.type=Is,H.needsUpdate=!0;const N=4*b;for(let U=0;U<m;U++){const Y=w[U],ie=M[U],j=T[U],J=S*R*4*U;for(let ne=0;ne<Y.count;ne++){const _e=ne*N;!0===v&&(o.fromBufferAttribute(Y,ne),F[J+_e+0]=o.x,F[J+_e+1]=o.y,F[J+_e+2]=o.z,F[J+_e+3]=0),!0===y&&(o.fromBufferAttribute(ie,ne),F[J+_e+4]=o.x,F[J+_e+5]=o.y,F[J+_e+6]=o.z,F[J+_e+7]=0),!0===x&&(o.fromBufferAttribute(j,ne),F[J+_e+8]=o.x,F[J+_e+9]=o.y,F[J+_e+10]=o.z,F[J+_e+11]=4===j.itemSize?o.w:1)}}p={count:m,texture:H,size:new X(S,R)},s.set(u,p),u.addEventListener("dispose",P)}let g=0;for(let v=0;v<h.length;v++)g+=h[v];const _=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(n,"morphTargetBaseInfluence",_),d.getUniforms().setValue(n,"morphTargetInfluences",h),d.getUniforms().setValue(n,"morphTargetsTexture",p.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",p.size)}else{const f=void 0===h?0:h.length;let m=i[u.id];if(void 0===m||m.length!==f){m=[];for(let y=0;y<f;y++)m[y]=[y,0];i[u.id]=m}for(let y=0;y<f;y++){const x=m[y];x[0]=y,x[1]=h[y]}m.sort(i6);for(let y=0;y<8;y++)y<f&&m[y][1]?(a[y][0]=m[y][0],a[y][1]=m[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(n6);const p=u.morphAttributes.position,g=u.morphAttributes.normal;let _=0;for(let y=0;y<8;y++){const x=a[y],w=x[0],M=x[1];w!==Number.MAX_SAFE_INTEGER&&M?(p&&u.getAttribute("morphTarget"+y)!==p[w]&&u.setAttribute("morphTarget"+y,p[w]),g&&u.getAttribute("morphNormal"+y)!==g[w]&&u.setAttribute("morphNormal"+y,g[w]),r[y]=M,_+=M):(p&&!0===u.hasAttribute("morphTarget"+y)&&u.deleteAttribute("morphTarget"+y),g&&!0===u.hasAttribute("morphNormal"+y)&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const v=u.morphTargetsRelative?1:1-_;d.getUniforms().setValue(n,"morphTargetBaseInfluence",v),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function s6(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);return r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),d},dispose:function o(){r=new WeakMap}}}const jT=new ir,$T=new P_,qT=new wT,XT=new Mf,YT=[],ZT=[],KT=new Float32Array(16),JT=new Float32Array(9),QT=new Float32Array(4);function _l(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=YT[r];if(void 0===s&&(s=new Float32Array(r),YT[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function _n(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function vn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function Tf(n,e){let t=ZT[e];void 0===t&&(t=new Int32Array(e),ZT[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function o6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function a6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_n(t,e))return;n.uniform2fv(this.addr,e),vn(t,e)}}function l6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(_n(t,e))return;n.uniform3fv(this.addr,e),vn(t,e)}}function c6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_n(t,e))return;n.uniform4fv(this.addr,e),vn(t,e)}}function u6(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(_n(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),vn(t,e)}else{if(_n(t,i))return;QT.set(i),n.uniformMatrix2fv(this.addr,!1,QT),vn(t,i)}}function d6(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(_n(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),vn(t,e)}else{if(_n(t,i))return;JT.set(i),n.uniformMatrix3fv(this.addr,!1,JT),vn(t,i)}}function h6(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(_n(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),vn(t,e)}else{if(_n(t,i))return;KT.set(i),n.uniformMatrix4fv(this.addr,!1,KT),vn(t,i)}}function f6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function p6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_n(t,e))return;n.uniform2iv(this.addr,e),vn(t,e)}}function m6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_n(t,e))return;n.uniform3iv(this.addr,e),vn(t,e)}}function g6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_n(t,e))return;n.uniform4iv(this.addr,e),vn(t,e)}}function y6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function _6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_n(t,e))return;n.uniform2uiv(this.addr,e),vn(t,e)}}function v6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_n(t,e))return;n.uniform3uiv(this.addr,e),vn(t,e)}}function x6(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_n(t,e))return;n.uniform4uiv(this.addr,e),vn(t,e)}}function b6(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||jT,r)}function w6(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||qT,r)}function M6(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||XT,r)}function S6(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||$T,r)}function E6(n,e){n.uniform1fv(this.addr,e)}function D6(n,e){const t=_l(e,this.size,2);n.uniform2fv(this.addr,t)}function A6(n,e){const t=_l(e,this.size,3);n.uniform3fv(this.addr,t)}function T6(n,e){const t=_l(e,this.size,4);n.uniform4fv(this.addr,t)}function I6(n,e){const t=_l(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function R6(n,e){const t=_l(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function P6(n,e){const t=_l(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function L6(n,e){n.uniform1iv(this.addr,e)}function N6(n,e){n.uniform2iv(this.addr,e)}function F6(n,e){n.uniform3iv(this.addr,e)}function O6(n,e){n.uniform4iv(this.addr,e)}function k6(n,e){n.uniform1uiv(this.addr,e)}function V6(n,e){n.uniform2uiv(this.addr,e)}function B6(n,e){n.uniform3uiv(this.addr,e)}function U6(n,e){n.uniform4uiv(this.addr,e)}function z6(n,e,t){const i=this.cache,r=e.length,s=Tf(t,r);_n(i,s)||(n.uniform1iv(this.addr,s),vn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||jT,s[o])}function H6(n,e,t){const i=this.cache,r=e.length,s=Tf(t,r);_n(i,s)||(n.uniform1iv(this.addr,s),vn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||qT,s[o])}function G6(n,e,t){const i=this.cache,r=e.length,s=Tf(t,r);_n(i,s)||(n.uniform1iv(this.addr,s),vn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||XT,s[o])}function W6(n,e,t){const i=this.cache,r=e.length,s=Tf(t,r);_n(i,s)||(n.uniform1iv(this.addr,s),vn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||$T,s[o])}class $6{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function C6(n){switch(n){case 5126:return o6;case 35664:return a6;case 35665:return l6;case 35666:return c6;case 35674:return u6;case 35675:return d6;case 35676:return h6;case 5124:case 35670:return f6;case 35667:case 35671:return p6;case 35668:case 35672:return m6;case 35669:case 35673:return g6;case 5125:return y6;case 36294:return _6;case 36295:return v6;case 36296:return x6;case 35678:case 36198:case 36298:case 36306:case 35682:return b6;case 35679:case 36299:case 36307:return w6;case 35680:case 36300:case 36308:case 36293:return M6;case 36289:case 36303:case 36311:case 36292:return S6}}(t.type)}}class q6{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function j6(n){switch(n){case 5126:return E6;case 35664:return D6;case 35665:return A6;case 35666:return T6;case 35674:return I6;case 35675:return R6;case 35676:return P6;case 5124:case 35670:return L6;case 35667:case 35671:return N6;case 35668:case 35672:return F6;case 35669:case 35673:return O6;case 5125:return k6;case 36294:return V6;case 36295:return B6;case 36296:return U6;case 35678:case 36198:case 36298:case 36306:case 35682:return z6;case 35679:case 36299:case 36307:return H6;case 35680:case 36300:case 36308:case 36293:return G6;case 36289:case 36303:case 36311:case 36292:return W6}}(t.type)}}class X6{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const ev=/(\w+)(\])?(\[|\.)?/g;function e1(n,e){n.seq.push(e),n.map[e.id]=e}function Y6(n,e,t){const i=n.name,r=i.length;for(ev.lastIndex=0;;){const s=ev.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&ev.lastIndex+2===r){e1(t,void 0===c?new $6(a,n,e):new q6(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new X6(a),e1(t,d)),t=d}}}class If{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);Y6(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function t1(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let Z6=0;function n1(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function K6(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function Q6(n,e){const t=function J6(n){switch(n){case _o:return["Linear","( value )"];case wt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function ej(n,e){let t;switch(e){case T4:t="Linear";break;case I4:t="Reinhard";break;case R4:t="OptimizedCineon";break;case P4:t="ACESFilmic";break;case L4:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function mu(n){return""!==n}function i1(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function r1(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const rj=/^[ \t]*#include +<([\w\d./]+)>/gm;function tv(n){return n.replace(rj,sj)}function sj(n,e){const t=tt[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return tv(t)}const oj=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function s1(n){return n.replace(oj,aj)}function aj(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function o1(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function fj(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function lj(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===NA?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===a4?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Jc&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function cj(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case ho:case fo:e="ENVMAP_TYPE_CUBE";break;case Qc:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function uj(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===fo&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function dj(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Qh:e="ENVMAP_BLENDING_MULTIPLY";break;case D4:e="ENVMAP_BLENDING_MIX";break;case A4:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function hj(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function tj(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(mu).join("\n")}(t),m=function nj(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),p=r.createProgram();let g,_,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[m].filter(mu).join("\n"),g.length>0&&(g+="\n"),_=[f,m].filter(mu).join("\n"),_.length>0&&(_+="\n")):(g=[o1(t),"#define SHADER_NAME "+t.shaderName,m,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(mu).join("\n"),_=[f,o1(t),"#define SHADER_NAME "+t.shaderName,m,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ts?"#define TONE_MAPPING":"",t.toneMapping!==ts?tt.tonemapping_pars_fragment:"",t.toneMapping!==ts?ej("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",tt.encodings_pars_fragment,Q6("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(mu).join("\n")),o=tv(o),o=i1(o,t),o=r1(o,t),a=tv(a),a=i1(a,t),a=r1(a,t),o=s1(o),a=s1(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,_=["#define varying in",t.glslVersion===mT?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===mT?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const x=v+_+a,w=t1(r,35633,v+g+o),M=t1(r,35632,x);if(r.attachShader(p,w),r.attachShader(p,M),void 0!==t.index0AttributeName?r.bindAttribLocation(p,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(p,0,"position"),r.linkProgram(p),n.debug.checkShaderErrors){const S=r.getProgramInfoLog(p).trim(),R=r.getShaderInfoLog(w).trim(),F=r.getShaderInfoLog(M).trim();let H=!0,N=!0;if(!1===r.getProgramParameter(p,35714)){H=!1;const P=n1(r,w,"vertex"),U=n1(r,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(p,35715)+"\n\nProgram Info Log: "+S+"\n"+P+"\n"+U)}else""!==S?console.warn("THREE.WebGLProgram: Program Info Log:",S):(""===R||""===F)&&(N=!1);N&&(this.diagnostics={runnable:H,programLog:S,vertexShader:{log:R,prefix:g},fragmentShader:{log:F,prefix:_}})}let T,b;return r.deleteShader(w),r.deleteShader(M),this.getUniforms=function(){return void 0===T&&(T=new If(r,p)),T},this.getAttributes=function(){return void 0===b&&(b=function ij(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,p)),b},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=Z6++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=w,this.fragmentShader=M,this}let pj=0;class mj{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new gj(e),t.set(e,i)),i}}class gj{constructor(e){this.id=pj++,this.code=e,this.usedTimes=0}}function yj(n,e,t,i,r,s,o){const a=new B_,l=new mj,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function p(b,S,R,F,H){const N=F.fog,P=H.geometry,Y=(b.isMeshStandardMaterial?t:e).get(b.envMap||(b.isMeshStandardMaterial?F.environment:null)),ie=Y&&Y.mapping===Qc?Y.image.height:null,j=m[b.type];null!==b.precision&&(f=r.getMaxPrecision(b.precision),f!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",f,"instead."));const J=P.morphAttributes.position||P.morphAttributes.normal||P.morphAttributes.color,ne=void 0!==J?J.length:0;let z,ee,oe,k,_e=0;if(void 0!==P.morphAttributes.position&&(_e=1),void 0!==P.morphAttributes.normal&&(_e=2),void 0!==P.morphAttributes.color&&(_e=3),j){const Le=Ar[j];z=Le.vertexShader,ee=Le.fragmentShader}else z=b.vertexShader,ee=b.fragmentShader,l.update(b),oe=l.getVertexShaderID(b),k=l.getFragmentShaderID(b);const he=n.getRenderTarget(),ve=b.clearcoat>0,Se=b.iridescence>0;return{isWebGL2:u,shaderID:j,shaderName:b.type,vertexShader:z,fragmentShader:ee,defines:b.defines,customVertexShaderID:oe,customFragmentShaderID:k,isRawShaderMaterial:!0===b.isRawShaderMaterial,glslVersion:b.glslVersion,precision:f,instancing:!0===H.isInstancedMesh,instancingColor:!0===H.isInstancedMesh&&null!==H.instanceColor,supportsVertexTextures:h,outputEncoding:null===he?n.outputEncoding:!0===he.isXRRenderTarget?he.texture.encoding:_o,map:!!b.map,matcap:!!b.matcap,envMap:!!Y,envMapMode:Y&&Y.mapping,envMapCubeUVHeight:ie,lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,objectSpaceNormalMap:b.normalMapType===t5,tangentSpaceNormalMap:b.normalMapType===vo,decodeVideoTexture:!!b.map&&!0===b.map.isVideoTexture&&b.map.encoding===wt,clearcoat:ve,clearcoatMap:ve&&!!b.clearcoatMap,clearcoatRoughnessMap:ve&&!!b.clearcoatRoughnessMap,clearcoatNormalMap:ve&&!!b.clearcoatNormalMap,iridescence:Se,iridescenceMap:Se&&!!b.iridescenceMap,iridescenceThicknessMap:Se&&!!b.iridescenceThicknessMap,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,specularIntensityMap:!!b.specularIntensityMap,specularColorMap:!!b.specularColorMap,opaque:!1===b.transparent&&b.blending===$a,alphaMap:!!b.alphaMap,alphaTest:b.alphaTest>0,gradientMap:!!b.gradientMap,sheen:b.sheen>0,sheenColorMap:!!b.sheenColorMap,sheenRoughnessMap:!!b.sheenRoughnessMap,transmission:b.transmission>0,transmissionMap:!!b.transmissionMap,thicknessMap:!!b.thicknessMap,combine:b.combine,vertexTangents:!!b.normalMap&&!!P.attributes.tangent,vertexColors:b.vertexColors,vertexAlphas:!0===b.vertexColors&&!!P.attributes.color&&4===P.attributes.color.itemSize,vertexUvs:!!(b.map||b.bumpMap||b.normalMap||b.specularMap||b.alphaMap||b.emissiveMap||b.roughnessMap||b.metalnessMap||b.clearcoatMap||b.clearcoatRoughnessMap||b.clearcoatNormalMap||b.iridescenceMap||b.iridescenceThicknessMap||b.displacementMap||b.transmissionMap||b.thicknessMap||b.specularIntensityMap||b.specularColorMap||b.sheenColorMap||b.sheenRoughnessMap),uvsVertexOnly:!(b.map||b.bumpMap||b.normalMap||b.specularMap||b.alphaMap||b.emissiveMap||b.roughnessMap||b.metalnessMap||b.clearcoatNormalMap||b.iridescenceMap||b.iridescenceThicknessMap||b.transmission>0||b.transmissionMap||b.thicknessMap||b.specularIntensityMap||b.specularColorMap||b.sheen>0||b.sheenColorMap||b.sheenRoughnessMap||!b.displacementMap),fog:!!N,useFog:!0===b.fog,fogExp2:N&&N.isFogExp2,flatShading:!!b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===H.isSkinnedMesh,morphTargets:void 0!==P.morphAttributes.position,morphNormals:void 0!==P.morphAttributes.normal,morphColors:void 0!==P.morphAttributes.color,morphTargetsCount:ne,morphTextureStride:_e,numDirLights:S.directional.length,numPointLights:S.point.length,numSpotLights:S.spot.length,numSpotLightMaps:S.spotLightMap.length,numRectAreaLights:S.rectArea.length,numHemiLights:S.hemi.length,numDirLightShadows:S.directionalShadowMap.length,numPointLightShadows:S.pointShadowMap.length,numSpotLightShadows:S.spotShadowMap.length,numSpotLightShadowsWithMaps:S.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:b.dithering,shadowMapEnabled:n.shadowMap.enabled&&R.length>0,shadowMapType:n.shadowMap.type,toneMapping:b.toneMapped?n.toneMapping:ts,useLegacyLights:n.useLegacyLights,premultipliedAlpha:b.premultipliedAlpha,doubleSided:b.side===es,flipSided:b.side===vi,useDepthPacking:!!b.depthPacking,depthPacking:b.depthPacking||0,index0AttributeName:b.index0AttributeName,extensionDerivatives:b.extensions&&b.extensions.derivatives,extensionFragDepth:b.extensions&&b.extensions.fragDepth,extensionDrawBuffers:b.extensions&&b.extensions.drawBuffers,extensionShaderTextureLOD:b.extensions&&b.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:b.customProgramCacheKey()}},getProgramCacheKey:function g(b){const S=[];if(b.shaderID?S.push(b.shaderID):(S.push(b.customVertexShaderID),S.push(b.customFragmentShaderID)),void 0!==b.defines)for(const R in b.defines)S.push(R),S.push(b.defines[R]);return!1===b.isRawShaderMaterial&&(function _(b,S){b.push(S.precision),b.push(S.outputEncoding),b.push(S.envMapMode),b.push(S.envMapCubeUVHeight),b.push(S.combine),b.push(S.vertexUvs),b.push(S.fogExp2),b.push(S.sizeAttenuation),b.push(S.morphTargetsCount),b.push(S.morphAttributeCount),b.push(S.numDirLights),b.push(S.numPointLights),b.push(S.numSpotLights),b.push(S.numSpotLightMaps),b.push(S.numHemiLights),b.push(S.numRectAreaLights),b.push(S.numDirLightShadows),b.push(S.numPointLightShadows),b.push(S.numSpotLightShadows),b.push(S.numSpotLightShadowsWithMaps),b.push(S.shadowMapType),b.push(S.toneMapping),b.push(S.numClippingPlanes),b.push(S.numClipIntersection),b.push(S.depthPacking)}(S,b),function v(b,S){a.disableAll(),S.isWebGL2&&a.enable(0),S.supportsVertexTextures&&a.enable(1),S.instancing&&a.enable(2),S.instancingColor&&a.enable(3),S.map&&a.enable(4),S.matcap&&a.enable(5),S.envMap&&a.enable(6),S.lightMap&&a.enable(7),S.aoMap&&a.enable(8),S.emissiveMap&&a.enable(9),S.bumpMap&&a.enable(10),S.normalMap&&a.enable(11),S.objectSpaceNormalMap&&a.enable(12),S.tangentSpaceNormalMap&&a.enable(13),S.clearcoat&&a.enable(14),S.clearcoatMap&&a.enable(15),S.clearcoatRoughnessMap&&a.enable(16),S.clearcoatNormalMap&&a.enable(17),S.iridescence&&a.enable(18),S.iridescenceMap&&a.enable(19),S.iridescenceThicknessMap&&a.enable(20),S.displacementMap&&a.enable(21),S.specularMap&&a.enable(22),S.roughnessMap&&a.enable(23),S.metalnessMap&&a.enable(24),S.gradientMap&&a.enable(25),S.alphaMap&&a.enable(26),S.alphaTest&&a.enable(27),S.vertexColors&&a.enable(28),S.vertexAlphas&&a.enable(29),S.vertexUvs&&a.enable(30),S.vertexTangents&&a.enable(31),S.uvsVertexOnly&&a.enable(32),b.push(a.mask),a.disableAll(),S.fog&&a.enable(0),S.useFog&&a.enable(1),S.flatShading&&a.enable(2),S.logarithmicDepthBuffer&&a.enable(3),S.skinning&&a.enable(4),S.morphTargets&&a.enable(5),S.morphNormals&&a.enable(6),S.morphColors&&a.enable(7),S.premultipliedAlpha&&a.enable(8),S.shadowMapEnabled&&a.enable(9),S.useLegacyLights&&a.enable(10),S.doubleSided&&a.enable(11),S.flipSided&&a.enable(12),S.useDepthPacking&&a.enable(13),S.dithering&&a.enable(14),S.specularIntensityMap&&a.enable(15),S.specularColorMap&&a.enable(16),S.transmission&&a.enable(17),S.transmissionMap&&a.enable(18),S.thicknessMap&&a.enable(19),S.sheen&&a.enable(20),S.sheenColorMap&&a.enable(21),S.sheenRoughnessMap&&a.enable(22),S.decodeVideoTexture&&a.enable(23),S.opaque&&a.enable(24),b.push(a.mask)}(S,b),S.push(n.outputEncoding)),S.push(b.customProgramCacheKey),S.join()},getUniforms:function y(b){const S=m[b.type];let R;return R=S?k5.clone(Ar[S].uniforms):b.uniforms,R},acquireProgram:function x(b,S){let R;for(let F=0,H=c.length;F<H;F++){const N=c[F];if(N.cacheKey===S){R=N,++R.usedTimes;break}}return void 0===R&&(R=new fj(n,S,b,s),c.push(R)),R},releaseProgram:function w(b){if(0==--b.usedTimes){const S=c.indexOf(b);c[S]=c[c.length-1],c.pop(),b.destroy()}},releaseShaderCache:function M(b){l.remove(b)},programs:c,dispose:function T(){l.dispose()}}}function _j(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function vj(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function a1(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function l1(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,m,p,g){let _=n[e];return void 0===_?(_={id:d.id,object:d,geometry:h,material:f,groupOrder:m,renderOrder:d.renderOrder,z:p,group:g},n[e]=_):(_.id=d.id,_.object=d,_.geometry=h,_.material=f,_.groupOrder=m,_.renderOrder=d.renderOrder,_.z=p,_.group=g),e++,_}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,m,p,g){const _=o(d,h,f,m,p,g);f.transmission>0?i.push(_):!0===f.transparent?r.push(_):t.push(_)},unshift:function l(d,h,f,m,p,g){const _=o(d,h,f,m,p,g);f.transmission>0?i.unshift(_):!0===f.transparent?r.unshift(_):t.unshift(_)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||vj),i.length>1&&i.sort(h||a1),r.length>1&&r.sort(h||a1)}}}function xj(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new l1,n.set(i,[o])):r>=s.length?(o=new l1,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function bj(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new E,color:new de};break;case"SpotLight":t={position:new E,direction:new E,color:new de,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new E,color:new de,distance:0,decay:0};break;case"HemisphereLight":t={direction:new E,skyColor:new de,groundColor:new de};break;case"RectAreaLight":t={color:new de,position:new E,halfWidth:new E,halfHeight:new E}}return n[e.id]=t,t}}}let Mj=0;function Sj(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function Cj(n,e){const t=new bj,i=function wj(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new E);const s=new E,o=new $e,a=new $e;return{setup:function l(u,d){let h=0,f=0,m=0;for(let F=0;F<9;F++)r.probe[F].set(0,0,0);let p=0,g=0,_=0,v=0,y=0,x=0,w=0,M=0,T=0,b=0;u.sort(Sj);const S=!0===d?Math.PI:1;for(let F=0,H=u.length;F<H;F++){const N=u[F],P=N.color,U=N.intensity,Y=N.distance,ie=N.shadow&&N.shadow.map?N.shadow.map.texture:null;if(N.isAmbientLight)h+=P.r*U*S,f+=P.g*U*S,m+=P.b*U*S;else if(N.isLightProbe)for(let j=0;j<9;j++)r.probe[j].addScaledVector(N.sh.coefficients[j],U);else if(N.isDirectionalLight){const j=t.get(N);if(j.color.copy(N.color).multiplyScalar(N.intensity*S),N.castShadow){const J=N.shadow,ne=i.get(N);ne.shadowBias=J.bias,ne.shadowNormalBias=J.normalBias,ne.shadowRadius=J.radius,ne.shadowMapSize=J.mapSize,r.directionalShadow[p]=ne,r.directionalShadowMap[p]=ie,r.directionalShadowMatrix[p]=N.shadow.matrix,x++}r.directional[p]=j,p++}else if(N.isSpotLight){const j=t.get(N);j.position.setFromMatrixPosition(N.matrixWorld),j.color.copy(P).multiplyScalar(U*S),j.distance=Y,j.coneCos=Math.cos(N.angle),j.penumbraCos=Math.cos(N.angle*(1-N.penumbra)),j.decay=N.decay,r.spot[_]=j;const J=N.shadow;if(N.map&&(r.spotLightMap[T]=N.map,T++,J.updateMatrices(N),N.castShadow&&b++),r.spotLightMatrix[_]=J.matrix,N.castShadow){const ne=i.get(N);ne.shadowBias=J.bias,ne.shadowNormalBias=J.normalBias,ne.shadowRadius=J.radius,ne.shadowMapSize=J.mapSize,r.spotShadow[_]=ne,r.spotShadowMap[_]=ie,M++}_++}else if(N.isRectAreaLight){const j=t.get(N);j.color.copy(P).multiplyScalar(U),j.halfWidth.set(.5*N.width,0,0),j.halfHeight.set(0,.5*N.height,0),r.rectArea[v]=j,v++}else if(N.isPointLight){const j=t.get(N);if(j.color.copy(N.color).multiplyScalar(N.intensity*S),j.distance=N.distance,j.decay=N.decay,N.castShadow){const J=N.shadow,ne=i.get(N);ne.shadowBias=J.bias,ne.shadowNormalBias=J.normalBias,ne.shadowRadius=J.radius,ne.shadowMapSize=J.mapSize,ne.shadowCameraNear=J.camera.near,ne.shadowCameraFar=J.camera.far,r.pointShadow[g]=ne,r.pointShadowMap[g]=ie,r.pointShadowMatrix[g]=N.shadow.matrix,w++}r.point[g]=j,g++}else if(N.isHemisphereLight){const j=t.get(N);j.skyColor.copy(N.color).multiplyScalar(U*S),j.groundColor.copy(N.groundColor).multiplyScalar(U*S),r.hemi[y]=j,y++}}v>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ue.LTC_FLOAT_1,r.rectAreaLTC2=ue.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ue.LTC_HALF_1,r.rectAreaLTC2=ue.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=m;const R=r.hash;(R.directionalLength!==p||R.pointLength!==g||R.spotLength!==_||R.rectAreaLength!==v||R.hemiLength!==y||R.numDirectionalShadows!==x||R.numPointShadows!==w||R.numSpotShadows!==M||R.numSpotMaps!==T)&&(r.directional.length=p,r.spot.length=_,r.rectArea.length=v,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=w,r.spotLightMatrix.length=M+T-b,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=b,R.directionalLength=p,R.pointLength=g,R.spotLength=_,R.rectAreaLength=v,R.hemiLength=y,R.numDirectionalShadows=x,R.numPointShadows=w,R.numSpotShadows=M,R.numSpotMaps=T,r.version=Mj++)},setupView:function c(u,d){let h=0,f=0,m=0,p=0,g=0;const _=d.matrixWorldInverse;for(let v=0,y=u.length;v<y;v++){const x=u[v];if(x.isDirectionalLight){const w=r.directional[h];w.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(_),h++}else if(x.isSpotLight){const w=r.spot[m];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(_),w.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(_),m++}else if(x.isRectAreaLight){const w=r.rectArea[p];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(_),a.identity(),o.copy(x.matrixWorld),o.premultiply(_),a.extractRotation(o),w.halfWidth.set(.5*x.width,0,0),w.halfHeight.set(0,.5*x.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),p++}else if(x.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(_),f++}else if(x.isHemisphereLight){const w=r.hemi[g];w.direction.setFromMatrixPosition(x.matrixWorld),w.direction.transformDirection(_),g++}}},state:r}}function c1(n,e){const t=new Cj(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function Ej(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new c1(n,e),t.set(s,[l])):o>=a.length?(l=new c1(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class u1 extends ar{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class d1 extends ar{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new E,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Dj="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",Aj="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function Tj(n,e,t){let i=new Z_;const r=new X,s=new X,o=new Ct,a=new u1({depthPacking:e5}),l=new d1,c={},u=t.maxTextureSize,d={[Qr]:vi,[vi]:Qr,[es]:es},h=new Os({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new X},radius:{value:4}},vertexShader:Dj,fragmentShader:Aj}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const m=new it;m.setAttribute("position",new $t(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new Hn(m,h),g=this;function _(x,w){const M=e.update(p);h.defines.VSM_SAMPLES!==x.blurSamples&&(h.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new wo(r.x,r.y)),h.uniforms.shadow_pass.value=x.map.texture,h.uniforms.resolution.value=x.mapSize,h.uniforms.radius.value=x.radius,n.setRenderTarget(x.mapPass),n.clear(),n.renderBufferDirect(w,null,M,h,p,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,n.setRenderTarget(x.map),n.clear(),n.renderBufferDirect(w,null,M,f,p,null)}function v(x,w,M,T,b,S){let R=null;const F=!0===M.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(void 0!==F)R=F;else if(R=!0===M.isPointLight?l:a,n.localClippingEnabled&&!0===w.clipShadows&&Array.isArray(w.clippingPlanes)&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0||w.map&&w.alphaTest>0){const H=R.uuid,N=w.uuid;let P=c[H];void 0===P&&(P={},c[H]=P);let U=P[N];void 0===U&&(U=R.clone(),P[N]=U),R=U}return R.visible=w.visible,R.wireframe=w.wireframe,R.side=S===Jc?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:d[w.side],R.alphaMap=w.alphaMap,R.alphaTest=w.alphaTest,R.map=w.map,R.clipShadows=w.clipShadows,R.clippingPlanes=w.clippingPlanes,R.clipIntersection=w.clipIntersection,R.displacementMap=w.displacementMap,R.displacementScale=w.displacementScale,R.displacementBias=w.displacementBias,R.wireframeLinewidth=w.wireframeLinewidth,R.linewidth=w.linewidth,!0===M.isPointLight&&!0===R.isMeshDistanceMaterial&&(R.referencePosition.setFromMatrixPosition(M.matrixWorld),R.nearDistance=T,R.farDistance=b),R}function y(x,w,M,T,b){if(!1===x.visible)return;if(x.layers.test(w.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&b===Jc)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,x.matrixWorld);const F=e.update(x),H=x.material;if(Array.isArray(H)){const N=F.groups;for(let P=0,U=N.length;P<U;P++){const Y=N[P],ie=H[Y.materialIndex];if(ie&&ie.visible){const j=v(x,ie,T,M.near,M.far,b);n.renderBufferDirect(M,null,F,j,x,Y)}}}else if(H.visible){const N=v(x,H,T,M.near,M.far,b);n.renderBufferDirect(M,null,F,N,x,null)}}const R=x.children;for(let F=0,H=R.length;F<H;F++)y(R[F],w,M,T,b)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=NA,this.render=function(x,w,M){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===x.length)return;const T=n.getRenderTarget(),b=n.getActiveCubeFace(),S=n.getActiveMipmapLevel(),R=n.state;R.setBlending(Ts),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let F=0,H=x.length;F<H;F++){const N=x[F],P=N.shadow;if(void 0===P){console.warn("THREE.WebGLShadowMap:",N,"has no shadow.");continue}if(!1===P.autoUpdate&&!1===P.needsUpdate)continue;r.copy(P.mapSize);const U=P.getFrameExtents();r.multiply(U),s.copy(P.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/U.x),r.x=s.x*U.x,P.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/U.y),r.y=s.y*U.y,P.mapSize.y=s.y)),null===P.map&&(P.map=new wo(r.x,r.y,this.type!==Jc?{minFilter:Jt,magFilter:Jt}:{}),P.map.texture.name=N.name+".shadowMap",P.camera.updateProjectionMatrix()),n.setRenderTarget(P.map),n.clear();const Y=P.getViewportCount();for(let ie=0;ie<Y;ie++){const j=P.getViewport(ie);o.set(s.x*j.x,s.y*j.y,s.x*j.z,s.y*j.w),R.viewport(o),P.updateMatrices(N,ie),i=P.getFrustum(),y(w,M,P.camera,N,this.type)}!0!==P.isPointLightShadow&&this.type===Jc&&_(P,M),P.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(T,b,S)}}function Ij(n,e,t){const i=t.isWebGL2,a=new function r(){let L=!1;const $=new Ct;let se=null;const Me=new Ct(0,0,0,0);return{setMask:function(De){se!==De&&!L&&(n.colorMask(De,De,De,De),se=De)},setLocked:function(De){L=De},setClear:function(De,Ot,Mn,Qn,Pr){!0===Pr&&(De*=Qn,Ot*=Qn,Mn*=Qn),$.set(De,Ot,Mn,Qn),!1===Me.equals($)&&(n.clearColor(De,Ot,Mn,Qn),Me.copy($))},reset:function(){L=!1,se=null,Me.set(-1,0,0,0)}}},l=new function s(){let L=!1,$=null,se=null,Me=null;return{setTest:function(De){De?me(2929):ve(2929)},setMask:function(De){$!==De&&!L&&(n.depthMask(De),$=De)},setFunc:function(De){if(se!==De){switch(De){case x4:n.depthFunc(512);break;case b4:n.depthFunc(519);break;case w4:n.depthFunc(513);break;case f_:n.depthFunc(515);break;case M4:n.depthFunc(514);break;case S4:n.depthFunc(518);break;case C4:n.depthFunc(516);break;case E4:n.depthFunc(517);break;default:n.depthFunc(515)}se=De}},setLocked:function(De){L=De},setClear:function(De){Me!==De&&(n.clearDepth(De),Me=De)},reset:function(){L=!1,$=null,se=null,Me=null}}},c=new function o(){let L=!1,$=null,se=null,Me=null,De=null,Ot=null,Mn=null,Qn=null,Pr=null;return{setTest:function(tn){L||(tn?me(2960):ve(2960))},setMask:function(tn){$!==tn&&!L&&(n.stencilMask(tn),$=tn)},setFunc:function(tn,Hi,Lr){(se!==tn||Me!==Hi||De!==Lr)&&(n.stencilFunc(tn,Hi,Lr),se=tn,Me=Hi,De=Lr)},setOp:function(tn,Hi,Lr){(Ot!==tn||Mn!==Hi||Qn!==Lr)&&(n.stencilOp(tn,Hi,Lr),Ot=tn,Mn=Hi,Qn=Lr)},setLocked:function(tn){L=tn},setClear:function(tn){Pr!==tn&&(n.clearStencil(tn),Pr=tn)},reset:function(){L=!1,$=null,se=null,Me=null,De=null,Ot=null,Mn=null,Qn=null,Pr=null}}},u=new WeakMap,d=new WeakMap;let h={},f={},m=new WeakMap,p=[],g=null,_=!1,v=null,y=null,x=null,w=null,M=null,T=null,b=null,S=!1,R=null,F=null,H=null,N=null,P=null;const U=n.getParameter(35661);let Y=!1,ie=0;const j=n.getParameter(7938);-1!==j.indexOf("WebGL")?(ie=parseFloat(/^WebGL (\d)/.exec(j)[1]),Y=ie>=1):-1!==j.indexOf("OpenGL ES")&&(ie=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),Y=ie>=2);let J=null,ne={};const _e=n.getParameter(3088),z=n.getParameter(2978),ee=(new Ct).fromArray(_e),oe=(new Ct).fromArray(z);function k(L,$,se){const Me=new Uint8Array(4),De=n.createTexture();n.bindTexture(L,De),n.texParameteri(L,10241,9728),n.texParameteri(L,10240,9728);for(let Ot=0;Ot<se;Ot++)n.texImage2D($+Ot,0,6408,1,1,0,6408,5121,Me);return De}const he={};function me(L){!0!==h[L]&&(n.enable(L),h[L]=!0)}function ve(L){!1!==h[L]&&(n.disable(L),h[L]=!1)}he[3553]=k(3553,3553,1),he[34067]=k(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),me(2929),l.setFunc(f_),fe(!1),Ge(LA),me(2884),ce(Ts);const Z={[qa]:32774,[c4]:32778,[u4]:32779};if(i)Z[VA]=32775,Z[BA]=32776;else{const L=e.get("EXT_blend_minmax");null!==L&&(Z[VA]=L.MIN_EXT,Z[BA]=L.MAX_EXT)}const te={[d4]:0,[h4]:1,[f4]:768,[UA]:770,[v4]:776,[y4]:774,[m4]:772,[p4]:769,[zA]:771,[_4]:775,[g4]:773};function ce(L,$,se,Me,De,Ot,Mn,Qn){if(L!==Ts){if(!1===_&&(me(3042),_=!0),L===l4)De=De||$,Ot=Ot||se,Mn=Mn||Me,($!==y||De!==M)&&(n.blendEquationSeparate(Z[$],Z[De]),y=$,M=De),(se!==x||Me!==w||Ot!==T||Mn!==b)&&(n.blendFuncSeparate(te[se],te[Me],te[Ot],te[Mn]),x=se,w=Me,T=Ot,b=Mn),v=L,S=!1;else if(L!==v||Qn!==S){if((y!==qa||M!==qa)&&(n.blendEquation(32774),y=qa,M=qa),Qn)switch(L){case $a:n.blendFuncSeparate(1,771,1,771);break;case FA:n.blendFunc(1,1);break;case OA:n.blendFuncSeparate(0,769,0,1);break;case kA:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",L)}else switch(L){case $a:n.blendFuncSeparate(770,771,1,771);break;case FA:n.blendFunc(770,1);break;case OA:n.blendFuncSeparate(0,769,0,1);break;case kA:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",L)}x=null,w=null,T=null,b=null,v=L,S=Qn}}else!0===_&&(ve(3042),_=!1)}function fe(L){R!==L&&(n.frontFace(L?2304:2305),R=L)}function Ge(L){L!==s4?(me(2884),L!==F&&n.cullFace(L===LA?1029:L===o4?1028:1032)):ve(2884),F=L}function We(L,$,se){L?(me(32823),(N!==$||P!==se)&&(n.polygonOffset($,se),N=$,P=se)):ve(32823)}return{buffers:{color:a,depth:l,stencil:c},enable:me,disable:ve,bindFramebuffer:function Se(L,$){return f[L]!==$&&(n.bindFramebuffer(L,$),f[L]=$,i&&(36009===L&&(f[36160]=$),36160===L&&(f[36009]=$)),!0)},drawBuffers:function we(L,$){let se=p,Me=!1;if(L)if(se=m.get($),void 0===se&&(se=[],m.set($,se)),L.isWebGLMultipleRenderTargets){const De=L.texture;if(se.length!==De.length||36064!==se[0]){for(let Ot=0,Mn=De.length;Ot<Mn;Ot++)se[Ot]=36064+Ot;se.length=De.length,Me=!0}}else 36064!==se[0]&&(se[0]=36064,Me=!0);else 1029!==se[0]&&(se[0]=1029,Me=!0);Me&&(t.isWebGL2?n.drawBuffers(se):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(se))},useProgram:function Le(L){return g!==L&&(n.useProgram(L),g=L,!0)},setBlending:ce,setMaterial:function Ee(L,$){L.side===es?ve(2884):me(2884);let se=L.side===vi;$&&(se=!se),fe(se),L.blending===$a&&!1===L.transparent?ce(Ts):ce(L.blending,L.blendEquation,L.blendSrc,L.blendDst,L.blendEquationAlpha,L.blendSrcAlpha,L.blendDstAlpha,L.premultipliedAlpha),l.setFunc(L.depthFunc),l.setTest(L.depthTest),l.setMask(L.depthWrite),a.setMask(L.colorWrite);const Me=L.stencilWrite;c.setTest(Me),Me&&(c.setMask(L.stencilWriteMask),c.setFunc(L.stencilFunc,L.stencilRef,L.stencilFuncMask),c.setOp(L.stencilFail,L.stencilZFail,L.stencilZPass)),We(L.polygonOffset,L.polygonOffsetFactor,L.polygonOffsetUnits),!0===L.alphaToCoverage?me(32926):ve(32926)},setFlipSided:fe,setCullFace:Ge,setLineWidth:function Ne(L){L!==H&&(Y&&n.lineWidth(L),H=L)},setPolygonOffset:We,setScissorTest:function St(L){L?me(3089):ve(3089)},activeTexture:function mt(L){void 0===L&&(L=33984+U-1),J!==L&&(n.activeTexture(L),J=L)},bindTexture:function A(L,$,se){void 0===se&&(se=null===J?33984+U-1:J);let Me=ne[se];void 0===Me&&(Me={type:void 0,texture:void 0},ne[se]=Me),(Me.type!==L||Me.texture!==$)&&(J!==se&&(n.activeTexture(se),J=se),n.bindTexture(L,$||he[L]),Me.type=L,Me.texture=$)},unbindTexture:function C(){const L=ne[J];void 0!==L&&void 0!==L.type&&(n.bindTexture(L.type,null),L.type=void 0,L.texture=void 0)},compressedTexImage2D:function G(){try{n.compressedTexImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexImage3D:function ae(){try{n.compressedTexImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texImage2D:function pe(){try{n.texImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texImage3D:function Ae(){try{n.texImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},updateUBOMapping:function ct(L,$){let se=d.get($);void 0===se&&(se=new WeakMap,d.set($,se));let Me=se.get(L);void 0===Me&&(Me=n.getUniformBlockIndex($,L.name),se.set(L,Me))},uniformBlockBinding:function gt(L,$){const Me=d.get($).get(L);u.get($)!==Me&&(n.uniformBlockBinding($,Me,L.__bindingPointIndex),u.set($,Me))},texStorage2D:function O(){try{n.texStorage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texStorage3D:function xe(){try{n.texStorage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texSubImage2D:function le(){try{n.texSubImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texSubImage3D:function ge(){try{n.texSubImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexSubImage2D:function Te(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexSubImage3D:function I(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},scissor:function Re(L){!1===ee.equals(L)&&(n.scissor(L.x,L.y,L.z,L.w),ee.copy(L))},viewport:function Ie(L){!1===oe.equals(L)&&(n.viewport(L.x,L.y,L.z,L.w),oe.copy(L))},reset:function Et(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},J=null,ne={},f={},m=new WeakMap,p=[],g=null,_=!1,v=null,y=null,x=null,w=null,M=null,T=null,b=null,S=!1,R=null,F=null,H=null,N=null,P=null,ee.set(0,0,n.canvas.width,n.canvas.height),oe.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function Rj(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let p;const g=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(A,C){return _?new OffscreenCanvas(A,C):au("canvas")}function y(A,C,G,ae){let le=1;if((A.width>ae||A.height>ae)&&(le=ae/Math.max(A.width,A.height)),le<1||!0===C){if(typeof HTMLImageElement<"u"&&A instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&A instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&A instanceof ImageBitmap){const ge=C?_T:Math.floor,Te=ge(le*A.width),I=ge(le*A.height);void 0===p&&(p=v(Te,I));const O=G?v(Te,I):p;return O.width=Te,O.height=I,O.getContext("2d").drawImage(A,0,0,Te,I),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+A.width+"x"+A.height+") to ("+Te+"x"+I+")."),O}return"data"in A&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+A.width+"x"+A.height+")."),A}return A}function x(A){return D_(A.width)&&D_(A.height)}function M(A,C){return A.generateMipmaps&&C&&A.minFilter!==Jt&&A.minFilter!==jt}function T(A){n.generateMipmap(A)}function b(A,C,G,ae,le=!1){if(!1===a)return C;if(null!==A){if(void 0!==n[A])return n[A];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+A+"'")}let ge=C;return 6403===C&&(5126===G&&(ge=33326),5131===G&&(ge=33325),5121===G&&(ge=33321)),33319===C&&(5126===G&&(ge=33328),5131===G&&(ge=33327),5121===G&&(ge=33323)),6408===C&&(5126===G&&(ge=34836),5131===G&&(ge=34842),5121===G&&(ge=ae===wt&&!1===le?35907:32856),32819===G&&(ge=32854),32820===G&&(ge=32855)),(33325===ge||33326===ge||33327===ge||33328===ge||34842===ge||34836===ge)&&e.get("EXT_color_buffer_float"),ge}function S(A,C,G){return!0===M(A,G)||A.isFramebufferTexture&&A.minFilter!==Jt&&A.minFilter!==jt?Math.log2(Math.max(C.width,C.height))+1:void 0!==A.mipmaps&&A.mipmaps.length>0?A.mipmaps.length:A.isCompressedTexture&&Array.isArray(A.image)?C.mipmaps.length:1}function R(A){return A===Jt||A===nf||A===tu?9728:9729}function F(A){const C=A.target;C.removeEventListener("dispose",F),function N(A){const C=i.get(A);if(void 0===C.__webglInit)return;const G=A.source,ae=g.get(G);if(ae){const le=ae[C.__cacheKey];le.usedTimes--,0===le.usedTimes&&P(A),0===Object.keys(ae).length&&g.delete(G)}i.remove(A)}(C),C.isVideoTexture&&m.delete(C)}function H(A){const C=A.target;C.removeEventListener("dispose",H),function U(A){const C=A.texture,G=i.get(A),ae=i.get(C);if(void 0!==ae.__webglTexture&&(n.deleteTexture(ae.__webglTexture),o.memory.textures--),A.depthTexture&&A.depthTexture.dispose(),A.isWebGLCubeRenderTarget)for(let le=0;le<6;le++)n.deleteFramebuffer(G.__webglFramebuffer[le]),G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer[le]);else{if(n.deleteFramebuffer(G.__webglFramebuffer),G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&n.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer)for(let le=0;le<G.__webglColorRenderbuffer.length;le++)G.__webglColorRenderbuffer[le]&&n.deleteRenderbuffer(G.__webglColorRenderbuffer[le]);G.__webglDepthRenderbuffer&&n.deleteRenderbuffer(G.__webglDepthRenderbuffer)}if(A.isWebGLMultipleRenderTargets)for(let le=0,ge=C.length;le<ge;le++){const Te=i.get(C[le]);Te.__webglTexture&&(n.deleteTexture(Te.__webglTexture),o.memory.textures--),i.remove(C[le])}i.remove(C),i.remove(A)}(C)}function P(A){const C=i.get(A);n.deleteTexture(C.__webglTexture),delete g.get(A.source)[C.__cacheKey],o.memory.textures--}let Y=0;function ne(A,C){const G=i.get(A);if(A.isVideoTexture&&function St(A){const C=o.render.frame;m.get(A)!==C&&(m.set(A,C),A.update())}(A),!1===A.isRenderTargetTexture&&A.version>0&&G.__version!==A.version){const ae=A.image;if(null===ae)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ae.complete)return void ve(G,A,C);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,G.__webglTexture,33984+C)}const oe={[po]:10497,[Vn]:33071,[eu]:33648},k={[Jt]:9728,[nf]:9984,[tu]:9986,[jt]:9729,[m_]:9985,[ns]:9987};function he(A,C,G){if(G?(n.texParameteri(A,10242,oe[C.wrapS]),n.texParameteri(A,10243,oe[C.wrapT]),(32879===A||35866===A)&&n.texParameteri(A,32882,oe[C.wrapR]),n.texParameteri(A,10240,k[C.magFilter]),n.texParameteri(A,10241,k[C.minFilter])):(n.texParameteri(A,10242,33071),n.texParameteri(A,10243,33071),(32879===A||35866===A)&&n.texParameteri(A,32882,33071),(C.wrapS!==Vn||C.wrapT!==Vn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(A,10240,R(C.magFilter)),n.texParameteri(A,10241,R(C.minFilter)),C.minFilter!==Jt&&C.minFilter!==jt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const ae=e.get("EXT_texture_filter_anisotropic");if(C.magFilter===Jt||C.minFilter!==tu&&C.minFilter!==ns||C.type===Is&&!1===e.has("OES_texture_float_linear")||!1===a&&C.type===nu&&!1===e.has("OES_texture_half_float_linear"))return;(C.anisotropy>1||i.get(C).__currentAnisotropy)&&(n.texParameterf(A,ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(C.anisotropy,r.getMaxAnisotropy())),i.get(C).__currentAnisotropy=C.anisotropy)}}function me(A,C){let G=!1;void 0===A.__webglInit&&(A.__webglInit=!0,C.addEventListener("dispose",F));const ae=C.source;let le=g.get(ae);void 0===le&&(le={},g.set(ae,le));const ge=function J(A){const C=[];return C.push(A.wrapS),C.push(A.wrapT),C.push(A.wrapR||0),C.push(A.magFilter),C.push(A.minFilter),C.push(A.anisotropy),C.push(A.internalFormat),C.push(A.format),C.push(A.type),C.push(A.generateMipmaps),C.push(A.premultiplyAlpha),C.push(A.flipY),C.push(A.unpackAlignment),C.push(A.encoding),C.join()}(C);if(ge!==A.__cacheKey){void 0===le[ge]&&(le[ge]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,G=!0),le[ge].usedTimes++;const Te=le[A.__cacheKey];void 0!==Te&&(le[A.__cacheKey].usedTimes--,0===Te.usedTimes&&P(C)),A.__cacheKey=ge,A.__webglTexture=le[ge].texture}return G}function ve(A,C,G){let ae=3553;(C.isDataArrayTexture||C.isCompressedArrayTexture)&&(ae=35866),C.isData3DTexture&&(ae=32879);const le=me(A,C),ge=C.source;t.bindTexture(ae,A.__webglTexture,33984+G);const Te=i.get(ge);if(ge.version!==Te.__version||!0===le){t.activeTexture(33984+G),n.pixelStorei(37440,C.flipY),n.pixelStorei(37441,C.premultiplyAlpha),n.pixelStorei(3317,C.unpackAlignment),n.pixelStorei(37443,0);const I=function w(A){return!a&&(A.wrapS!==Vn||A.wrapT!==Vn||A.minFilter!==Jt&&A.minFilter!==jt)}(C)&&!1===x(C.image);let O=y(C.image,I,!1,u);O=mt(C,O);const xe=x(O)||a,pe=s.convert(C.format,C.encoding);let Ie,Ae=s.convert(C.type),Re=b(C.internalFormat,pe,Ae,C.encoding,C.isVideoTexture);he(ae,C,xe);const ct=C.mipmaps,gt=a&&!0!==C.isVideoTexture,Et=void 0===Te.__version||!0===le,L=S(C,O,xe);if(C.isDepthTexture)Re=6402,a?Re=C.type===Is?36012:C.type===go?33190:C.type===Xa?35056:33189:C.type===Is&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),C.format===yo&&6402===Re&&C.type!==HA&&C.type!==go&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),C.type=go,Ae=s.convert(C.type)),C.format===Ya&&6402===Re&&(Re=34041,C.type!==Xa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),C.type=Xa,Ae=s.convert(C.type))),Et&&(gt?t.texStorage2D(3553,1,Re,O.width,O.height):t.texImage2D(3553,0,Re,O.width,O.height,0,pe,Ae,null));else if(C.isDataTexture)if(ct.length>0&&xe){gt&&Et&&t.texStorage2D(3553,L,Re,ct[0].width,ct[0].height);for(let $=0,se=ct.length;$<se;$++)Ie=ct[$],gt?t.texSubImage2D(3553,$,0,0,Ie.width,Ie.height,pe,Ae,Ie.data):t.texImage2D(3553,$,Re,Ie.width,Ie.height,0,pe,Ae,Ie.data);C.generateMipmaps=!1}else gt?(Et&&t.texStorage2D(3553,L,Re,O.width,O.height),t.texSubImage2D(3553,0,0,0,O.width,O.height,pe,Ae,O.data)):t.texImage2D(3553,0,Re,O.width,O.height,0,pe,Ae,O.data);else if(C.isCompressedTexture)if(C.isCompressedArrayTexture){gt&&Et&&t.texStorage3D(35866,L,Re,ct[0].width,ct[0].height,O.depth);for(let $=0,se=ct.length;$<se;$++)Ie=ct[$],C.format!==ki?null!==pe?gt?t.compressedTexSubImage3D(35866,$,0,0,0,Ie.width,Ie.height,O.depth,pe,Ie.data,0,0):t.compressedTexImage3D(35866,$,Re,Ie.width,Ie.height,O.depth,0,Ie.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):gt?t.texSubImage3D(35866,$,0,0,0,Ie.width,Ie.height,O.depth,pe,Ae,Ie.data):t.texImage3D(35866,$,Re,Ie.width,Ie.height,O.depth,0,pe,Ae,Ie.data)}else{gt&&Et&&t.texStorage2D(3553,L,Re,ct[0].width,ct[0].height);for(let $=0,se=ct.length;$<se;$++)Ie=ct[$],C.format!==ki?null!==pe?gt?t.compressedTexSubImage2D(3553,$,0,0,Ie.width,Ie.height,pe,Ie.data):t.compressedTexImage2D(3553,$,Re,Ie.width,Ie.height,0,Ie.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):gt?t.texSubImage2D(3553,$,0,0,Ie.width,Ie.height,pe,Ae,Ie.data):t.texImage2D(3553,$,Re,Ie.width,Ie.height,0,pe,Ae,Ie.data)}else if(C.isDataArrayTexture)gt?(Et&&t.texStorage3D(35866,L,Re,O.width,O.height,O.depth),t.texSubImage3D(35866,0,0,0,0,O.width,O.height,O.depth,pe,Ae,O.data)):t.texImage3D(35866,0,Re,O.width,O.height,O.depth,0,pe,Ae,O.data);else if(C.isData3DTexture)gt?(Et&&t.texStorage3D(32879,L,Re,O.width,O.height,O.depth),t.texSubImage3D(32879,0,0,0,0,O.width,O.height,O.depth,pe,Ae,O.data)):t.texImage3D(32879,0,Re,O.width,O.height,O.depth,0,pe,Ae,O.data);else if(C.isFramebufferTexture){if(Et)if(gt)t.texStorage2D(3553,L,Re,O.width,O.height);else{let $=O.width,se=O.height;for(let Me=0;Me<L;Me++)t.texImage2D(3553,Me,Re,$,se,0,pe,Ae,null),$>>=1,se>>=1}}else if(ct.length>0&&xe){gt&&Et&&t.texStorage2D(3553,L,Re,ct[0].width,ct[0].height);for(let $=0,se=ct.length;$<se;$++)Ie=ct[$],gt?t.texSubImage2D(3553,$,0,0,pe,Ae,Ie):t.texImage2D(3553,$,Re,pe,Ae,Ie);C.generateMipmaps=!1}else gt?(Et&&t.texStorage2D(3553,L,Re,O.width,O.height),t.texSubImage2D(3553,0,0,0,pe,Ae,O)):t.texImage2D(3553,0,Re,pe,Ae,O);M(C,xe)&&T(ae),Te.__version=ge.version,C.onUpdate&&C.onUpdate(C)}A.__version=C.version}function we(A,C,G,ae,le){const ge=s.convert(G.format,G.encoding),Te=s.convert(G.type),I=b(G.internalFormat,ge,Te,G.encoding);i.get(C).__hasExternalTextures||(32879===le||35866===le?t.texImage3D(le,0,I,C.width,C.height,C.depth,0,ge,Te,null):t.texImage2D(le,0,I,C.width,C.height,0,ge,Te,null)),t.bindFramebuffer(36160,A),We(C)?h.framebufferTexture2DMultisampleEXT(36160,ae,le,i.get(G).__webglTexture,0,Ne(C)):(3553===le||le>=34069&&le<=34074)&&n.framebufferTexture2D(36160,ae,le,i.get(G).__webglTexture,0),t.bindFramebuffer(36160,null)}function Le(A,C,G){if(n.bindRenderbuffer(36161,A),C.depthBuffer&&!C.stencilBuffer){let ae=33189;if(G||We(C)){const le=C.depthTexture;le&&le.isDepthTexture&&(le.type===Is?ae=36012:le.type===go&&(ae=33190));const ge=Ne(C);We(C)?h.renderbufferStorageMultisampleEXT(36161,ge,ae,C.width,C.height):n.renderbufferStorageMultisample(36161,ge,ae,C.width,C.height)}else n.renderbufferStorage(36161,ae,C.width,C.height);n.framebufferRenderbuffer(36160,36096,36161,A)}else if(C.depthBuffer&&C.stencilBuffer){const ae=Ne(C);G&&!1===We(C)?n.renderbufferStorageMultisample(36161,ae,35056,C.width,C.height):We(C)?h.renderbufferStorageMultisampleEXT(36161,ae,35056,C.width,C.height):n.renderbufferStorage(36161,34041,C.width,C.height),n.framebufferRenderbuffer(36160,33306,36161,A)}else{const ae=!0===C.isWebGLMultipleRenderTargets?C.texture:[C.texture];for(let le=0;le<ae.length;le++){const ge=ae[le],Te=s.convert(ge.format,ge.encoding),I=s.convert(ge.type),O=b(ge.internalFormat,Te,I,ge.encoding),xe=Ne(C);G&&!1===We(C)?n.renderbufferStorageMultisample(36161,xe,O,C.width,C.height):We(C)?h.renderbufferStorageMultisampleEXT(36161,xe,O,C.width,C.height):n.renderbufferStorage(36161,O,C.width,C.height)}}n.bindRenderbuffer(36161,null)}function te(A){const C=i.get(A),G=!0===A.isWebGLCubeRenderTarget;if(A.depthTexture&&!C.__autoAllocateDepthBuffer){if(G)throw new Error("target.depthTexture not supported in Cube render targets");!function Z(A,C){if(C&&C.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,A),!C.depthTexture||!C.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(C.depthTexture).__webglTexture||C.depthTexture.image.width!==C.width||C.depthTexture.image.height!==C.height)&&(C.depthTexture.image.width=C.width,C.depthTexture.image.height=C.height,C.depthTexture.needsUpdate=!0),ne(C.depthTexture,0);const ae=i.get(C.depthTexture).__webglTexture,le=Ne(C);if(C.depthTexture.format===yo)We(C)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,ae,0,le):n.framebufferTexture2D(36160,36096,3553,ae,0);else{if(C.depthTexture.format!==Ya)throw new Error("Unknown depthTexture format");We(C)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,ae,0,le):n.framebufferTexture2D(36160,33306,3553,ae,0)}}(C.__webglFramebuffer,A)}else if(G){C.__webglDepthbuffer=[];for(let ae=0;ae<6;ae++)t.bindFramebuffer(36160,C.__webglFramebuffer[ae]),C.__webglDepthbuffer[ae]=n.createRenderbuffer(),Le(C.__webglDepthbuffer[ae],A,!1)}else t.bindFramebuffer(36160,C.__webglFramebuffer),C.__webglDepthbuffer=n.createRenderbuffer(),Le(C.__webglDepthbuffer,A,!1);t.bindFramebuffer(36160,null)}function Ne(A){return Math.min(d,A.samples)}function We(A){const C=i.get(A);return a&&A.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==C.__useRenderToTexture}function mt(A,C){const G=A.encoding,ae=A.format,le=A.type;return!0===A.isCompressedTexture||!0===A.isVideoTexture||A.format===C_||G!==_o&&(G===wt?!1===a?!0===e.has("EXT_sRGB")&&ae===ki?(A.format=C_,A.minFilter=jt,A.generateMipmaps=!1):C=bT.sRGBToLinear(C):(ae!==ki||le!==mo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",G)),C}this.allocateTextureUnit=function j(){const A=Y;return A>=l&&console.warn("THREE.WebGLTextures: Trying to use "+A+" texture units while this GPU supports only "+l),Y+=1,A},this.resetTextureUnits=function ie(){Y=0},this.setTexture2D=ne,this.setTexture2DArray=function _e(A,C){const G=i.get(A);A.version>0&&G.__version!==A.version?ve(G,A,C):t.bindTexture(35866,G.__webglTexture,33984+C)},this.setTexture3D=function z(A,C){const G=i.get(A);A.version>0&&G.__version!==A.version?ve(G,A,C):t.bindTexture(32879,G.__webglTexture,33984+C)},this.setTextureCube=function ee(A,C){const G=i.get(A);A.version>0&&G.__version!==A.version?function Se(A,C,G){if(6!==C.image.length)return;const ae=me(A,C),le=C.source;t.bindTexture(34067,A.__webglTexture,33984+G);const ge=i.get(le);if(le.version!==ge.__version||!0===ae){t.activeTexture(33984+G),n.pixelStorei(37440,C.flipY),n.pixelStorei(37441,C.premultiplyAlpha),n.pixelStorei(3317,C.unpackAlignment),n.pixelStorei(37443,0);const Te=C.isCompressedTexture||C.image[0].isCompressedTexture,I=C.image[0]&&C.image[0].isDataTexture,O=[];for(let $=0;$<6;$++)O[$]=Te||I?I?C.image[$].image:C.image[$]:y(C.image[$],!1,!0,c),O[$]=mt(C,O[$]);const xe=O[0],pe=x(xe)||a,Ae=s.convert(C.format,C.encoding),Re=s.convert(C.type),Ie=b(C.internalFormat,Ae,Re,C.encoding),ct=a&&!0!==C.isVideoTexture,gt=void 0===ge.__version||!0===ae;let L,Et=S(C,xe,pe);if(he(34067,C,pe),Te){ct&&gt&&t.texStorage2D(34067,Et,Ie,xe.width,xe.height);for(let $=0;$<6;$++){L=O[$].mipmaps;for(let se=0;se<L.length;se++){const Me=L[se];C.format!==ki?null!==Ae?ct?t.compressedTexSubImage2D(34069+$,se,0,0,Me.width,Me.height,Ae,Me.data):t.compressedTexImage2D(34069+$,se,Ie,Me.width,Me.height,0,Me.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ct?t.texSubImage2D(34069+$,se,0,0,Me.width,Me.height,Ae,Re,Me.data):t.texImage2D(34069+$,se,Ie,Me.width,Me.height,0,Ae,Re,Me.data)}}}else{L=C.mipmaps,ct&&gt&&(L.length>0&&Et++,t.texStorage2D(34067,Et,Ie,O[0].width,O[0].height));for(let $=0;$<6;$++)if(I){ct?t.texSubImage2D(34069+$,0,0,0,O[$].width,O[$].height,Ae,Re,O[$].data):t.texImage2D(34069+$,0,Ie,O[$].width,O[$].height,0,Ae,Re,O[$].data);for(let se=0;se<L.length;se++){const De=L[se].image[$].image;ct?t.texSubImage2D(34069+$,se+1,0,0,De.width,De.height,Ae,Re,De.data):t.texImage2D(34069+$,se+1,Ie,De.width,De.height,0,Ae,Re,De.data)}}else{ct?t.texSubImage2D(34069+$,0,0,0,Ae,Re,O[$]):t.texImage2D(34069+$,0,Ie,Ae,Re,O[$]);for(let se=0;se<L.length;se++){const Me=L[se];ct?t.texSubImage2D(34069+$,se+1,0,0,Ae,Re,Me.image[$]):t.texImage2D(34069+$,se+1,Ie,Ae,Re,Me.image[$])}}}M(C,pe)&&T(34067),ge.__version=le.version,C.onUpdate&&C.onUpdate(C)}A.__version=C.version}(G,A,C):t.bindTexture(34067,G.__webglTexture,33984+C)},this.rebindTextures=function ce(A,C,G){const ae=i.get(A);void 0!==C&&we(ae.__webglFramebuffer,A,A.texture,36064,3553),void 0!==G&&te(A)},this.setupRenderTarget=function Ee(A){const C=A.texture,G=i.get(A),ae=i.get(C);A.addEventListener("dispose",H),!0!==A.isWebGLMultipleRenderTargets&&(void 0===ae.__webglTexture&&(ae.__webglTexture=n.createTexture()),ae.__version=C.version,o.memory.textures++);const le=!0===A.isWebGLCubeRenderTarget,ge=!0===A.isWebGLMultipleRenderTargets,Te=x(A)||a;if(le){G.__webglFramebuffer=[];for(let I=0;I<6;I++)G.__webglFramebuffer[I]=n.createFramebuffer()}else{if(G.__webglFramebuffer=n.createFramebuffer(),ge)if(r.drawBuffers){const I=A.texture;for(let O=0,xe=I.length;O<xe;O++){const pe=i.get(I[O]);void 0===pe.__webglTexture&&(pe.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&A.samples>0&&!1===We(A)){const I=ge?C:[C];G.__webglMultisampledFramebuffer=n.createFramebuffer(),G.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,G.__webglMultisampledFramebuffer);for(let O=0;O<I.length;O++){const xe=I[O];G.__webglColorRenderbuffer[O]=n.createRenderbuffer(),n.bindRenderbuffer(36161,G.__webglColorRenderbuffer[O]);const pe=s.convert(xe.format,xe.encoding),Ae=s.convert(xe.type),Re=b(xe.internalFormat,pe,Ae,xe.encoding,!0===A.isXRRenderTarget),Ie=Ne(A);n.renderbufferStorageMultisample(36161,Ie,Re,A.width,A.height),n.framebufferRenderbuffer(36160,36064+O,36161,G.__webglColorRenderbuffer[O])}n.bindRenderbuffer(36161,null),A.depthBuffer&&(G.__webglDepthRenderbuffer=n.createRenderbuffer(),Le(G.__webglDepthRenderbuffer,A,!0)),t.bindFramebuffer(36160,null)}}if(le){t.bindTexture(34067,ae.__webglTexture),he(34067,C,Te);for(let I=0;I<6;I++)we(G.__webglFramebuffer[I],A,C,36064,34069+I);M(C,Te)&&T(34067),t.unbindTexture()}else if(ge){const I=A.texture;for(let O=0,xe=I.length;O<xe;O++){const pe=I[O],Ae=i.get(pe);t.bindTexture(3553,Ae.__webglTexture),he(3553,pe,Te),we(G.__webglFramebuffer,A,pe,36064+O,3553),M(pe,Te)&&T(3553)}t.unbindTexture()}else{let I=3553;(A.isWebGL3DRenderTarget||A.isWebGLArrayRenderTarget)&&(a?I=A.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(I,ae.__webglTexture),he(I,C,Te),we(G.__webglFramebuffer,A,C,36064,I),M(C,Te)&&T(I),t.unbindTexture()}A.depthBuffer&&te(A)},this.updateRenderTargetMipmap=function fe(A){const C=x(A)||a,G=!0===A.isWebGLMultipleRenderTargets?A.texture:[A.texture];for(let ae=0,le=G.length;ae<le;ae++){const ge=G[ae];if(M(ge,C)){const Te=A.isWebGLCubeRenderTarget?34067:3553,I=i.get(ge).__webglTexture;t.bindTexture(Te,I),T(Te),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ge(A){if(a&&A.samples>0&&!1===We(A)){const C=A.isWebGLMultipleRenderTargets?A.texture:[A.texture],G=A.width,ae=A.height;let le=16384;const ge=[],Te=A.stencilBuffer?33306:36096,I=i.get(A),O=!0===A.isWebGLMultipleRenderTargets;if(O)for(let xe=0;xe<C.length;xe++)t.bindFramebuffer(36160,I.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+xe,36161,null),t.bindFramebuffer(36160,I.__webglFramebuffer),n.framebufferTexture2D(36009,36064+xe,3553,null,0);t.bindFramebuffer(36008,I.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,I.__webglFramebuffer);for(let xe=0;xe<C.length;xe++){ge.push(36064+xe),A.depthBuffer&&ge.push(Te);const pe=void 0!==I.__ignoreDepthValues&&I.__ignoreDepthValues;if(!1===pe&&(A.depthBuffer&&(le|=256),A.stencilBuffer&&(le|=1024)),O&&n.framebufferRenderbuffer(36008,36064,36161,I.__webglColorRenderbuffer[xe]),!0===pe&&(n.invalidateFramebuffer(36008,[Te]),n.invalidateFramebuffer(36009,[Te])),O){const Ae=i.get(C[xe]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Ae,0)}n.blitFramebuffer(0,0,G,ae,0,0,G,ae,le,9728),f&&n.invalidateFramebuffer(36008,ge)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),O)for(let xe=0;xe<C.length;xe++){t.bindFramebuffer(36160,I.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+xe,36161,I.__webglColorRenderbuffer[xe]);const pe=i.get(C[xe]).__webglTexture;t.bindFramebuffer(36160,I.__webglFramebuffer),n.framebufferTexture2D(36009,36064+xe,3553,pe,0)}t.bindFramebuffer(36009,I.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=te,this.setupFrameBufferTexture=we,this.useMultisampledRTT=We}function Pj(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===mo)return 5121;if(s===k4)return 32819;if(s===V4)return 32820;if(s===N4)return 5120;if(s===F4)return 5122;if(s===HA)return 5123;if(s===O4)return 5124;if(s===go)return 5125;if(s===Is)return 5126;if(s===nu)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===B4)return 6406;if(s===ki)return 6408;if(s===U4)return 6409;if(s===z4)return 6410;if(s===yo)return 6402;if(s===Ya)return 34041;if(s===C_)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===H4)return 6403;if(s===G4)return 36244;if(s===W4)return 33319;if(s===j4)return 33320;if(s===$4)return 36249;if(s===g_||s===y_||s===__||s===v_)if(o===wt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===g_)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===y_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===__)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===v_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===g_)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===y_)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===__)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===v_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===GA||s===WA||s===jA||s===$A){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===GA)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===WA)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===jA)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===$A)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===q4)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===qA||s===XA){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===qA)return o===wt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===XA)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===YA||s===ZA||s===KA||s===JA||s===QA||s===eT||s===tT||s===nT||s===iT||s===rT||s===sT||s===oT||s===aT||s===lT){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===YA)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===ZA)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===KA)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===JA)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===QA)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===eT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===tT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===nT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===iT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===rT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===sT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===oT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===aT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===lT)return o===wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===x_){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===x_)return o===wt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(s===X4||s===cT||s===uT||s===dT){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(s===x_)return a.COMPRESSED_RED_RGTC1_EXT;if(s===cT)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===uT)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===dT)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Xa?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class Lj extends dn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ks extends bn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Nj={type:"move"};class nv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ks,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ks,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new E,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new E),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ks,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new E,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new E),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const p of e.hand.values()){const g=t.getJointPose(p,i),_=this._getHandJoint(c,p);null!==g&&(_.matrix.fromArray(g.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=g.radius),_.visible=null!==g}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,m=.005;c.inputState.pinching&&h>f+m?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-m&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Nj)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new ks;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class Fj extends ir{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:yo)!==yo&&u!==Ya)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===yo&&(i=go),void 0===i&&u===Ya&&(i=Xa),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Jt,this.minFilter=void 0!==l?l:Jt,this.flipY=!1,this.generateMipmaps=!1}}class Oj extends xo{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,m=null;const p=t.getContextAttributes();let g=null,_=null;const v=[],y=[],x=new Set,w=new Map,M=new dn;M.layers.enable(1),M.viewport=new Ct;const T=new dn;T.layers.enable(2),T.viewport=new Ct;const b=[M,T],S=new Lj;S.layers.enable(1),S.layers.enable(2);let R=null,F=null;function H(z){const ee=y.indexOf(z.inputSource);if(-1===ee)return;const oe=v[ee];void 0!==oe&&oe.dispatchEvent({type:z.type,data:z.inputSource})}function N(){r.removeEventListener("select",H),r.removeEventListener("selectstart",H),r.removeEventListener("selectend",H),r.removeEventListener("squeeze",H),r.removeEventListener("squeezestart",H),r.removeEventListener("squeezeend",H),r.removeEventListener("end",N),r.removeEventListener("inputsourceschange",P);for(let z=0;z<v.length;z++){const ee=y[z];null!==ee&&(y[z]=null,v[z].disconnect(ee))}R=null,F=null,e.setRenderTarget(g),f=null,h=null,d=null,r=null,_=null,_e.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function P(z){for(let ee=0;ee<z.removed.length;ee++){const oe=z.removed[ee],k=y.indexOf(oe);k>=0&&(y[k]=null,v[k].disconnect(oe))}for(let ee=0;ee<z.added.length;ee++){const oe=z.added[ee];let k=y.indexOf(oe);if(-1===k){for(let me=0;me<v.length;me++){if(me>=y.length){y.push(oe),k=me;break}if(null===y[me]){y[me]=oe,k=me;break}}if(-1===k)break}const he=v[k];he&&he.connect(oe)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(z){let ee=v[z];return void 0===ee&&(ee=new nv,v[z]=ee),ee.getTargetRaySpace()},this.getControllerGrip=function(z){let ee=v[z];return void 0===ee&&(ee=new nv,v[z]=ee),ee.getGripSpace()},this.getHand=function(z){let ee=v[z];return void 0===ee&&(ee=new nv,v[z]=ee),ee.getHandSpace()},this.setFramebufferScaleFactor=function(z){s=z,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(z){a=z,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(z){c=z},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=function(){var z=function r4(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){PA(s,i,r,o,a,"next",l)}function a(l){PA(s,i,r,o,a,"throw",l)}o(void 0)})}}(function*(ee){if(r=ee,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",H),r.addEventListener("selectstart",H),r.addEventListener("selectend",H),r.addEventListener("squeeze",H),r.addEventListener("squeezestart",H),r.addEventListener("squeezeend",H),r.addEventListener("end",N),r.addEventListener("inputsourceschange",P),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),_=new wo(f.framebufferWidth,f.framebufferHeight,{format:ki,type:mo,encoding:e.outputEncoding,stencilBuffer:p.stencil});else{let oe=null,k=null,he=null;p.depth&&(he=p.stencil?35056:33190,oe=p.stencil?Ya:yo,k=p.stencil?Xa:go);const me={colorFormat:32856,depthFormat:he,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(me),r.updateRenderState({layers:[h]}),_=new wo(h.textureWidth,h.textureHeight,{format:ki,type:mo,depthTexture:new Fj(h.textureWidth,h.textureHeight,k,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(_).__ignoreDepthValues=h.ignoreDepthValues}_.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),_e.setContext(r),_e.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(ee){return z.apply(this,arguments)}}();const U=new E,Y=new E;function j(z,ee){null===ee?z.matrixWorld.copy(z.matrix):z.matrixWorld.multiplyMatrices(ee.matrixWorld,z.matrix),z.matrixWorldInverse.copy(z.matrixWorld).invert()}this.updateCamera=function(z){if(null===r)return;S.near=T.near=M.near=z.near,S.far=T.far=M.far=z.far,(R!==S.near||F!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),R=S.near,F=S.far);const ee=z.parent,oe=S.cameras;j(S,ee);for(let he=0;he<oe.length;he++)j(oe[he],ee);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),z.matrix.copy(S.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale);const k=z.children;for(let he=0,me=k.length;he<me;he++)k[he].updateMatrixWorld(!0);2===oe.length?function ie(z,ee,oe){U.setFromMatrixPosition(ee.matrixWorld),Y.setFromMatrixPosition(oe.matrixWorld);const k=U.distanceTo(Y),he=ee.projectionMatrix.elements,me=oe.projectionMatrix.elements,ve=he[14]/(he[10]-1),Se=he[14]/(he[10]+1),we=(he[9]+1)/he[5],Le=(he[9]-1)/he[5],Z=(he[8]-1)/he[0],te=(me[8]+1)/me[0],ce=ve*Z,Ee=ve*te,fe=k/(-Z+te),Ge=fe*-Z;ee.matrixWorld.decompose(z.position,z.quaternion,z.scale),z.translateX(Ge),z.translateZ(fe),z.matrixWorld.compose(z.position,z.quaternion,z.scale),z.matrixWorldInverse.copy(z.matrixWorld).invert();const Ne=ve+fe,We=Se+fe;z.projectionMatrix.makePerspective(ce-Ge,Ee+(k-Ge),we*Se/We*Ne,Le*Se/We*Ne,Ne,We)}(S,M,T):S.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(null!==h||null!==f)return l},this.setFoveation=function(z){l=z,null!==h&&(h.fixedFoveation=z),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=z)},this.getPlanes=function(){return x};let J=null;const _e=new kT;_e.setAnimationLoop(function ne(z,ee){if(u=ee.getViewerPose(c||o),m=ee,null!==u){const oe=u.views;null!==f&&(e.setRenderTargetFramebuffer(_,f.framebuffer),e.setRenderTarget(_));let k=!1;oe.length!==S.cameras.length&&(S.cameras.length=0,k=!0);for(let he=0;he<oe.length;he++){const me=oe[he];let ve=null;if(null!==f)ve=f.getViewport(me);else{const we=d.getViewSubImage(h,me);ve=we.viewport,0===he&&(e.setRenderTargetTextures(_,we.colorTexture,h.ignoreDepthValues?void 0:we.depthStencilTexture),e.setRenderTarget(_))}let Se=b[he];void 0===Se&&(Se=new dn,Se.layers.enable(he),Se.viewport=new Ct,b[he]=Se),Se.matrix.fromArray(me.transform.matrix),Se.projectionMatrix.fromArray(me.projectionMatrix),Se.viewport.set(ve.x,ve.y,ve.width,ve.height),0===he&&S.matrix.copy(Se.matrix),!0===k&&S.cameras.push(Se)}}for(let oe=0;oe<v.length;oe++){const k=y[oe],he=v[oe];null!==k&&void 0!==he&&he.update(k,ee,c||o)}if(J&&J(z,ee),ee.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:ee.detectedPlanes});let oe=null;for(const k of x)ee.detectedPlanes.has(k)||(null===oe&&(oe=[]),oe.push(k));if(null!==oe)for(const k of oe)x.delete(k),w.delete(k),i.dispatchEvent({type:"planeremoved",data:k});for(const k of ee.detectedPlanes)if(x.has(k)){const he=w.get(k);k.lastChangedTime>he&&(w.set(k,k.lastChangedTime),i.dispatchEvent({type:"planechanged",data:k}))}else x.add(k),w.set(k,ee.lastChangedTime),i.dispatchEvent({type:"planeadded",data:k})}m=null}),this.setAnimationLoop=function(z){J=z},this.dispose=function(){}}}function kj(n,e){function r(p,g){p.opacity.value=g.opacity,g.color&&p.diffuse.value.copy(g.color),g.emissive&&p.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.bumpMap&&(p.bumpMap.value=g.bumpMap,p.bumpScale.value=g.bumpScale,g.side===vi&&(p.bumpScale.value*=-1)),g.displacementMap&&(p.displacementMap.value=g.displacementMap,p.displacementScale.value=g.displacementScale,p.displacementBias.value=g.displacementBias),g.emissiveMap&&(p.emissiveMap.value=g.emissiveMap),g.normalMap&&(p.normalMap.value=g.normalMap,p.normalScale.value.copy(g.normalScale),g.side===vi&&p.normalScale.value.negate()),g.specularMap&&(p.specularMap.value=g.specularMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest);const _=e.get(g).envMap;if(_&&(p.envMap.value=_,p.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,p.reflectivity.value=g.reflectivity,p.ior.value=g.ior,p.refractionRatio.value=g.refractionRatio),g.lightMap){p.lightMap.value=g.lightMap;const x=!0===n.useLegacyLights?Math.PI:1;p.lightMapIntensity.value=g.lightMapIntensity*x}let v,y;g.aoMap&&(p.aoMap.value=g.aoMap,p.aoMapIntensity.value=g.aoMapIntensity),g.map?v=g.map:g.specularMap?v=g.specularMap:g.displacementMap?v=g.displacementMap:g.normalMap?v=g.normalMap:g.bumpMap?v=g.bumpMap:g.roughnessMap?v=g.roughnessMap:g.metalnessMap?v=g.metalnessMap:g.alphaMap?v=g.alphaMap:g.emissiveMap?v=g.emissiveMap:g.clearcoatMap?v=g.clearcoatMap:g.clearcoatNormalMap?v=g.clearcoatNormalMap:g.clearcoatRoughnessMap?v=g.clearcoatRoughnessMap:g.iridescenceMap?v=g.iridescenceMap:g.iridescenceThicknessMap?v=g.iridescenceThicknessMap:g.specularIntensityMap?v=g.specularIntensityMap:g.specularColorMap?v=g.specularColorMap:g.transmissionMap?v=g.transmissionMap:g.thicknessMap?v=g.thicknessMap:g.sheenColorMap?v=g.sheenColorMap:g.sheenRoughnessMap&&(v=g.sheenRoughnessMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),p.uvTransform.value.copy(v.matrix)),g.aoMap?y=g.aoMap:g.lightMap&&(y=g.lightMap),void 0!==y&&(y.isWebGLRenderTarget&&(y=y.texture),!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uv2Transform.value.copy(y.matrix))}return{refreshFogUniforms:function t(p,g){g.color.getRGB(p.fogColor.value,OT(n)),g.isFog?(p.fogNear.value=g.near,p.fogFar.value=g.far):g.isFogExp2&&(p.fogDensity.value=g.density)},refreshMaterialUniforms:function i(p,g,_,v,y){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(p,g):g.isMeshToonMaterial?(r(p,g),function u(p,g){g.gradientMap&&(p.gradientMap.value=g.gradientMap)}(p,g)):g.isMeshPhongMaterial?(r(p,g),function c(p,g){p.specular.value.copy(g.specular),p.shininess.value=Math.max(g.shininess,1e-4)}(p,g)):g.isMeshStandardMaterial?(r(p,g),function d(p,g){p.roughness.value=g.roughness,p.metalness.value=g.metalness,g.roughnessMap&&(p.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(p.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(p.envMapIntensity.value=g.envMapIntensity)}(p,g),g.isMeshPhysicalMaterial&&function h(p,g,_){p.ior.value=g.ior,g.sheen>0&&(p.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),p.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(p.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(p.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(p.clearcoat.value=g.clearcoat,p.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(p.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(p.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),p.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===vi&&p.clearcoatNormalScale.value.negate())),g.iridescence>0&&(p.iridescence.value=g.iridescence,p.iridescenceIOR.value=g.iridescenceIOR,p.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(p.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(p.transmission.value=g.transmission,p.transmissionSamplerMap.value=_.texture,p.transmissionSamplerSize.value.set(_.width,_.height),g.transmissionMap&&(p.transmissionMap.value=g.transmissionMap),p.thickness.value=g.thickness,g.thicknessMap&&(p.thicknessMap.value=g.thicknessMap),p.attenuationDistance.value=g.attenuationDistance,p.attenuationColor.value.copy(g.attenuationColor)),p.specularIntensity.value=g.specularIntensity,p.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(p.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(p.specularColorMap.value=g.specularColorMap)}(p,g,y)):g.isMeshMatcapMaterial?(r(p,g),function f(p,g){g.matcap&&(p.matcap.value=g.matcap)}(p,g)):g.isMeshDepthMaterial?r(p,g):g.isMeshDistanceMaterial?(r(p,g),function m(p,g){p.referencePosition.value.copy(g.referencePosition),p.nearDistance.value=g.nearDistance,p.farDistance.value=g.farDistance}(p,g)):g.isMeshNormalMaterial?r(p,g):g.isLineBasicMaterial?(function s(p,g){p.diffuse.value.copy(g.color),p.opacity.value=g.opacity}(p,g),g.isLineDashedMaterial&&function o(p,g){p.dashSize.value=g.dashSize,p.totalSize.value=g.dashSize+g.gapSize,p.scale.value=g.scale}(p,g)):g.isPointsMaterial?function a(p,g,_,v){let y;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.size.value=g.size*_,p.scale.value=.5*v,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uvTransform.value.copy(y.matrix))}(p,g,_,v):g.isSpriteMaterial?function l(p,g){let _;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.rotation.value=g.rotation,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?_=g.map:g.alphaMap&&(_=g.alphaMap),void 0!==_&&(!0===_.matrixAutoUpdate&&_.updateMatrix(),p.uvTransform.value.copy(_.matrix))}(p,g):g.isShadowMaterial?(p.color.value.copy(g.color),p.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function Vj(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(35375):0;function f(v,y,x){const w=v.value;if(void 0===x[y]){if("number"==typeof w)x[y]=w;else{const M=Array.isArray(w)?w:[w],T=[];for(let b=0;b<M.length;b++)T.push(M[b].clone());x[y]=T}return!0}if("number"==typeof w){if(x[y]!==w)return x[y]=w,!0}else{const M=Array.isArray(x[y])?x[y]:[x[y]],T=Array.isArray(w)?w:[w];for(let b=0;b<M.length;b++){const S=M[b];if(!1===S.equals(T[b]))return S.copy(T[b]),!0}}return!1}function p(v){const y={boundary:0,storage:0};return"number"==typeof v?(y.boundary=4,y.storage=4):v.isVector2?(y.boundary=8,y.storage=8):v.isVector3||v.isColor?(y.boundary=16,y.storage=12):v.isVector4?(y.boundary=16,y.storage=16):v.isMatrix3?(y.boundary=48,y.storage=48):v.isMatrix4?(y.boundary=64,y.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),y}function g(v){const y=v.target;y.removeEventListener("dispose",g);const x=o.indexOf(y.__bindingPointIndex);o.splice(x,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}return{bind:function l(v,y){i.uniformBlockBinding(v,y.program)},update:function c(v,y){let x=r[v.id];void 0===x&&(function m(v){const y=v.uniforms;let x=0;let M=0;for(let T=0,b=y.length;T<b;T++){const S=y[T],R={boundary:0,storage:0},F=Array.isArray(S.value)?S.value:[S.value];for(let H=0,N=F.length;H<N;H++){const U=p(F[H]);R.boundary+=U.boundary,R.storage+=U.storage}S.__data=new Float32Array(R.storage/Float32Array.BYTES_PER_ELEMENT),S.__offset=x,T>0&&(M=x%16,0!==M&&16-M-R.boundary<0&&(x+=16-M,S.__offset=x)),x+=R.storage}M=x%16,M>0&&(x+=16-M),v.__size=x,v.__cache={}}(v),x=function u(v){const y=function d(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=y;const x=n.createBuffer(),w=v.__size,M=v.usage;return n.bindBuffer(35345,x),n.bufferData(35345,w,M),n.bindBuffer(35345,null),n.bindBufferBase(35345,y,x),x}(v),r[v.id]=x,v.addEventListener("dispose",g)),i.updateUBOMapping(v,y.program);const M=e.render.frame;s[v.id]!==M&&(function h(v){const x=v.uniforms,w=v.__cache;n.bindBuffer(35345,r[v.id]);for(let M=0,T=x.length;M<T;M++){const b=x[M];if(!0===f(b,M,w)){const S=b.__offset,R=Array.isArray(b.value)?b.value:[b.value];let F=0;for(let H=0;H<R.length;H++){const N=R[H],P=p(N);"number"==typeof N?(b.__data[0]=N,n.bufferSubData(35345,S+F,b.__data)):N.isMatrix3?(b.__data[0]=N.elements[0],b.__data[1]=N.elements[1],b.__data[2]=N.elements[2],b.__data[3]=N.elements[0],b.__data[4]=N.elements[3],b.__data[5]=N.elements[4],b.__data[6]=N.elements[5],b.__data[7]=N.elements[0],b.__data[8]=N.elements[6],b.__data[9]=N.elements[7],b.__data[10]=N.elements[8],b.__data[11]=N.elements[0]):(N.toArray(b.__data,F),F+=P.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(35345,S,b.__data)}}n.bindBuffer(35345,null)}(v),s[v.id]=M)},dispose:function _(){for(const v in r)n.deleteBuffer(r[v]);o=[],r={},s={}}}}function gu(n={}){this.isWebGLRenderer=!0;const e=void 0!==n.canvas?n.canvas:function Bj(){const n=au("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let d=null,h=null;const f=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=_o,this.useLegacyLights=!0,this.toneMapping=ts,this.toneMappingExposure=1;const p=this;let g=!1,_=0,v=0,y=null,x=-1,w=null;const M=new Ct,T=new Ct;let b=null,S=e.width,R=e.height,F=1,H=null,N=null;const P=new Ct(0,0,S,R),U=new Ct(0,0,S,R);let Y=!1;const ie=new Z_;let j=!1,J=!1,ne=null;const _e=new $e,z=new E,ee={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function oe(){return null===y?F:1}let me,ve,Se,we,Le,Z,te,ce,Ee,fe,Ge,Ne,We,St,mt,A,C,G,ae,le,ge,Te,I,O,k=t;function he(D,B){for(let W=0;W<D.length;W++){const q=e.getContext(D[W],B);if(null!==q)return q}return null}try{const D={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${h_}`),e.addEventListener("webglcontextlost",Ae,!1),e.addEventListener("webglcontextrestored",Re,!1),e.addEventListener("webglcontextcreationerror",Ie,!1),null===k){const B=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&B.shift(),k=he(B,D),null===k)throw he(B)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===k.getShaderPrecisionFormat&&(k.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}function xe(){me=new J8(k),ve=new $8(k,me,n),me.init(ve),Te=new Pj(k,me,ve),Se=new Ij(k,me,ve),we=new t6,Le=new _j,Z=new Rj(k,me,Se,Le,ve,Te,we),te=new X8(p),ce=new K8(p),Ee=new W5(k,ve),I=new W8(k,me,Ee,ve),fe=new Q8(k,Ee,we,I),Ge=new s6(k,fe,Ee,we),ae=new r6(k,ve,Z),A=new q8(Le),Ne=new yj(p,te,ce,me,ve,I,A),We=new kj(p,Le),St=new xj,mt=new Ej(me,ve),G=new G8(p,te,ce,Se,Ge,u,o),C=new Tj(p,Ge,ve),O=new Vj(k,we,ve,Se),le=new j8(k,me,we,ve),ge=new e6(k,me,we,ve),we.programs=Ne.programs,p.capabilities=ve,p.extensions=me,p.properties=Le,p.renderLists=St,p.shadowMap=C,p.state=Se,p.info=we}xe();const pe=new Oj(p,k);function Ae(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Re(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const D=we.autoReset,B=C.enabled,W=C.autoUpdate,V=C.needsUpdate,q=C.type;xe(),we.autoReset=D,C.enabled=B,C.autoUpdate=W,C.needsUpdate=V,C.type=q}function Ie(D){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function ct(D){const B=D.target;B.removeEventListener("dispose",ct),function gt(D){(function Et(D){const B=Le.get(D).programs;void 0!==B&&(B.forEach(function(W){Ne.releaseProgram(W)}),D.isShaderMaterial&&Ne.releaseShaderCache(D))})(D),Le.remove(D)}(B)}this.xr=pe,this.getContext=function(){return k},this.getContextAttributes=function(){return k.getContextAttributes()},this.forceContextLoss=function(){const D=me.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=me.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(D){void 0!==D&&(F=D,this.setSize(S,R,!1))},this.getSize=function(D){return D.set(S,R)},this.setSize=function(D,B,W=!0){pe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=D,R=B,e.width=Math.floor(D*F),e.height=Math.floor(B*F),!0===W&&(e.style.width=D+"px",e.style.height=B+"px"),this.setViewport(0,0,D,B))},this.getDrawingBufferSize=function(D){return D.set(S*F,R*F).floor()},this.setDrawingBufferSize=function(D,B,W){S=D,R=B,F=W,e.width=Math.floor(D*W),e.height=Math.floor(B*W),this.setViewport(0,0,D,B)},this.getCurrentViewport=function(D){return D.copy(M)},this.getViewport=function(D){return D.copy(P)},this.setViewport=function(D,B,W,V){D.isVector4?P.set(D.x,D.y,D.z,D.w):P.set(D,B,W,V),Se.viewport(M.copy(P).multiplyScalar(F).floor())},this.getScissor=function(D){return D.copy(U)},this.setScissor=function(D,B,W,V){D.isVector4?U.set(D.x,D.y,D.z,D.w):U.set(D,B,W,V),Se.scissor(T.copy(U).multiplyScalar(F).floor())},this.getScissorTest=function(){return Y},this.setScissorTest=function(D){Se.setScissorTest(Y=D)},this.setOpaqueSort=function(D){H=D},this.setTransparentSort=function(D){N=D},this.getClearColor=function(D){return D.copy(G.getClearColor())},this.setClearColor=function(){G.setClearColor.apply(G,arguments)},this.getClearAlpha=function(){return G.getClearAlpha()},this.setClearAlpha=function(){G.setClearAlpha.apply(G,arguments)},this.clear=function(D=!0,B=!0,W=!0){let V=0;D&&(V|=16384),B&&(V|=256),W&&(V|=1024),k.clear(V)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Ae,!1),e.removeEventListener("webglcontextrestored",Re,!1),e.removeEventListener("webglcontextcreationerror",Ie,!1),St.dispose(),mt.dispose(),Le.dispose(),te.dispose(),ce.dispose(),Ge.dispose(),I.dispose(),O.dispose(),Ne.dispose(),pe.dispose(),pe.removeEventListener("sessionstart",se),pe.removeEventListener("sessionend",Me),ne&&(ne.dispose(),ne=null),De.stop()},this.renderBufferDirect=function(D,B,W,V,q,Ve){null===B&&(B=ee);const Ke=q.isMesh&&q.matrixWorld.determinant()<0,rt=function d7(D,B,W,V,q){!0!==B.isScene&&(B=ee),Z.resetTextureUnits();const Ve=B.fog,rt=null===y?p.outputEncoding:!0===y.isXRRenderTarget?y.texture.encoding:_o,ot=(V.isMeshStandardMaterial?ce:te).get(V.envMap||(V.isMeshStandardMaterial?B.environment:null)),yt=!0===V.vertexColors&&!!W.attributes.color&&4===W.attributes.color.itemSize,ht=!!V.normalMap&&!!W.attributes.tangent,ft=!!W.morphAttributes.position,hn=!!W.morphAttributes.normal,Si=!!W.morphAttributes.color,hs=V.toneMapped?p.toneMapping:ts,zo=W.morphAttributes.position||W.morphAttributes.normal||W.morphAttributes.color,fn=void 0!==zo?zo.length:0,pt=Le.get(V),t0=h.state.lights;!0!==j||!0!==J&&D===w||A.setState(V,D,D===w&&V.id===x);let Sn=!1;V.version===pt.__version?(pt.needsLights&&pt.lightsStateVersion!==t0.state.version||pt.outputEncoding!==rt||q.isInstancedMesh&&!1===pt.instancing||!q.isInstancedMesh&&!0===pt.instancing||q.isSkinnedMesh&&!1===pt.skinning||!q.isSkinnedMesh&&!0===pt.skinning||pt.envMap!==ot||!0===V.fog&&pt.fog!==Ve||void 0!==pt.numClippingPlanes&&(pt.numClippingPlanes!==A.numPlanes||pt.numIntersection!==A.numIntersection)||pt.vertexAlphas!==yt||pt.vertexTangents!==ht||pt.morphTargets!==ft||pt.morphNormals!==hn||pt.morphColors!==Si||pt.toneMapping!==hs||!0===ve.isWebGL2&&pt.morphTargetsCount!==fn)&&(Sn=!0):(Sn=!0,pt.__version=V.version);let Ho=pt.currentProgram;!0===Sn&&(Ho=Hi(V,B,q));let kI=!1,Bu=!1,n0=!1;const ei=Ho.getUniforms(),Go=pt.uniforms;if(Se.useProgram(Ho.program)&&(kI=!0,Bu=!0,n0=!0),V.id!==x&&(x=V.id,Bu=!0),kI||w!==D){if(ei.setValue(k,"projectionMatrix",D.projectionMatrix),ve.logarithmicDepthBuffer&&ei.setValue(k,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),w!==D&&(w=D,Bu=!0,n0=!0),V.isShaderMaterial||V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshStandardMaterial||V.envMap){const Ci=ei.map.cameraPosition;void 0!==Ci&&Ci.setValue(k,z.setFromMatrixPosition(D.matrixWorld))}(V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshLambertMaterial||V.isMeshBasicMaterial||V.isMeshStandardMaterial||V.isShaderMaterial)&&ei.setValue(k,"isOrthographic",!0===D.isOrthographicCamera),(V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshLambertMaterial||V.isMeshBasicMaterial||V.isMeshStandardMaterial||V.isShaderMaterial||V.isShadowMaterial||q.isSkinnedMesh)&&ei.setValue(k,"viewMatrix",D.matrixWorldInverse)}if(q.isSkinnedMesh){ei.setOptional(k,q,"bindMatrix"),ei.setOptional(k,q,"bindMatrixInverse");const Ci=q.skeleton;Ci&&(ve.floatVertexTextures?(null===Ci.boneTexture&&Ci.computeBoneTexture(),ei.setValue(k,"boneTexture",Ci.boneTexture,Z),ei.setValue(k,"boneTextureSize",Ci.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const r0=W.morphAttributes;if((void 0!==r0.position||void 0!==r0.normal||void 0!==r0.color&&!0===ve.isWebGL2)&&ae.update(q,W,Ho),(Bu||pt.receiveShadow!==q.receiveShadow)&&(pt.receiveShadow=q.receiveShadow,ei.setValue(k,"receiveShadow",q.receiveShadow)),V.isMeshGouraudMaterial&&null!==V.envMap&&(Go.envMap.value=ot,Go.flipEnvMap.value=ot.isCubeTexture&&!1===ot.isRenderTargetTexture?-1:1),Bu&&(ei.setValue(k,"toneMappingExposure",p.toneMappingExposure),pt.needsLights&&function h7(D,B){D.ambientLightColor.needsUpdate=B,D.lightProbe.needsUpdate=B,D.directionalLights.needsUpdate=B,D.directionalLightShadows.needsUpdate=B,D.pointLights.needsUpdate=B,D.pointLightShadows.needsUpdate=B,D.spotLights.needsUpdate=B,D.spotLightShadows.needsUpdate=B,D.rectAreaLights.needsUpdate=B,D.hemisphereLights.needsUpdate=B}(Go,n0),Ve&&!0===V.fog&&We.refreshFogUniforms(Go,Ve),We.refreshMaterialUniforms(Go,V,F,R,ne),If.upload(k,pt.uniformsList,Go,Z)),V.isShaderMaterial&&!0===V.uniformsNeedUpdate&&(If.upload(k,pt.uniformsList,Go,Z),V.uniformsNeedUpdate=!1),V.isSpriteMaterial&&ei.setValue(k,"center",q.center),ei.setValue(k,"modelViewMatrix",q.modelViewMatrix),ei.setValue(k,"normalMatrix",q.normalMatrix),ei.setValue(k,"modelMatrix",q.matrixWorld),V.isShaderMaterial||V.isRawShaderMaterial){const Ci=V.uniformsGroups;for(let s0=0,p7=Ci.length;s0<p7;s0++)if(ve.isWebGL2){const VI=Ci[s0];O.update(VI,Ho),O.bind(VI,Ho)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ho}(D,B,W,V,q);Se.setMaterial(V,Ke);let ot=W.index,yt=1;!0===V.wireframe&&(ot=fe.getWireframeAttribute(W),yt=2);const ht=W.drawRange,ft=W.attributes.position;let hn=ht.start*yt,Si=(ht.start+ht.count)*yt;null!==Ve&&(hn=Math.max(hn,Ve.start*yt),Si=Math.min(Si,(Ve.start+Ve.count)*yt)),null!==ot?(hn=Math.max(hn,0),Si=Math.min(Si,ot.count)):null!=ft&&(hn=Math.max(hn,0),Si=Math.min(Si,ft.count));const hs=Si-hn;if(hs<0||hs===1/0)return;I.setup(q,V,rt,W,ot);let zo,fn=le;if(null!==ot&&(zo=Ee.get(ot),fn=ge,fn.setIndex(zo)),q.isMesh)!0===V.wireframe?(Se.setLineWidth(V.wireframeLinewidth*oe()),fn.setMode(1)):fn.setMode(4);else if(q.isLine){let pt=V.linewidth;void 0===pt&&(pt=1),Se.setLineWidth(pt*oe()),fn.setMode(q.isLineSegments?1:q.isLineLoop?2:3)}else q.isPoints?fn.setMode(0):q.isSprite&&fn.setMode(4);if(q.isInstancedMesh)fn.renderInstances(hn,hs,q.count);else if(W.isInstancedBufferGeometry){const t0=Math.min(W.instanceCount,void 0!==W._maxInstanceCount?W._maxInstanceCount:1/0);fn.renderInstances(hn,hs,t0)}else fn.render(hn,hs)},this.compile=function(D,B){function W(V,q,Ve){!0===V.transparent&&V.side===es&&!1===V.forceSinglePass?(V.side=vi,V.needsUpdate=!0,Hi(V,q,Ve),V.side=Qr,V.needsUpdate=!0,Hi(V,q,Ve),V.side=es):Hi(V,q,Ve)}h=mt.get(D),h.init(),m.push(h),D.traverseVisible(function(V){V.isLight&&V.layers.test(B.layers)&&(h.pushLight(V),V.castShadow&&h.pushShadow(V))}),h.setupLights(p.useLegacyLights),D.traverse(function(V){const q=V.material;if(q)if(Array.isArray(q))for(let Ve=0;Ve<q.length;Ve++)W(q[Ve],D,V);else W(q,D,V)}),m.pop(),h=null};let L=null;function se(){De.stop()}function Me(){De.start()}const De=new kT;function Ot(D,B,W,V){if(!1===D.visible)return;if(D.layers.test(B.layers))if(D.isGroup)W=D.renderOrder;else if(D.isLOD)!0===D.autoUpdate&&D.update(B);else if(D.isLight)h.pushLight(D),D.castShadow&&h.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||ie.intersectsSprite(D)){V&&z.setFromMatrixPosition(D.matrixWorld).applyMatrix4(_e);const Ke=Ge.update(D),rt=D.material;rt.visible&&d.push(D,Ke,rt,W,z.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(D.isSkinnedMesh&&D.skeleton.frame!==we.render.frame&&(D.skeleton.update(),D.skeleton.frame=we.render.frame),!D.frustumCulled||ie.intersectsObject(D))){V&&z.setFromMatrixPosition(D.matrixWorld).applyMatrix4(_e);const Ke=Ge.update(D),rt=D.material;if(Array.isArray(rt)){const ot=Ke.groups;for(let yt=0,ht=ot.length;yt<ht;yt++){const ft=ot[yt],hn=rt[ft.materialIndex];hn&&hn.visible&&d.push(D,Ke,hn,W,z.z,ft)}}else rt.visible&&d.push(D,Ke,rt,W,z.z,null)}const Ve=D.children;for(let Ke=0,rt=Ve.length;Ke<rt;Ke++)Ot(Ve[Ke],B,W,V)}function Mn(D,B,W,V){const q=D.opaque,Ve=D.transmissive,Ke=D.transparent;h.setupLightsView(W),!0===j&&A.setGlobalState(p.clippingPlanes,W),Ve.length>0&&function Qn(D,B,W){const V=ve.isWebGL2;null===ne&&(ne=new wo(1024,1024,{generateMipmaps:!0,type:me.has("EXT_color_buffer_half_float")?nu:mo,minFilter:ns,samples:V&&!0===s?4:0}));const q=p.getRenderTarget();p.setRenderTarget(ne),p.clear();const Ve=p.toneMapping;p.toneMapping=ts,Pr(D,B,W),p.toneMapping=Ve,Z.updateMultisampleRenderTarget(ne),Z.updateRenderTargetMipmap(ne),p.setRenderTarget(q)}(q,B,W),V&&Se.viewport(M.copy(V)),q.length>0&&Pr(q,B,W),Ve.length>0&&Pr(Ve,B,W),Ke.length>0&&Pr(Ke,B,W),Se.buffers.depth.setTest(!0),Se.buffers.depth.setMask(!0),Se.buffers.color.setMask(!0),Se.setPolygonOffset(!1)}function Pr(D,B,W){const V=!0===B.isScene?B.overrideMaterial:null;for(let q=0,Ve=D.length;q<Ve;q++){const Ke=D[q],rt=Ke.object,ot=Ke.geometry,yt=null===V?Ke.material:V,ht=Ke.group;rt.layers.test(W.layers)&&tn(rt,B,W,ot,yt,ht)}}function tn(D,B,W,V,q,Ve){D.onBeforeRender(p,B,W,V,q,Ve),D.modelViewMatrix.multiplyMatrices(W.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),q.onBeforeRender(p,B,W,V,D,Ve),!0===q.transparent&&q.side===es&&!1===q.forceSinglePass?(q.side=vi,q.needsUpdate=!0,p.renderBufferDirect(W,B,V,q,D,Ve),q.side=Qr,q.needsUpdate=!0,p.renderBufferDirect(W,B,V,q,D,Ve),q.side=es):p.renderBufferDirect(W,B,V,q,D,Ve),D.onAfterRender(p,B,W,V,q,Ve)}function Hi(D,B,W){!0!==B.isScene&&(B=ee);const V=Le.get(D),q=h.state.lights,Ke=q.state.version,rt=Ne.getParameters(D,q.state,h.state.shadowsArray,B,W),ot=Ne.getProgramCacheKey(rt);let yt=V.programs;V.environment=D.isMeshStandardMaterial?B.environment:null,V.fog=B.fog,V.envMap=(D.isMeshStandardMaterial?ce:te).get(D.envMap||V.environment),void 0===yt&&(D.addEventListener("dispose",ct),yt=new Map,V.programs=yt);let ht=yt.get(ot);if(void 0!==ht){if(V.currentProgram===ht&&V.lightsStateVersion===Ke)return Lr(D,rt),ht}else rt.uniforms=Ne.getUniforms(D),D.onBuild(W,rt,p),D.onBeforeCompile(rt,p),ht=Ne.acquireProgram(rt,ot),yt.set(ot,ht),V.uniforms=rt.uniforms;const ft=V.uniforms;(!D.isShaderMaterial&&!D.isRawShaderMaterial||!0===D.clipping)&&(ft.clippingPlanes=A.uniform),Lr(D,rt),V.needsLights=function f7(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&!0===D.lights}(D),V.lightsStateVersion=Ke,V.needsLights&&(ft.ambientLightColor.value=q.state.ambient,ft.lightProbe.value=q.state.probe,ft.directionalLights.value=q.state.directional,ft.directionalLightShadows.value=q.state.directionalShadow,ft.spotLights.value=q.state.spot,ft.spotLightShadows.value=q.state.spotShadow,ft.rectAreaLights.value=q.state.rectArea,ft.ltc_1.value=q.state.rectAreaLTC1,ft.ltc_2.value=q.state.rectAreaLTC2,ft.pointLights.value=q.state.point,ft.pointLightShadows.value=q.state.pointShadow,ft.hemisphereLights.value=q.state.hemi,ft.directionalShadowMap.value=q.state.directionalShadowMap,ft.directionalShadowMatrix.value=q.state.directionalShadowMatrix,ft.spotShadowMap.value=q.state.spotShadowMap,ft.spotLightMatrix.value=q.state.spotLightMatrix,ft.spotLightMap.value=q.state.spotLightMap,ft.pointShadowMap.value=q.state.pointShadowMap,ft.pointShadowMatrix.value=q.state.pointShadowMatrix);const hn=ht.getUniforms(),Si=If.seqWithValue(hn.seq,ft);return V.currentProgram=ht,V.uniformsList=Si,ht}function Lr(D,B){const W=Le.get(D);W.outputEncoding=B.outputEncoding,W.instancing=B.instancing,W.skinning=B.skinning,W.morphTargets=B.morphTargets,W.morphNormals=B.morphNormals,W.morphColors=B.morphColors,W.morphTargetsCount=B.morphTargetsCount,W.numClippingPlanes=B.numClippingPlanes,W.numIntersection=B.numClipIntersection,W.vertexAlphas=B.vertexAlphas,W.vertexTangents=B.vertexTangents,W.toneMapping=B.toneMapping}De.setAnimationLoop(function $(D){L&&L(D)}),typeof self<"u"&&De.setContext(self),this.setAnimationLoop=function(D){L=D,pe.setAnimationLoop(D),null===D?De.stop():De.start()},pe.addEventListener("sessionstart",se),pe.addEventListener("sessionend",Me),this.render=function(D,B){if(void 0===B||!0===B.isCamera){if(!0!==g){if(!0===D.matrixWorldAutoUpdate&&D.updateMatrixWorld(),null===B.parent&&!0===B.matrixWorldAutoUpdate&&B.updateMatrixWorld(),!0===pe.enabled&&!0===pe.isPresenting&&(!0===pe.cameraAutoUpdate&&pe.updateCamera(B),B=pe.getCamera()),!0===D.isScene&&D.onBeforeRender(p,D,B,y),h=mt.get(D,m.length),h.init(),m.push(h),_e.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),ie.setFromProjectionMatrix(_e),J=this.localClippingEnabled,j=A.init(this.clippingPlanes,J),d=St.get(D,f.length),d.init(),f.push(d),Ot(D,B,0,p.sortObjects),d.finish(),!0===p.sortObjects&&d.sort(H,N),!0===j&&A.beginShadows(),C.render(h.state.shadowsArray,D,B),!0===j&&A.endShadows(),!0===this.info.autoReset&&this.info.reset(),G.render(d,D),h.setupLights(p.useLegacyLights),B.isArrayCamera){const V=B.cameras;for(let q=0,Ve=V.length;q<Ve;q++){const Ke=V[q];Mn(d,D,Ke,Ke.viewport)}}else Mn(d,D,B);null!==y&&(Z.updateMultisampleRenderTarget(y),Z.updateRenderTargetMipmap(y)),!0===D.isScene&&D.onAfterRender(p,D,B),I.resetDefaultState(),x=-1,w=null,m.pop(),h=m.length>0?m[m.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(D,B,W){Le.get(D.texture).__webglTexture=B,Le.get(D.depthTexture).__webglTexture=W;const V=Le.get(D);V.__hasExternalTextures=!0,V.__hasExternalTextures&&(V.__autoAllocateDepthBuffer=void 0===W,V.__autoAllocateDepthBuffer||!0===me.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),V.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(D,B){const W=Le.get(D);W.__webglFramebuffer=B,W.__useDefaultFramebuffer=void 0===B},this.setRenderTarget=function(D,B=0,W=0){y=D,_=B,v=W;let V=!0,q=null,Ve=!1,Ke=!1;if(D){const ot=Le.get(D);void 0!==ot.__useDefaultFramebuffer?(Se.bindFramebuffer(36160,null),V=!1):void 0===ot.__webglFramebuffer?Z.setupRenderTarget(D):ot.__hasExternalTextures&&Z.rebindTextures(D,Le.get(D.texture).__webglTexture,Le.get(D.depthTexture).__webglTexture);const yt=D.texture;(yt.isData3DTexture||yt.isDataArrayTexture||yt.isCompressedArrayTexture)&&(Ke=!0);const ht=Le.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(q=ht[B],Ve=!0):q=ve.isWebGL2&&D.samples>0&&!1===Z.useMultisampledRTT(D)?Le.get(D).__webglMultisampledFramebuffer:ht,M.copy(D.viewport),T.copy(D.scissor),b=D.scissorTest}else M.copy(P).multiplyScalar(F).floor(),T.copy(U).multiplyScalar(F).floor(),b=Y;if(Se.bindFramebuffer(36160,q)&&ve.drawBuffers&&V&&Se.drawBuffers(D,q),Se.viewport(M),Se.scissor(T),Se.setScissorTest(b),Ve){const ot=Le.get(D.texture);k.framebufferTexture2D(36160,36064,34069+B,ot.__webglTexture,W)}else if(Ke){const ot=Le.get(D.texture);k.framebufferTextureLayer(36160,36064,ot.__webglTexture,W||0,B||0)}x=-1},this.readRenderTargetPixels=function(D,B,W,V,q,Ve,Ke){if(!D||!D.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let rt=Le.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&void 0!==Ke&&(rt=rt[Ke]),rt){Se.bindFramebuffer(36160,rt);try{const ot=D.texture,yt=ot.format,ht=ot.type;if(yt!==ki&&Te.convert(yt)!==k.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ft=ht===nu&&(me.has("EXT_color_buffer_half_float")||ve.isWebGL2&&me.has("EXT_color_buffer_float"));if(!(ht===mo||Te.convert(ht)===k.getParameter(35738)||ht===Is&&(ve.isWebGL2||me.has("OES_texture_float")||me.has("WEBGL_color_buffer_float"))||ft))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");B>=0&&B<=D.width-V&&W>=0&&W<=D.height-q&&k.readPixels(B,W,V,q,Te.convert(yt),Te.convert(ht),Ve)}finally{const ot=null!==y?Le.get(y).__webglFramebuffer:null;Se.bindFramebuffer(36160,ot)}}},this.copyFramebufferToTexture=function(D,B,W=0){const V=Math.pow(2,-W),q=Math.floor(B.image.width*V),Ve=Math.floor(B.image.height*V);Z.setTexture2D(B,0),k.copyTexSubImage2D(3553,W,0,0,D.x,D.y,q,Ve),Se.unbindTexture()},this.copyTextureToTexture=function(D,B,W,V=0){const q=B.image.width,Ve=B.image.height,Ke=Te.convert(W.format),rt=Te.convert(W.type);Z.setTexture2D(W,0),k.pixelStorei(37440,W.flipY),k.pixelStorei(37441,W.premultiplyAlpha),k.pixelStorei(3317,W.unpackAlignment),B.isDataTexture?k.texSubImage2D(3553,V,D.x,D.y,q,Ve,Ke,rt,B.image.data):B.isCompressedTexture?k.compressedTexSubImage2D(3553,V,D.x,D.y,B.mipmaps[0].width,B.mipmaps[0].height,Ke,B.mipmaps[0].data):k.texSubImage2D(3553,V,D.x,D.y,Ke,rt,B.image),0===V&&W.generateMipmaps&&k.generateMipmap(3553),Se.unbindTexture()},this.copyTextureToTexture3D=function(D,B,W,V,q=0){if(p.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ve=D.max.x-D.min.x+1,Ke=D.max.y-D.min.y+1,rt=D.max.z-D.min.z+1,ot=Te.convert(V.format),yt=Te.convert(V.type);let ht;if(V.isData3DTexture)Z.setTexture3D(V,0),ht=32879;else{if(!V.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Z.setTexture2DArray(V,0),ht=35866}k.pixelStorei(37440,V.flipY),k.pixelStorei(37441,V.premultiplyAlpha),k.pixelStorei(3317,V.unpackAlignment);const ft=k.getParameter(3314),hn=k.getParameter(32878),Si=k.getParameter(3316),hs=k.getParameter(3315),zo=k.getParameter(32877),fn=W.isCompressedTexture?W.mipmaps[0]:W.image;k.pixelStorei(3314,fn.width),k.pixelStorei(32878,fn.height),k.pixelStorei(3316,D.min.x),k.pixelStorei(3315,D.min.y),k.pixelStorei(32877,D.min.z),W.isDataTexture||W.isData3DTexture?k.texSubImage3D(ht,q,B.x,B.y,B.z,Ve,Ke,rt,ot,yt,fn.data):W.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),k.compressedTexSubImage3D(ht,q,B.x,B.y,B.z,Ve,Ke,rt,ot,fn.data)):k.texSubImage3D(ht,q,B.x,B.y,B.z,Ve,Ke,rt,ot,yt,fn),k.pixelStorei(3314,ft),k.pixelStorei(32878,hn),k.pixelStorei(3316,Si),k.pixelStorei(3315,hs),k.pixelStorei(32877,zo),0===q&&V.generateMipmaps&&k.generateMipmap(ht),Se.unbindTexture()},this.initTexture=function(D){D.isCubeTexture?Z.setTextureCube(D,0):D.isData3DTexture?Z.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?Z.setTexture2DArray(D,0):Z.setTexture2D(D,0),Se.unbindTexture()},this.resetState=function(){_=0,v=0,y=null,Se.reset(),I.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(gu.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(n){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!n}}}),class Uj extends gu{}.prototype.isWebGL1Renderer=!0;class Rf extends bn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class sv{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=xi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=xi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=xi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Jn=new E;class Io{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Jn.fromBufferAttribute(this,t),Jn.applyMatrix4(e),this.setXYZ(t,Jn.x,Jn.y,Jn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Jn.fromBufferAttribute(this,t),Jn.applyNormalMatrix(e),this.setXYZ(t,Jn.x,Jn.y,Jn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Jn.fromBufferAttribute(this,t),Jn.transformDirection(e),this.setXYZ(t,Jn.x,Jn.y,Jn.z);return this}setX(e,t){return this.normalized&&(t=At(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=At(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=At(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=At(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=is(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=is(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=is(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=is(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=At(t,this.array),i=At(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=At(t,this.array),i=At(i,this.array),r=At(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=At(t,this.array),i=At(i,this.array),r=At(r,this.array),s=At(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new $t(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Io(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const y1=new E,_1=new Ct,v1=new Ct,Gj=new E,x1=new $e;class b1 extends Hn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new $e,this.bindMatrixInverse=new $e}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ct,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;_1.fromBufferAttribute(r.attributes.skinIndex,e),v1.fromBufferAttribute(r.attributes.skinWeight,e),y1.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=v1.getComponent(s);if(0!==o){const a=_1.getComponent(s);x1.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Gj.copy(y1).applyMatrix4(x1),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class av extends bn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class xu extends ir{constructor(e=null,t=1,i=1,r,s,o,a,l,c=Jt,u=Jt,d,h){super(null,o,a,l,c,u,r,s,d,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const w1=new $e,Wj=new $e;class Of{constructor(e=[],t=[]){this.uuid=xi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new $e)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new $e;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)w1.multiplyMatrices(e[s]?e[s].matrixWorld:Wj,t[s]),w1.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new Of(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=yT(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new xu(t,e,e,ki,Is);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new av),this.bones.push(o),this.boneInverses.push((new $e).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class bu extends $t{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const M1=new $e,S1=new $e,kf=[],jj=new $e,wu=new Hn;class C1 extends Hn{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new bu(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let r=0;r<i;r++)this.setMatrixAt(r,jj)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(wu.geometry=this.geometry,wu.material=this.material,void 0!==wu.material)for(let s=0;s<r;s++){this.getMatrixAt(s,M1),S1.multiplyMatrices(i,M1),wu.matrixWorld=S1,wu.raycast(e,kf);for(let o=0,a=kf.length;o<a;o++){const l=kf[o];l.instanceId=s,l.object=this,t.push(l)}kf.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new bu(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ai extends ar{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new de(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const E1=new E,D1=new E,A1=new $e,lv=new df,Vf=new Eo;class Ro extends bn{constructor(e=new it,t=new ai){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)E1.fromBufferAttribute(t,r-1),D1.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=E1.distanceTo(D1);e.setAttribute("lineDistance",new Ce(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Vf.copy(i.boundingSphere),Vf.applyMatrix4(r),Vf.radius+=s,!1===e.ray.intersectsSphere(Vf))return;A1.copy(r).invert(),lv.copy(e.ray).applyMatrix4(A1);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new E,u=new E,d=new E,h=new E,f=this.isLineSegments?2:1,m=i.index,g=i.attributes.position;if(null!==m)for(let y=Math.max(0,o.start),x=Math.min(m.count,o.start+o.count)-1;y<x;y+=f){const w=m.getX(y),M=m.getX(y+1);if(c.fromBufferAttribute(g,w),u.fromBufferAttribute(g,M),lv.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(h);b<e.near||b>e.far||t.push({distance:b,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count)-1;y<x;y+=f){if(c.fromBufferAttribute(g,y),u.fromBufferAttribute(g,y+1),lv.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(h);M<e.near||M>e.far||t.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const T1=new E,I1=new E;class cv extends Ro{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)T1.fromBufferAttribute(t,r),I1.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+T1.distanceTo(I1);e.setAttribute("lineDistance",new Ce(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class R1 extends Ro{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class uv extends ar{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new de(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const P1=new $e,dv=new df,Bf=new Eo,Uf=new E;class L1 extends bn{constructor(e=new it,t=new uv){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Bf.copy(i.boundingSphere),Bf.applyMatrix4(r),Bf.radius+=s,!1===e.ray.intersectsSphere(Bf))return;P1.copy(r).invert(),dv.copy(e.ray).applyMatrix4(P1);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(null!==c)for(let m=Math.max(0,o.start),p=Math.min(c.count,o.start+o.count);m<p;m++){const g=c.getX(m);Uf.fromBufferAttribute(d,g),N1(Uf,g,l,r,e,t,this)}else for(let m=Math.max(0,o.start),p=Math.min(d.count,o.start+o.count);m<p;m++)Uf.fromBufferAttribute(d,m),N1(Uf,m,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function N1(n,e,t,i,r,s,o){const a=dv.distanceSqToPoint(n);if(a<t){const l=new E;dv.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Jf extends ar{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new de(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vo,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Vs extends Jf{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new X(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Qt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new de(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new de(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new de(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function Ui(n,e,t){return Nv(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)}function No(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function Nv(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function X1(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function Fv(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function Ov(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class Tu{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class k$ extends Tu{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,m=(i-t)/(r-t),p=m*m,g=p*m,_=-h*g+2*h*p-h*m,v=(1+h)*g+(-1.5-2*h)*p+(-.5+h)*m+1,y=(-1-f)*g+(1.5+f)*p+.5*m,x=f*g-f*p;for(let w=0;w!==a;++w)s[w]=_*o[u+w]+v*o[c+w]+y*o[l+w]+x*o[d+w];return s}}class Y1 extends Tu{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class V$ extends Tu{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ir{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=No(t,this.TimeBufferType),this.values=No(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:No(e.times,Array),values:No(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new V$(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Y1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new k$(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case iu:t=this.InterpolantFactoryMethodDiscrete;break;case Za:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return iu;case this.InterpolantFactoryMethodLinear:return Za;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Ui(i,s,o),this.values=Ui(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&Nv(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Ui(this.times),t=Ui(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let m=0;m!==i;++m){const p=t[d+m];if(p!==t[h+m]||p!==t[f+m]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Ui(e,0,o),this.values=Ui(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=Ui(this.times,0),t=Ui(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ir.prototype.TimeBufferType=Float32Array,Ir.prototype.ValueBufferType=Float32Array,Ir.prototype.DefaultInterpolation=Za;class Cl extends Ir{}Cl.prototype.ValueTypeName="bool",Cl.prototype.ValueBufferType=Array,Cl.prototype.DefaultInterpolation=iu,Cl.prototype.InterpolantFactoryMethodLinear=void 0,Cl.prototype.InterpolantFactoryMethodSmooth=void 0;class Z1 extends Ir{}Z1.prototype.ValueTypeName="color";class Iu extends Ir{}Iu.prototype.ValueTypeName="number";class B$ extends Tu{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)In.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Fo extends Ir{InterpolantFactoryMethodLinear(e){return new B$(this.times,this.values,this.getValueSize(),e)}}Fo.prototype.ValueTypeName="quaternion",Fo.prototype.DefaultInterpolation=Za,Fo.prototype.InterpolantFactoryMethodSmooth=void 0;class El extends Ir{}El.prototype.ValueTypeName="string",El.prototype.ValueBufferType=Array,El.prototype.DefaultInterpolation=iu,El.prototype.InterpolantFactoryMethodLinear=void 0,El.prototype.InterpolantFactoryMethodSmooth=void 0;class Ru extends Ir{}Ru.prototype.ValueTypeName="vector";class Pu{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=xi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(z$(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Ir.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=X1(l);l=Fv(l,1,u),c=Fv(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new Iu(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,f,m,p){if(0!==f.length){const g=[],_=[];Ov(f,g,_,m),0!==g.length&&p.push(new d(h,g,_))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let p=0;p<h[m].morphTargets.length;p++)f[h[m].morphTargets[p]]=-1;for(const p in f){const g=[],_=[];for(let v=0;v!==h[m].morphTargets.length;++v){const y=h[m];g.push(y.time),_.push(y.morphTarget===p?1:0)}r.push(new Iu(".morphTargetInfluence["+p+"]",g,_))}l=f.length*o}else{const f=".bones["+t[d].name+"]";i(Ru,f+".position",h,"pos",r),i(Fo,f+".quaternion",h,"rot",r),i(Ru,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function z$(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function U$(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Iu;case"vector":case"vector2":case"vector3":case"vector4":return Ru;case"color":return Z1;case"quaternion":return Fo;case"bool":case"boolean":return Cl;case"string":return El}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];Ov(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Dl={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class K1{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],m=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return m}return null}}}const H$=new K1;class Lu{constructor(e){this.manager=void 0!==e?e:H$,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const us={};class G$ extends Error{constructor(e,t){super(e),this.response=t}}class Rr extends Lu{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Dl.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==us[e])return void us[e].push({onLoad:t,onProgress:i,onError:r});us[e]=[],us[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const u=us[e],d=c.body.getReader(),h=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=h?parseInt(h):0,m=0!==f;let p=0;const g=new ReadableStream({start(_){!function v(){d.read().then(({done:y,value:x})=>{if(y)_.close();else{p+=x.byteLength;const w=new ProgressEvent("progress",{lengthComputable:m,loaded:p,total:f});for(let M=0,T=u.length;M<T;M++){const b=u[M];b.onProgress&&b.onProgress(w)}_.enqueue(x),v()}})}()}});return new Response(g)}throw new G$(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(m=>f.decode(m))}}}).then(c=>{Dl.add(e,c);const u=us[e];delete us[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=us[e];if(void 0===u)throw this.manager.itemError(e),c;delete us[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Qf extends Lu{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Dl.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=au("img");function l(){u(),Dl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class W$ extends Lu{constructor(e){super(e)}load(e,t,i,r){const s=new ir,o=new Qf(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class ep extends bn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new de(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const kv=new $e,J1=new E,Q1=new E;class Vv{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new X(512,512),this.map=null,this.mapPass=null,this.matrix=new $e,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Z_,this._frameExtents=new X(1,1),this._viewportCount=1,this._viewports=[new Ct(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;J1.setFromMatrixPosition(e.matrixWorld),t.position.copy(J1),Q1.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Q1),t.updateMatrixWorld(),kv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kv),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(kv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class $$ extends Vv{constructor(){super(new dn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*su*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class eI extends ep{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(bn.DEFAULT_UP),this.updateMatrix(),this.target=new bn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new $$}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const tI=new $e,Nu=new E,Bv=new E;class q$ extends Vv{constructor(){super(new dn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new X(4,2),this._viewportCount=6,this._viewports=[new Ct(2,1,1,1),new Ct(0,1,1,1),new Ct(3,1,1,1),new Ct(1,1,1,1),new Ct(3,0,1,1),new Ct(1,0,1,1)],this._cubeDirections=[new E(1,0,0),new E(-1,0,0),new E(0,0,1),new E(0,0,-1),new E(0,1,0),new E(0,-1,0)],this._cubeUps=[new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,0,1),new E(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Nu.setFromMatrixPosition(e.matrixWorld),i.position.copy(Nu),Bv.copy(i.position),Bv.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Bv),i.updateMatrixWorld(),r.makeTranslation(-Nu.x,-Nu.y,-Nu.z),tI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tI)}}class li extends ep{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new q$}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class X$ extends Vv{constructor(){super(new Df(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Fu extends ep{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(bn.DEFAULT_UP),this.updateMatrix(),this.target=new bn,this.shadow=new X$}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class tp extends ep{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Ou{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class t9 extends Lu{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Dl.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Dl.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const zv="\\[\\]\\.:\\/",o9=new RegExp("["+zv+"]","g"),Hv="[^"+zv+"]",a9="[^"+zv.replace("\\.","")+"]",h9=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Hv)+/(WCOD+)?/.source.replace("WCOD",a9)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Hv)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Hv)+"$"),f9=["material","materials","bones","map"];class p9{constructor(e,t,i){const r=i||Lt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Lt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(o9,"")}static parseTrackName(t){const i=h9.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==f9.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=p9,n})();Lt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Lt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Lt.prototype.GetterByBindingType=[Lt.prototype._getValue_direct,Lt.prototype._getValue_array,Lt.prototype._getValue_arrayElement,Lt.prototype._getValue_toArray],Lt.prototype.SetterByBindingTypeAndVersioning=[[Lt.prototype._setValue_direct,Lt.prototype._setValue_direct_setNeedsUpdate,Lt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_array,Lt.prototype._setValue_array_setNeedsUpdate,Lt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_arrayElement,Lt.prototype._setValue_arrayElement_setNeedsUpdate,Lt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_fromArray,Lt.prototype._setValue_fromArray_setNeedsUpdate,Lt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class hI{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Qt(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}function MI(n,e){if(e===J4)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===M_||e===fT){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(e===M_)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:h_}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=h_);class qv extends Lu{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new E9(t)}),this.register(function(t){return new L9(t)}),this.register(function(t){return new N9(t)}),this.register(function(t){return new F9(t)}),this.register(function(t){return new A9(t)}),this.register(function(t){return new T9(t)}),this.register(function(t){return new I9(t)}),this.register(function(t){return new R9(t)}),this.register(function(t){return new C9(t)}),this.register(function(t){return new P9(t)}),this.register(function(t){return new D9(t)}),this.register(function(t){return new M9(t)}),this.register(function(t){return new O9(t)}),this.register(function(t){return new k9(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Ou.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Rr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===SI){try{o[dt.KHR_BINARY_GLTF]=new V9(e)}catch(d){return void(r&&r(d))}s=JSON.parse(o[dt.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new K9(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](c);a[d.name]=d,o[d.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const d=s.extensionsUsed[u],h=s.extensionsRequired||[];switch(d){case dt.KHR_MATERIALS_UNLIT:o[d]=new S9;break;case dt.KHR_DRACO_MESH_COMPRESSION:o[d]=new B9(s,this.dracoLoader);break;case dt.KHR_TEXTURE_TRANSFORM:o[d]=new U9;break;case dt.KHR_MESH_QUANTIZATION:o[d]=new z9;break;default:h.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function w9(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const dt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class M9{constructor(e){this.parser=e,this.name=dt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new de(16777215);void 0!==l.color&&u.fromArray(l.color);const d=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new Fu(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new li(u),c.distance=d;break;case"spot":c=new eI(u),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,zs(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class S9{constructor(){this.name=dt.KHR_MATERIALS_UNLIT}getMaterialType(){return Vi}extendParams(e,t,i){const r=[];e.color=new de(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,wt))}return Promise.all(r)}}class C9{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class E9{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Vs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new X(a,a)}return Promise.all(s)}}class D9{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Vs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class A9{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Vs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new de(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,wt)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class T9{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Vs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class I9{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Vs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new de(a[0],a[1],a[2]),Promise.all(s)}}class R9{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Vs:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class P9{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Vs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new de(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,wt)),Promise.all(s)}}class L9{constructor(e){this.parser=e,this.name=dt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class N9{constructor(e){this.parser=e,this.name=dt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class F9{constructor(e){this.parser=e,this.name=dt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class O9{constructor(e){this.name=dt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const u=r.count,d=r.byteStride,h=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,d,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(u*d);return o.decodeGltfBuffer(new Uint8Array(f),u,d,h,r.mode,r.filter),f})})}return null}}class k9{constructor(e){this.name=dt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==zi.TRIANGLES&&c.mode!==zi.TRIANGLE_STRIP&&c.mode!==zi.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),d=u.isGroup?u.children:[u],h=c[0].count,f=[];for(const m of d){const p=new $e,g=new E,_=new In,v=new E(1,1,1),y=new C1(m.geometry,m.material,h);for(let x=0;x<h;x++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,x),l.ROTATION&&_.fromBufferAttribute(l.ROTATION,x),l.SCALE&&v.fromBufferAttribute(l.SCALE,x),y.setMatrixAt(x,p.compose(g,_,v));for(const x in l)"TRANSLATION"!==x&&"ROTATION"!==x&&"SCALE"!==x&&m.geometry.setAttribute(x,l[x]);bn.prototype.copy.call(y,m),y.frustumCulled=!1,this.parser.assignFinalMaterial(y),f.push(y)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}}const SI="glTF";class V9{constructor(e){this.name=dt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==SI)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=i.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class B9{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=dt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const d=Yv[u]||u.toLowerCase();a[d]=o[u]}for(const u in e.attributes){const d=Yv[u]||u.toLowerCase();if(void 0!==o[u]){const h=i.accessors[e.attributes[u]];c[d]=Al[h.componentType].name,l[d]=!0===h.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(d){r.decodeDracoFile(u,function(h){for(const f in h.attributes){const p=l[f];void 0!==p&&(h.attributes[f].normalized=p)}d(h)},a,c)})})}}class U9{constructor(){this.name=dt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class z9{constructor(){this.name=dt.KHR_MESH_QUANTIZATION}}class EI extends Tu{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,u=r-t,d=(i-t)/u,h=d*d,f=h*d,m=e*c,p=m-c,g=-2*f+3*h,_=f-h,v=1-g,y=_-h+d;for(let x=0;x!==a;x++)s[x]=v*o[p+x+a]+y*(o[p+x+l]*u)+g*o[m+x+a]+_*(o[m+x]*u);return s}}const H9=new In;class G9 extends EI{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return H9.fromArray(s).normalize().toArray(s),s}}const zi={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Al={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},DI={9728:Jt,9729:jt,9984:nf,9985:m_,9986:tu,9987:ns},AI={33071:Vn,33648:eu,10497:po},Xv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Yv={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Us={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},W9={CUBICSPLINE:void 0,LINEAR:Za,STEP:iu};function Vu(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function zs(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function q9(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function X9(n){const e=n.extensions&&n.extensions[dt.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+TI(e.attributes):n.indices+":"+TI(n.attributes)+":"+n.mode,t}function TI(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function Kv(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Z9=new $e;class K9{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new w9,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new W$(this.options.manager):new t9(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Rr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};Vu(s,a,r),zs(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[dt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Ou.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=Xv[r.type],l=!0===r.normalized,c=new(0,Al[r.componentType])(r.count*o);return Promise.resolve(new $t(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=Xv[r.type],c=Al[r.componentType],u=c.BYTES_PER_ELEMENT,h=r.byteOffset||0,f=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,m=!0===r.normalized;let p,g;if(f&&f!==u*l){const _=Math.floor(h/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+_+":"+r.count;let y=t.cache.get(v);y||(p=new c(a,_*f,r.count*f/u),y=new sv(p,f/u),t.cache.add(v,y)),g=new Io(y,l,h%f/u,m)}else p=null===a?new c(r.count*l):new c(a,h,r.count*l),g=new $t(p,l,m);if(void 0!==r.sparse){const x=r.sparse.values.byteOffset||0,w=new(0,Al[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*Xv.SCALAR),M=new c(o[2],x,r.sparse.count*l);null!==a&&(g=new $t(g.array.slice(),g.itemSize,g.normalized));for(let T=0,b=w.length;T<b;T++){const S=w[T];if(g.setX(S,M[T*l]),l>=2&&g.setY(S,M[T*l+1]),l>=3&&g.setZ(S,M[T*l+2]),l>=4&&g.setW(S,M[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"";const h=(s.samplers||{})[o.sampler]||{};return u.magFilter=DI[h.magFilter]||jt,u.minFilter=DI[h.minFilter]||ns,u.wrapS=AI[h.wrapS]||po,u.wrapT=AI[h.wrapT]||po,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(d=>d.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(d){c=!0;const h=new Blob([d],{type:o.mimeType});return l=a.createObjectURL(h),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(d){return new Promise(function(h,f){let m=h;!0===t.isImageBitmapLoader&&(m=function(p){const g=new ir(p);g.needsUpdate=!0,h(g)}),t.load(Ou.resolveURL(d,s.path),m,void 0,f)})}).then(function(d){return!0===c&&a.revokeObjectURL(l),d.userData.mimeType=o.mimeType||function Y9(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&0!=i.texCoord&&!("aoMap"===t&&1==i.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),s.extensions[dt.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[dt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[dt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new uv,ar.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new ai,ar.prototype.copy.call(l,i),l.color.copy(i.color),this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return Jf}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[dt.KHR_MATERIALS_UNLIT]){const d=r[dt.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),c.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new de(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const h=d.baseColorFactor;a.color.fromArray(h),a.opacity=h[3]}void 0!==d.baseColorTexture&&c.push(t.assignTexture(a,"map",d.baseColorTexture,wt)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=es);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Vi&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new X(1,1),void 0!==s.normalTexture.scale)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}return void 0!==s.occlusionTexture&&o!==Vi&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Vi&&(a.emissive=(new de).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==Vi&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,wt)),Promise.all(c).then(function(){const d=new o(a);return s.name&&(d.name=s.name),zs(d,s),t.associations.set(d,{materials:e}),s.extensions&&Vu(r,d,s),d})}createUniqueName(e){const t=Lt.sanitizeNodeName(e||"");let i=t;for(let r=1;this.nodeNamesUsed[i];++r)i=t+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[dt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return II(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=X9(c),d=r[u];if(d)o.push(d.promise);else{let h;h=c.extensions&&c.extensions[dt.KHR_DRACO_MESH_COMPRESSION]?s(c):II(new it,c,t),r[u]={primitive:c,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new Jf({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Qr})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(u)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],d=[];for(let f=0,m=u.length;f<m;f++){const p=u[f],g=o[f];let _;const v=c[f];if(g.mode===zi.TRIANGLES||g.mode===zi.TRIANGLE_STRIP||g.mode===zi.TRIANGLE_FAN||void 0===g.mode)_=!0===s.isSkinnedMesh?new b1(p,v):new Hn(p,v),!0===_.isSkinnedMesh&&_.normalizeSkinWeights(),g.mode===zi.TRIANGLE_STRIP?_.geometry=MI(_.geometry,fT):g.mode===zi.TRIANGLE_FAN&&(_.geometry=MI(_.geometry,M_));else if(g.mode===zi.LINES)_=new cv(p,v);else if(g.mode===zi.LINE_STRIP)_=new Ro(p,v);else if(g.mode===zi.LINE_LOOP)_=new R1(p,v);else{if(g.mode!==zi.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);_=new L1(p,v)}Object.keys(_.geometry.morphAttributes).length>0&&q9(_,s),_.name=t.createUniqueName(s.name||"mesh_"+e),zs(_,s),g.extensions&&Vu(r,_,g),t.assignFinalMaterial(_),d.push(_)}for(let f=0,m=d.length;f<m;f++)t.associations.set(d[f],{meshes:e,primitives:f});if(1===d.length)return d[0];const h=new ks;t.associations.set(h,{meshes:e});for(let f=0,m=d.length;f<m;f++)h.add(d[f]);return h})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new dn(g5_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new Df(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),zs(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const d=o[c];if(d){a.push(d);const h=new $e;null!==s&&h.fromArray(s.array,16*c),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new Of(a,l)})}loadAnimation(e){const i=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let c=0,u=i.channels.length;c<u;c++){const d=i.channels[c],h=i.samplers[d.sampler],f=d.target,p=void 0!==i.parameters?i.parameters[h.input]:h.input,g=void 0!==i.parameters?i.parameters[h.output]:h.output;r.push(this.getDependency("node",f.node)),s.push(this.getDependency("accessor",p)),o.push(this.getDependency("accessor",g)),a.push(h),l.push(f)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],d=c[1],h=c[2],f=c[3],m=c[4],p=[];for(let _=0,v=u.length;_<v;_++){const y=u[_],x=d[_],w=h[_],M=f[_],T=m[_];if(void 0===y)continue;let b;switch(y.updateMatrix(),Us[T.path]){case Us.weights:b=Iu;break;case Us.rotation:b=Fo;break;default:b=Ru}const S=y.name?y.name:y.uuid,R=void 0!==M.interpolation?W9[M.interpolation]:Za,F=[];Us[T.path]===Us.weights?y.traverse(function(N){N.morphTargetInfluences&&F.push(N.name?N.name:N.uuid)}):F.push(S);let H=w.array;if(w.normalized){const N=Kv(H.constructor),P=new Float32Array(H.length);for(let U=0,Y=H.length;U<Y;U++)P[U]=H[U]*N;H=P}for(let N=0,P=F.length;N<P;N++){const U=new b(F[N]+"."+Us[T.path],x.array,H,R);"CUBICSPLINE"===M.interpolation&&(U.createInterpolant=function(ie){return new(this instanceof Fo?G9:EI)(this.times,this.values,this.getValueSize()/3,ie)},U.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),p.push(U)}}return new Pu(i.name?i.name:"animation_"+e,void 0,p)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,u=a.length;c<u;c++)o.push(i.getDependency("node",a[c]));const l=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],d=c[1],h=c[2];null!==h&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(h,Z9)});for(let f=0,m=d.length;f<m;f++)u.add(d[f]);return u})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(u=!0===s.isBone?new av:c.length>1?new ks:1===c.length?c[0]:new bn,u!==c[0])for(let d=0,h=c.length;d<h;d++)u.add(c[d]);if(s.name&&(u.userData.name=s.name,u.name=o),zs(u,s),s.extensions&&Vu(i,u,s),void 0!==s.matrix){const d=new $e;d.fromArray(s.matrix),u.applyMatrix4(d)}else void 0!==s.translation&&u.position.fromArray(s.translation),void 0!==s.rotation&&u.quaternion.fromArray(s.rotation),void 0!==s.scale&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new ks;i.name&&(s.name=r.createUniqueName(i.name)),zs(s,i),i.extensions&&Vu(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,d=l.length;u<d;u++)s.add(l[u]);return r.associations=(u=>{const d=new Map;for(const[h,f]of r.associations)(h instanceof ar||h instanceof ir)&&d.set(h,f);return u.traverse(h=>{const f=r.associations.get(h);null!=f&&d.set(h,f)}),d})(s),s})}}function II(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=Yv[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return zs(n,e),function J9(n,e,t){const i=e.attributes,r=new bi;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new E(l[0],l[1],l[2]),new E(c[0],c[1],c[2])),a.normalized){const u=Kv(Al[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new E,l=new E;for(let c=0,u=s.length;c<u;c++){const d=s[c];if(void 0!==d.POSITION){const h=t.json.accessors[d.POSITION],f=h.min,m=h.max;if(void 0!==f&&void 0!==m){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(m[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(m[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(m[2]))),h.normalized){const p=Kv(Al[h.componentType]);l.multiplyScalar(p)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new Eo;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function $9(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const d=e[c];if(void 0!==d.POSITION&&(i=!0),void 0!==d.NORMAL&&(r=!0),void 0!==d.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c];if(i){const h=void 0!==d.POSITION?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(h)}if(r){const h=void 0!==d.NORMAL?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(h)}if(s){const h=void 0!==d.COLOR_0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const d=c[1],h=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const RI={type:"change"},Jv={type:"start"},PI={type:"end"};class Qv extends xo{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new E,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Wa.ROTATE,MIDDLE:Wa.DOLLY,RIGHT:Wa.PAN},this.touches={ONE:ja.ROTATE,TWO:ja.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(I){I.addEventListener("keydown",mt),this._domElementKeyEvents=I},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",mt),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(RI),i.update(),s=r.NONE},this.update=function(){const I=new E,O=(new In).setFromUnitVectors(e.up,new E(0,1,0)),xe=O.clone().invert(),pe=new E,Ae=new In,Re=2*Math.PI;return function(){const ct=i.object.position;I.copy(ct).sub(i.target),I.applyQuaternion(O),a.setFromVector3(I),i.autoRotate&&s===r.NONE&&S(function T(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let gt=i.minAzimuthAngle,Et=i.maxAzimuthAngle;return isFinite(gt)&&isFinite(Et)&&(gt<-Math.PI?gt+=Re:gt>Math.PI&&(gt-=Re),Et<-Math.PI?Et+=Re:Et>Math.PI&&(Et-=Re),a.theta=gt<=Et?Math.max(gt,Math.min(Et,a.theta)):a.theta>(gt+Et)/2?Math.max(gt,a.theta):Math.min(Et,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),I.setFromSpherical(a),I.applyQuaternion(xe),ct.copy(i.target).add(I),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(d||pe.distanceToSquared(i.object.position)>o||8*(1-Ae.dot(i.object.quaternion))>o)&&(i.dispatchEvent(RI),pe.copy(i.object.position),Ae.copy(i.object.quaternion),d=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",G),i.domElement.removeEventListener("pointerdown",ce),i.domElement.removeEventListener("pointercancel",Ge),i.domElement.removeEventListener("wheel",St),i.domElement.removeEventListener("pointermove",Ee),i.domElement.removeEventListener("pointerup",fe),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",mt),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new hI,l=new hI;let c=1;const u=new E;let d=!1;const h=new X,f=new X,m=new X,p=new X,g=new X,_=new X,v=new X,y=new X,x=new X,w=[],M={};function b(){return Math.pow(.95,i.zoomSpeed)}function S(I){l.theta-=I}function R(I){l.phi-=I}const F=function(){const I=new E;return function(xe,pe){I.setFromMatrixColumn(pe,0),I.multiplyScalar(-xe),u.add(I)}}(),H=function(){const I=new E;return function(xe,pe){!0===i.screenSpacePanning?I.setFromMatrixColumn(pe,1):(I.setFromMatrixColumn(pe,0),I.crossVectors(i.object.up,I)),I.multiplyScalar(xe),u.add(I)}}(),N=function(){const I=new E;return function(xe,pe){const Ae=i.domElement;if(i.object.isPerspectiveCamera){I.copy(i.object.position).sub(i.target);let Ie=I.length();Ie*=Math.tan(i.object.fov/2*Math.PI/180),F(2*xe*Ie/Ae.clientHeight,i.object.matrix),H(2*pe*Ie/Ae.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(F(xe*(i.object.right-i.object.left)/i.object.zoom/Ae.clientWidth,i.object.matrix),H(pe*(i.object.top-i.object.bottom)/i.object.zoom/Ae.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function P(I){i.object.isPerspectiveCamera?c/=I:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*I)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function U(I){i.object.isPerspectiveCamera?c*=I:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/I)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Y(I){h.set(I.clientX,I.clientY)}function j(I){p.set(I.clientX,I.clientY)}function oe(){1===w.length?h.set(w[0].pageX,w[0].pageY):h.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function k(){1===w.length?p.set(w[0].pageX,w[0].pageY):p.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function he(){const I=w[0].pageX-w[1].pageX,O=w[0].pageY-w[1].pageY,xe=Math.sqrt(I*I+O*O);v.set(0,xe)}function Se(I){if(1==w.length)f.set(I.pageX,I.pageY);else{const xe=Te(I);f.set(.5*(I.pageX+xe.x),.5*(I.pageY+xe.y))}m.subVectors(f,h).multiplyScalar(i.rotateSpeed);const O=i.domElement;S(2*Math.PI*m.x/O.clientHeight),R(2*Math.PI*m.y/O.clientHeight),h.copy(f)}function we(I){if(1===w.length)g.set(I.pageX,I.pageY);else{const O=Te(I);g.set(.5*(I.pageX+O.x),.5*(I.pageY+O.y))}_.subVectors(g,p).multiplyScalar(i.panSpeed),N(_.x,_.y),p.copy(g)}function Le(I){const O=Te(I),xe=I.pageX-O.x,pe=I.pageY-O.y,Ae=Math.sqrt(xe*xe+pe*pe);y.set(0,Ae),x.set(0,Math.pow(y.y/v.y,i.zoomSpeed)),P(x.y),v.copy(y)}function ce(I){!1!==i.enabled&&(0===w.length&&(i.domElement.setPointerCapture(I.pointerId),i.domElement.addEventListener("pointermove",Ee),i.domElement.addEventListener("pointerup",fe)),function ae(I){w.push(I)}(I),"touch"===I.pointerType?function A(I){switch(ge(I),w.length){case 1:switch(i.touches.ONE){case ja.ROTATE:if(!1===i.enableRotate)return;oe(),s=r.TOUCH_ROTATE;break;case ja.PAN:if(!1===i.enablePan)return;k(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case ja.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function me(){i.enableZoom&&he(),i.enablePan&&k()})(),s=r.TOUCH_DOLLY_PAN;break;case ja.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ve(){i.enableZoom&&he(),i.enableRotate&&oe()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Jv)}(I):function Ne(I){let O;switch(I.button){case 0:O=i.mouseButtons.LEFT;break;case 1:O=i.mouseButtons.MIDDLE;break;case 2:O=i.mouseButtons.RIGHT;break;default:O=-1}switch(O){case Wa.DOLLY:if(!1===i.enableZoom)return;(function ie(I){v.set(I.clientX,I.clientY)})(I),s=r.DOLLY;break;case Wa.ROTATE:if(I.ctrlKey||I.metaKey||I.shiftKey){if(!1===i.enablePan)return;j(I),s=r.PAN}else{if(!1===i.enableRotate)return;Y(I),s=r.ROTATE}break;case Wa.PAN:if(I.ctrlKey||I.metaKey||I.shiftKey){if(!1===i.enableRotate)return;Y(I),s=r.ROTATE}else{if(!1===i.enablePan)return;j(I),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Jv)}(I))}function Ee(I){!1!==i.enabled&&("touch"===I.pointerType?function C(I){switch(ge(I),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Se(I),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;we(I),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Z(I){i.enableZoom&&Le(I),i.enablePan&&we(I)})(I),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function te(I){i.enableZoom&&Le(I),i.enableRotate&&Se(I)})(I),i.update();break;default:s=r.NONE}}(I):function We(I){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function J(I){f.set(I.clientX,I.clientY),m.subVectors(f,h).multiplyScalar(i.rotateSpeed);const O=i.domElement;S(2*Math.PI*m.x/O.clientHeight),R(2*Math.PI*m.y/O.clientHeight),h.copy(f),i.update()}(I);break;case r.DOLLY:if(!1===i.enableZoom)return;!function ne(I){y.set(I.clientX,I.clientY),x.subVectors(y,v),x.y>0?P(b()):x.y<0&&U(b()),v.copy(y),i.update()}(I);break;case r.PAN:if(!1===i.enablePan)return;!function _e(I){g.set(I.clientX,I.clientY),_.subVectors(g,p).multiplyScalar(i.panSpeed),N(_.x,_.y),p.copy(g),i.update()}(I)}}(I))}function fe(I){le(I),0===w.length&&(i.domElement.releasePointerCapture(I.pointerId),i.domElement.removeEventListener("pointermove",Ee),i.domElement.removeEventListener("pointerup",fe)),i.dispatchEvent(PI),s=r.NONE}function Ge(I){le(I)}function St(I){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(I.preventDefault(),i.dispatchEvent(Jv),function z(I){I.deltaY<0?U(b()):I.deltaY>0&&P(b()),i.update()}(I),i.dispatchEvent(PI))}function mt(I){!1===i.enabled||!1===i.enablePan||function ee(I){let O=!1;switch(I.code){case i.keys.UP:I.ctrlKey||I.metaKey||I.shiftKey?R(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(0,i.keyPanSpeed),O=!0;break;case i.keys.BOTTOM:I.ctrlKey||I.metaKey||I.shiftKey?R(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(0,-i.keyPanSpeed),O=!0;break;case i.keys.LEFT:I.ctrlKey||I.metaKey||I.shiftKey?S(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(i.keyPanSpeed,0),O=!0;break;case i.keys.RIGHT:I.ctrlKey||I.metaKey||I.shiftKey?S(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(-i.keyPanSpeed,0),O=!0}O&&(I.preventDefault(),i.update())}(I)}function G(I){!1!==i.enabled&&I.preventDefault()}function le(I){delete M[I.pointerId];for(let O=0;O<w.length;O++)if(w[O].pointerId==I.pointerId)return void w.splice(O,1)}function ge(I){let O=M[I.pointerId];void 0===O&&(O=new X,M[I.pointerId]=O),O.set(I.pageX,I.pageY)}function Te(I){return M[(I.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}i.domElement.addEventListener("contextmenu",G),i.domElement.addEventListener("pointerdown",ce),i.domElement.addEventListener("pointercancel",Ge),i.domElement.addEventListener("wheel",St,{passive:!1}),this.update()}}const Tl=new E,LI=new $e,NI=new $e,FI=new E,OI=new E;class e0{constructor(e={}){const t=this;let i,r,s,o;const a={objects:new WeakMap},l=void 0!==e.element?e.element:document.createElement("div");function c(f,m,p){if(f.isCSS2DObject){Tl.setFromMatrixPosition(f.matrixWorld),Tl.applyMatrix4(NI);const g=!0===f.visible&&Tl.z>=-1&&Tl.z<=1&&!0===f.layers.test(p.layers);if(f.element.style.display=!0===g?"":"none",!0===g){f.onBeforeRender(t,m,p);const v=f.element;v.style.transform="translate(-50%,-50%) translate("+(Tl.x*s+s)+"px,"+(-Tl.y*o+o)+"px)",v.parentNode!==l&&l.appendChild(v),f.onAfterRender(t,m,p)}const _={distanceToCameraSquared:u(p,f)};a.objects.set(f,_)}for(let g=0,_=f.children.length;g<_;g++)c(f.children[g],m,p)}function u(f,m){return FI.setFromMatrixPosition(f.matrixWorld),OI.setFromMatrixPosition(m.matrixWorld),FI.distanceToSquared(OI)}l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:i,height:r}},this.render=function(f,m){!0===f.matrixWorldAutoUpdate&&f.updateMatrixWorld(),null===m.parent&&!0===m.matrixWorldAutoUpdate&&m.updateMatrixWorld(),LI.copy(m.matrixWorldInverse),NI.multiplyMatrices(m.projectionMatrix,LI),c(f,f,m),function h(f){const m=function d(f){const m=[];return f.traverse(function(p){p.isCSS2DObject&&m.push(p)}),m}(f).sort(function(g,_){return g.renderOrder!==_.renderOrder?_.renderOrder-g.renderOrder:a.objects.get(g).distanceToCameraSquared-a.objects.get(_).distanceToCameraSquared}),p=m.length;for(let g=0,_=m.length;g<_;g++)m[g].element.style.zIndex=p-g}(f)},this.setSize=function(f,m){i=f,r=m,s=i/2,o=r/2,l.style.width=f+"px",l.style.height=m+"px"}}}const Q9=["canvas"];let e7=(()=>{class n{get canvas(){return this.canvasRef.nativeElement}animateModel(){}createScene(){this.scene=new Rf,this.scene.background=new de(13948120),this.loaderGLTF.load("../../assets/3d-assets/Terrain_Existing.gltf",i=>{this.model=i.scene.children[0],console.log(this.model),(new bi).setFromObject(this.model).getCenter(this.model.position),this.model.position.multiplyScalar(-1),this.scene.add(this.model)}),this.loaderGLTF.load("../../assets/3d-assets/Terrain_Outer.gltf",i=>{this.model=i.scene.children[0],console.log(this.model),(new bi).setFromObject(this.model).getCenter(this.model.position),this.model.position.multiplyScalar(-1),this.scene.add(this.model)});let t=this.getAspectRatio();this.camera=new dn(this.fieldOfView,t,this.nearClippingPane,this.farClippingPane),this.camera.position.x=100,this.camera.position.y=500,this.camera.position.z=100,this.ambientLight=new tp(0,50),this.scene.add(this.ambientLight),this.directionalLight=new Fu(16768772,.4),this.directionalLight.position.set(0,1,0),this.directionalLight.castShadow=!0,this.scene.add(this.directionalLight),this.light1=new li(4929308,10),this.light1.position.set(0,200,400),this.scene.add(this.light1),this.light2=new li(4929308,10),this.light2.position.set(500,100,0),this.scene.add(this.light2),this.light3=new li(4929308,10),this.light3.position.set(0,100,-500),this.scene.add(this.light3),this.light4=new li(4929308,10),this.light4.position.set(-500,300,500),this.scene.add(this.light4)}getAspectRatio(){return this.canvas.clientWidth/this.canvas.clientHeight}startRenderingLoop(){this.renderer=new gu({canvas:this.canvas,antialias:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight);let t=this;!function i(){t.renderer.render(t.scene,t.camera),t.animateModel(),requestAnimationFrame(i)}()}constructor(){this.fieldOfView=120,this.nearClippingPane=1,this.farClippingPane=3e3,this.loaderGLTF=new qv,this.createControls=()=>{const t=new e0;t.setSize(1200,780),t.domElement.style.position="absolute",t.domElement.style.top="0px",document.body.appendChild(t.domElement),this.controls=new Qv(this.camera,t.domElement),this.controls.autoRotate=!0,this.controls.enableZoom=!0,this.controls.enablePan=!1,this.controls.update()}}ngOnInit(){}ngAfterViewInit(){this.createScene(),this.startRenderingLoop(),this.createControls()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Wi({type:n,selectors:[["app-stage"]],viewQuery:function(t,i){if(1&t&&vc(Q9,5),2&t){let r;Aa(r=Ta())&&(i.canvasRef=r.first)}},inputs:{fieldOfView:"fieldOfView",nearClippingPane:["nearClipping","nearClippingPane"],farClippingPane:["farClipping","farClippingPane"]},decls:5,vars:0,consts:[[1,"container","text-center"],[1,"row"],[1,"col"],[1,"container",2,"margin","20px"]],template:function(t,i){1&t&&(Bt(0,"div",0)(1,"div",1)(2,"div",2),an(3,"router-outlet"),on()()(),an(4,"div",3))},dependencies:[Gh]}),n})(),t7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Wi({type:n,selectors:[["app-home"]],decls:14,vars:0,consts:[[1,"container"],["role","group","aria-label","Basic radio toggle button group",1,"btn-group"],["type","radio","name","btnradio","id","btnradio1","autocomplete","off","checked","","routerLink","/home/pre-mining",1,"btn-check"],["for","btnradio1",1,"btn","btn-outline-primary"],["type","radio","name","btnradio","id","btnradio2","autocomplete","off","routerLink","/home/mining",1,"btn-check"],["for","btnradio2",1,"btn","btn-outline-primary"]],template:function(t,i){1&t&&(an(0,"app-navbar")(1,"br"),Bt(2,"div",0)(3,"div",1),an(4,"input",2),Bt(5,"label",3),br(6,"PRE MINING"),on(),an(7,"input",4),Bt(8,"label",5),br(9,"MINING"),on()(),an(10,"br")(11,"br")(12,"app-stage")(13,"app-footer"),on())},dependencies:[Zc,n4,i4,e7]}),n})();const n7=["messagebox"];let i7=(()=>{class n{constructor(t,i,r){this.formBuilder=t,this.route=i,this.router=r,this.loading=!1,this.submitted=!1}ngOnInit(){this.loginForm=this.formBuilder.group({login:["",gh.required],password:["",gh.required]})}onSubmit(){""!=this.loginForm.value.login&&""!=this.loginForm.value.password?"demo"==this.loginForm.value.login||"demo"==this.loginForm.value.password?this.router.navigateByUrl("/home"):this.addMessage("Invalid Username and Password."):this.addMessage("Username and Password can not be empty.")}buildForm(){this.loginForm=this.formBuilder.group({username:["",gh.required],password:["",gh.required]})}addMessage(t){this.messagebox.nativeElement.classList.add("alert"),this.messagebox.nativeElement.classList.add("alert-danger"),this.messagebox.nativeElement.innerHTML=t}}return n.\u0275fac=function(t){return new(t||n)(Q(Ez),Q(uo),Q(oi))},n.\u0275cmp=Wi({type:n,selectors:[["app-login"]],viewQuery:function(t,i){if(1&t&&vc(n7,5),2&t){let r;Aa(r=Ta())&&(i.messagebox=r.first)}},decls:29,vars:1,consts:[[1,"container"],[1,"row","text-center","mb-4"],[1,"col-md-12"],["src","../../assets/ui/truescape-logo-dark.png","height","50px"],[1,"row","text-center"],[1,"col-md-6","offset-md-3"],[1,"card"],[1,"card-body"],[1,"login-img"],["src","../../assets/ui/logo.svg",2,"height","50px","width","50px"],[1,"login-form","mt-4"],["novalidate","",1,"row","g-3","needs-validation",3,"formGroup","ngSubmit"],[1,"h3","mb-3","fw-normal"],[1,"form-floating"],["type","text","id","floatingUser","required","","formControlName","login",1,"form-control"],["for","floatingUser",1,"form-label"],["type","password","id","floatingPassword","required","","formControlName","password",1,"form-control"],["for","floatingPassword",1,"form-label"],["role","alert"],["messagebox",""],["type","submit",1,"w-100","btn","btn-lg","btn-primary"],[1,"mt-5","mb-3","text-muted"]],template:function(t,i){1&t&&(Bt(0,"div",0)(1,"div",1)(2,"div",2),an(3,"img",3),on()(),Bt(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8),an(9,"img",9),on(),Bt(10,"div",10)(11,"form",11),yi("ngSubmit",function(){return i.onSubmit()}),Bt(12,"h1",12),br(13,"Please sign in"),on(),Bt(14,"div",13),an(15,"input",14),Bt(16,"label",15),br(17,"User name"),on()(),Bt(18,"div",13),an(19,"input",16),Bt(20,"label",17),br(21,"Password"),on()(),an(22,"div",18,19)(24,"BR"),Bt(25,"button",20),br(26,"Sign in"),on(),Bt(27,"p",21),br(28,"\xa9 Copyright Truescape Ltd (2023). All rights reserved"),on()()()()()()()()),2&t&&(function Wb(n){jb(ut(),K(),$n()+n,!1)}(11),Jm("formGroup",i.loginForm))},dependencies:[eD,mh,BE,UE,Th,Ah,Ly]}),n})();const r7=["canvas"];let s7=(()=>{class n{get canvas(){return this.canvasRef.nativeElement}createScene(){this.scene=new Rf,this.scene.background=new de(13948120),this.loaderGLTF.load("../../assets/3d-assets/Terrain_Year16.gltf",t=>{this.model=t.scene.children[0],console.log(this.model),(new bi).setFromObject(this.model).getCenter(this.model.position),this.model.position.multiplyScalar(-1),this.scene.add(this.model)}),this.loaderGLTF.load("../../assets/3d-assets/Mining_Facilities.gltf",t=>{this.model=t.scene.children[0],console.log(this.model),(new bi).setFromObject(this.model),this.model.position.multiplyScalar(-1),this.scene.add(this.model)}),this.camera=new dn(this.fieldOfView,.75,this.nearClippingPane,this.farClippingPane),this.camera.position.x=100,this.camera.position.y=500,this.camera.position.z=100,this.ambientLight=new tp(0,50),this.scene.add(this.ambientLight),this.directionalLight=new Fu(16768772,.4),this.directionalLight.position.set(0,1,0),this.directionalLight.castShadow=!0,this.scene.add(this.directionalLight),this.light1=new li(4929308,10),this.light1.position.set(0,200,400),this.scene.add(this.light1),this.light2=new li(4929308,10),this.light2.position.set(500,100,0),this.scene.add(this.light2),this.light3=new li(4929308,10),this.light3.position.set(0,100,-500),this.scene.add(this.light3),this.light4=new li(4929308,10),this.light4.position.set(-500,300,500),this.scene.add(this.light4)}startRenderingLoop(){this.renderer=new gu({canvas:this.canvas,antialias:!0}),this.renderer.setSize(.8*window.innerWidth,.8*window.innerHeight);let t=this;!function i(){t.renderer.render(t.scene,t.camera),requestAnimationFrame(i)}()}constructor(){this.fieldOfView=120,this.nearClippingPane=1,this.farClippingPane=3e3,this.loaderGLTF=new qv,this.createControls=()=>{const t=new e0;t.setSize(800,600),t.domElement.style.position="absolute",t.domElement.style.top="5px",document.body.appendChild(t.domElement),this.controls=new Qv(this.camera,t.domElement),this.controls.update()}}ngOnInit(){}ngAfterViewInit(){this.createScene(),this.startRenderingLoop(),this.createControls()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Wi({type:n,selectors:[["app-mining"]],viewQuery:function(t,i){if(1&t&&vc(r7,5),2&t){let r;Aa(r=Ta())&&(i.canvasRef=r.first)}},inputs:{fieldOfView:"fieldOfView",nearClippingPane:["nearClipping","nearClippingPane"],farClippingPane:["farClipping","farClippingPane"]},decls:3,vars:0,consts:[[1,"container"],["canvas",""]],template:function(t,i){1&t&&(Bt(0,"div",0),an(1,"canvas",null,1),on())}}),n})();const o7=["precanvas"],a7=[{path:"login",component:i7},{path:"home",component:t7,children:[{path:"pre-mining",component:(()=>{class n{get canvas(){return this.canvasRef.nativeElement}animateModel(){}createScene(){this.scene=new Rf,this.scene.background=new de(13948120),this.loaderGLTF.load("../../assets/3d-assets/Terrain_Outer.gltf",t=>{this.model=t.scene.children[0],console.log(this.model),(new bi).setFromObject(this.model).getCenter(this.model.position),this.model.position.multiplyScalar(-1),this.scene.add(this.model)}),this.loaderGLTF.load("../../assets/3d-assets/Terrain_Existing.gltf",t=>{this.model=t.scene.children[0],console.log(this.model),(new bi).setFromObject(this.model).getCenter(this.model.position),this.model.position.multiplyScalar(-1),this.scene.add(this.model)}),this.camera=new dn(this.fieldOfView,.75,this.nearClippingPane,this.farClippingPane),this.camera.position.x=100,this.camera.position.y=500,this.camera.position.z=100,this.ambientLight=new tp(0,50),this.scene.add(this.ambientLight),this.directionalLight=new Fu(16768772,.4),this.directionalLight.position.set(0,1,0),this.directionalLight.castShadow=!0,this.scene.add(this.directionalLight),this.light1=new li(4929308,5),this.light1.position.set(0,200,400),this.scene.add(this.light1),this.light2=new li(4929308,5),this.light2.position.set(500,100,0),this.scene.add(this.light2),this.light3=new li(4929308,5),this.light3.position.set(0,100,-500),this.scene.add(this.light3),this.light4=new li(4929308,5),this.light4.position.set(-500,300,500),this.scene.add(this.light4)}startRenderingLoop(){this.renderer=new gu({canvas:this.canvas,antialias:!0}),this.renderer.setSize(.8*window.innerWidth,.8*window.innerHeight);let t=this;!function i(){t.renderer.render(t.scene,t.camera),t.animateModel(),requestAnimationFrame(i)}()}constructor(){this.fieldOfView=120,this.nearClippingPane=1,this.farClippingPane=3e3,this.loaderGLTF=new qv,this.createControls=()=>{const t=new e0;t.setSize(800,600),t.domElement.style.position="absolute",t.domElement.style.top="5px",document.body.appendChild(t.domElement),this.controls=new Qv(this.camera,t.domElement),this.controls.enableZoom=!0,this.controls.enablePan=!1,this.controls.update()}}ngOnInit(){}ngAfterViewInit(){this.createScene(),this.startRenderingLoop()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Wi({type:n,selectors:[["app-premining"]],viewQuery:function(t,i){if(1&t&&vc(o7,5),2&t){let r;Aa(r=Ta())&&(i.canvasRef=r.first)}},inputs:{fieldOfView:"fieldOfView",nearClippingPane:["nearClipping","nearClippingPane"],farClippingPane:["farClipping","farClippingPane"]},decls:3,vars:0,consts:[[1,"container"],[2,"height","600px","width","800px"],["precanvas",""]],template:function(t,i){1&t&&(Bt(0,"div",0),an(1,"canvas",1,2),on())}}),n})()},{path:"mining",component:s7}]},{path:"",redirectTo:"login",pathMatch:"full"}];let l7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=hr({type:n}),n.\u0275inj=Gi({imports:[IA.forRoot(a7),IA]}),n})(),c7=(()=>{class n{constructor(){this.title="threejs"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Wi({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&an(0,"router-outlet")},dependencies:[Gh]}),n})(),u7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=hr({type:n,bootstrap:[c7]}),n.\u0275inj=Gi({imports:[fU,l7,Dz]}),n})();hU().bootstrapModule(u7).catch(n=>console.error(n))}},Tt=>{Tt(Tt.s=98)}]);